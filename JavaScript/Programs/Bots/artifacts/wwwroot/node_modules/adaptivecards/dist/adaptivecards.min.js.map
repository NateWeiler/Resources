{"version":3,"sources":["webpack://AdaptiveCards/webpack/universalModuleDefinition","webpack://AdaptiveCards/webpack/bootstrap","webpack://AdaptiveCards/./src/enums.ts","webpack://AdaptiveCards/./src/utils.ts","webpack://AdaptiveCards/./src/host-config.ts","webpack://AdaptiveCards/./src/adaptivecards.ts","webpack://AdaptiveCards/./src/card-elements.ts","webpack://AdaptiveCards/./src/text-formatters.ts"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Size","SizeUnit","TextSize","Spacing","TextWeight","TextColor","HorizontalAlignment","VerticalAlignment","ActionAlignment","ImageStyle","ShowCardActionMode","Orientation","BackgroundImageMode","ActionIconPlacement","InputTextStyle","ContainerStyle","Default","Emphasis","ValidationError","ContainerFitStatus","Enums","UUID","generate","d0","Math","random","d1","d2","d3","lut","initialize","toString","getValueOrDefault","obj","defaultValue","isNullOrEmpty","getEnumValueOrDefault","targetEnum","parseInt","toLowerCase","stringToCssColor","color","matches","exec","a","ContentTypes","applicationJson","applicationXWwwFormUrlencoded","appendChild","node","child","undefined","setProperty","target","propertyName","propertyValue","setEnumProperty","enumType","parseHostConfigEnum","renderSeparation","separationDefinition","orientation","spacing","lineThickness","separator","document","createElement","Horizontal","style","marginTop","paddingTop","borderTop","lineColor","height","marginLeft","paddingLeft","borderLeft","width","overflow","StringWithSubstitutions","this","_isProcessed","_original","_processed","substituteInputValues","inputs","contentType","regEx","matchedInput","length","id","valueForReplace","JSON","stringify","slice","encodeURIComponent","replace","getOriginal","set","SizeAndUnit","physicalSize","unit","parse","input","result","Weight","Pixel","Error","findNextCharacter","html","currIdx","truncate","element","maxHeight","lineHeight","fits","scrollHeight","fullText","innerHTML","truncateAt","idx","substring","breakableIndices","results","push","findBreakableIndices","lo","hi","bestBreakIdx","mid","floor","getFitStatus","containerEnd","start","offsetTop","clientHeight","FullyInContainer","Overflowing","FullyOutOfContainer","Utils","TextColorDefinition","default","subtle","AdaptiveCardConfig","allowCustomStyle","ImageSetConfig","imageSize","Medium","maxImageHeight","toJSON","MediaConfig","allowInlinePlayback","defaultPoster","FactTextDefinition","size","isSubtle","weight","wrap","getDefaultWeight","FactTitleDefinition","_super","_this","maxWidth","Bolder","__extends","FactSetConfig","title","ShowCardActionConfig","actionMode","Inline","inlineTopMargin","ActionsConfig","maxActions","buttonSpacing","showCard","preExpandSingleShowCardAction","actionsOrientation","actionAlignment","Left","iconPlacement","LeftOfTitle","allowTitleToWrap","iconSize","sizeAndUnit","e","ContainerStyleDefinition","foregroundColors","dark","light","accent","good","warning","attention","getTextColorDefinitionOrDefault","backgroundColor","highlightBackgroundColor","highlightForegroundColor","BuiltInContainerStyleDefinition","ContainerStyleSet","_allStyles","customStyleArray","Array","isArray","_i","customStyleArray_1","customStyle","styleName","keys","forEach","isBuiltIn","emphasis","customStyles","getStyleByName","Version","major","minor","_isValid","_major","_minor","versionString","errors","_versionString","error","InvalidPropertyValue","message","compareTo","otherVersion","isValid","HostCapabilities","capabilities","setCapability","version","json","name_1","jsonVersion","hasCapability","areAllMet","hostCapabilities","capabilityName","HostConfig","choiceSetInputValueSeparator","supportsInteractivity","fontFamily","small","medium","large","extraLarge","padding","fontSizes","fontWeights","lighter","bolder","imageSizes","containerStyles","actions","adaptiveCard","imageSet","media","factSet","cssClassNamePrefix","String","lineHeights","getEffectiveSpacing","Small","Large","ExtraLarge","Padding","makeCssClassName","classNames","arguments","__export","utils_1","TextFormatters","invokeSetCollection","action","collection","isActionAllowed","forbiddenActionTypes","getJsonTypeName","generateUniqueId","createCardObjectInstance","parent","createInstanceCallback","createValidationErrorCallback","tryToFallback","typeName","setParent","shouldFallback","raiseParseError","fallback","setShouldFallback","createActionInstance","AdaptiveCard","actionTypeRegistry","createInstance","UnknownActionType","createElementInstance","elementTypeRegistry","UnknownElementType","SpacingDefinition","top","right","bottom","left","PaddingDefinition","None","toSpacingDefinition","hostConfig","CardElement","_shouldFallback","_lang","_hostConfig","_internalPadding","_parent","_renderedElement","_separatorElement","_isVisible","_truncatedDueToOverflow","_defaultRenderedElementDisplayMode","_padding","requires","horizontalAlignment","customCssSelector","internalRenderSeparator","separatorOrientation","updateRenderedElementVisibility","display","isFirstElement","hideElementDueToOverflow","visibility","raiseElementVisibilityChangedEvent","showElementHiddenDueToOverflow","handleOverflow","isVisible","isHiddenDueToOverflow","handled","truncateOverflow","resetOverflow","sizeChanged","undoOverflowTruncation","createPlaceholderElement","border","minHeight","fontSize","innerText","internalGetNonZeroPadding","processTop","processRight","processBottom","processLeft","internalPadding","isAtTheVeryTop","isAtTheVeryRight","isAtTheVeryBottom","isAtTheVeryLeft","adjustRenderedElementSize","renderedElement","flex","isDesignMode","rootElement","getRootElement","designMode","allowCustomPadding","defaultPadding","getPadding","setPadding","useAutomaticContainerBleeding","getNonZeroPadding","getForbiddenElementTypes","getForbiddenActionTypes","card","onParseElementHandler","onParseElement","raiseParseElementEvent","speak","jsonSeparation","Deprecated","jsonHeight","getActionCount","getActionAt","index","validate","remove","CardElementContainer","removeItem","render","internalRender","classList","add","boxSizing","updateLayout","processChildren","indexOf","cardElement","isRendered","offsetHeight","isLastElement","isLeftMostElement","isBleeding","isRightMostElement","canContentBleed","getParentContainer","currentElement","Container","getAllInputs","getResourceInformation","getElementById","getActionById","lang","defaultHostConfig","useAdvancedCardBottomTruncation","parentContainer","separatorElement","TextBlock","apply","_processedText","_treatAsPlainText","_selectAction","_effectiveStyleDefinition","useMarkdown","restoreOriginalContent","maxLines","_computedLineHeight","_originalInnerHtml","truncateIfSupported","children","isTextOnly","tagName","getEffectiveStyleDefinition","getRenderedDomElementType","text","applyStylesTo","selectAction","onclick","execute","cancelBubble","formattedText","formatText","allowMarkForTextHighlighting","markdownProcessingResult","applyMarkdown","didProcess","outputHtml","markStyle","effectiveStyle","firstElementChild","HTMLElement","textOverflow","lastElementChild","marginBottom","anchors","getElementsByTagName","anchor","onAnchorClickedHandler","onAnchorClicked","preventDefault","wordWrap","whiteSpace","useAdvancedTextBlockTruncation","tabIndex","setAttribute","targetElement","isRtl","Center","textAlign","Right","colorDefinition","fontWeight","styleDefinition","Accent","Dark","Light","Good","Warning","Attention","Lighter","sizeString","weightString","renderSpeech","_text","Label","forElementId","htmlFor","Fact","FactSet","facts","borderWidth","borderSpacing","borderStyle","borderCollapse","trElement","tdElement","verticalAlign","textBlock","_a","fact","jsonFacts","speech","Image","Auto","pixelWidth","pixelHeight","altText","parseDimension","applySize","Stretch","url","alignItems","onkeypress","keyCode","justifyContent","imageElement","onload","raiseImageLoadedEvent","onerror","errorElement","minWidth","Person","borderRadius","backgroundPosition","backgroundRepeat","src","alt","styleString","mimeType","ImageSet","_images","flexWrap","renderedImage","margin","marginRight","getItemCount","getItemAt","image","concat","item","itemIndex","splice","images","jsonImages","addImage","MediaSource","Media","sources","getPosterUrl","poster","processSources","_selectedSources","_selectedMediaType","source","mimeComponents","split","supportedMediaTypes","renderPoster","posterRootElement","className","position","posterUrl","posterImageElement_1","parentNode","removeChild","playButtonOuterElement","mediaPlayerElement","renderMediaPlayer","play","onPlay","playButtonInnerElement","playButtonArrowWidth","playButtonArrowHeight","borderTopWidth","borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopColor","borderRightColor","borderBottomColor","transform","playButtonContainer","mediaElement","videoPlayer","controls","preload","type","jsonSources","serializedSources","mediaSource","Input","valueChanged","onValueChanged","PropertyCantBeNull","TextInput","Text","isMultiline","_textareaElement","placeholder","maxLength","oninput","_inputElement","ToggleInput","valueOn","valueOff","_checkboxInputElement","checked","onchange","label","useMarkdownInRadioButtonAndCheckbox","labelElement","spacerElement","Choice","ChoiceSetInput","choices","getUniqueCategoryName","uniqueCwtegoryName","uniqueCategoryCounter","isMultiSelect","defaultValues","_toggleInputs","i_2","checkboxInput","compoundInput","isCompact","_selectElement","option","selected","disabled","hidden","option_1","uniqueCategoryName","i_1","radioInput","choice","CollectionCantBeEmpty","choiceArray","NumberInput","_numberInputElement","min","max","DateInput","_dateInputElement","ActionButtonState","TimeInput","_timeInputElement","ActionButton","parentContainerStyle","_element","_state","Normal","onClick","_parentContainerStyle","updateCssStyle","ShowCardAction","Expanded","Subdued","isPrimary","alignment","click","Action","_actionCollection","setCollection","actionCollection","addCssClasses","iconUrl","buttonElement","hasTitle","titleElement","AboveTitle","iconElement","flexDirection","onExecuteActionHandler","onExecute","onExecuteAction","prepare","setStatus","status","statusCard","InlineAdaptiveCard","showStatusCard","hideStatusCard","onParseActionHandler","onParseAction","raiseParseActionEvent","removeAction","SubmitAction","_isPrepared","_originalData","_processedData","data","OpenUrlAction","HttpHeader","_value","newValue","HttpAction","_url","_body","_headers","method","headers","header","body","jsonHeaders","httpHeader","ActionCollection","owner","_expandedAction","_renderedActionCount","_statusCard","_actionCard","items","buttons","_owner","refreshContainer","_actionCardContainer","paddingRight","layoutChanged","hideActionCard","previouslyExpandedAction","raiseInlineCardExpandedEvent","showActionCard","suppressStyle","raiseEvent","renderedCard","collapseExpandedAction","state","expandShowCardAction","actionClicked","actionButton","Popup","findActionButton","clear","json_1","jsonAction","addAction","TooManyActions","InteractivityNotAllowed","ActionTypeNotAllowed","buttonStrip","ab","spacer","buttonStripContainer","expandedAction","actionIndex","ActionSet","jsonOrientation","BackgroundImage","verticalAlignment","Top","backgroundImage","Repeat","RepeatHorizontally","RepeatVertically","backgroundSize","backgroundPositionX","backgroundPositionY","Bottom","_items","_renderedItems","_style","verticalContentAlignment","rtl","isElementAllowed","forbiddenElementTypes","isInteractive","insertItemAt","forceInsert","isStandalone","getItemsCollectionPropertyName","isLastElementBleeding","applyPadding","physicalPadding","paddingBottom","hasBackground","physicalMargin","effectivePadding","effectiveMargin","assign","dir","defaultStyle","placeholderElement","boundary","handleElement","elt","maxHeight_1","hasExplicitStyle","elements","jsonBackgroundImage","addItem","insertItemBefore","insertBefore","insertItemAfter","insertAfter","Column","_computedWeight","Vertical","jsonWidth","invalidWidth","ColumnSet","_columns","totalWeight","column","renderedColumnCount","_b","_c","computedWeight","renderedColumn","columns","getCount","getColumnAt","jsonColumns","weightedColumns","stretchedColumns","Hint","addColumn","onImageLoadedHandler","onImageLoaded","isExpanded","onInlineCardExpandedHandler","onInlineCardExpanded","shouldUpdateLayout","onElementVisibilityChangedHandler","onElementVisibilityChanged","onParseError","ContainerWithActions","renderedActions","renderIfEmpty","renderedActionCount","TypeRegistry","reset","findTypeRegistration","registerType","registrationInfo","unregisterType","ElementTypeRegistry","ActionTypeRegistry","_cardTypeName","_fallbackCard","onProcessMarkdown","console","warn","isVersionSupported","bypassVersionCheck","currentVersion","fallbackText","MissingCardType","UnsupportedCardVersion","langId","fallbackElement","errorText","fallbackCard","removeAttribute","AbstractTextFormatter","regularExpression","_regularExpression","format","internalFormat","DateFormatter","date","Date","toLocaleDateString","day","weekday","month","year","TimeFormatter","toLocaleTimeString","hour","minute","formatters"],"mappings":"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","file":"adaptivecards.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"AdaptiveCards\"] = factory();\n\telse\n\t\troot[\"AdaptiveCards\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n","export enum Size {\r\n    Auto,\r\n    Stretch,\r\n    Small,\r\n    Medium,\r\n    Large\r\n}\r\n\r\nexport enum SizeUnit {\r\n    Weight,\r\n    Pixel\r\n}\r\n\r\nexport enum TextSize {\r\n    Small,\r\n    Default,\r\n    Medium,\r\n    Large,\r\n    ExtraLarge\r\n}\r\n\r\nexport enum Spacing {\r\n    None,\r\n    Small,\r\n    Default,\r\n    Medium,\r\n    Large,\r\n    ExtraLarge,\r\n    Padding\r\n}\r\n\r\nexport enum TextWeight {\r\n    Lighter,\r\n    Default,\r\n    Bolder\r\n}\r\n\r\nexport enum TextColor {\r\n    Default,\r\n    Dark,\r\n    Light,\r\n    Accent,\r\n    Good,\r\n    Warning,\r\n    Attention\r\n}\r\n\r\nexport enum HorizontalAlignment {\r\n    Left,\r\n    Center,\r\n    Right\r\n}\r\n\r\nexport enum VerticalAlignment {\r\n    Top,\r\n    Center,\r\n    Bottom\r\n}\r\n\r\nexport enum ActionAlignment {\r\n    Left,\r\n    Center,\r\n    Right,\r\n    Stretch\r\n}\r\n\r\nexport enum ImageStyle {\r\n    Default,\r\n    Person\r\n}\r\n\r\nexport enum ShowCardActionMode {\r\n    Inline,\r\n    Popup\r\n}\r\n\r\nexport enum Orientation {\r\n    Horizontal,\r\n    Vertical\r\n}\r\n\r\nexport enum BackgroundImageMode {\r\n    Stretch,\r\n    RepeatHorizontally,\r\n    RepeatVertically,\r\n    Repeat\r\n}\r\n\r\nexport enum ActionIconPlacement {\r\n    LeftOfTitle,\r\n    AboveTitle\r\n}\r\n\r\nexport enum InputTextStyle {\r\n    Text,\r\n    Tel,\r\n    Url,\r\n    Email\r\n}\r\n\r\n/*\r\n    This should really be a string enum, e.g.\r\n\r\n        export enum ContainerStyle {\r\n            Default = \"default\",\r\n            Emphasis = \"emphasis\"\r\n        }\r\n\r\n    However, some hosts do not use a version of TypeScript\r\n    recent enough to understand string enums. This is\r\n    a compatible construct that does not require using\r\n    a more recent version of TypeScript.\r\n*/\r\nexport class ContainerStyle {\r\n    static readonly Default = \"default\";\r\n    static readonly Emphasis = \"emphasis\";\r\n}\r\n\r\nexport enum ValidationError {\r\n    Hint,\r\n    ActionTypeNotAllowed,\r\n    CollectionCantBeEmpty,\r\n    Deprecated,\r\n    ElementTypeNotAllowed,\r\n    InteractivityNotAllowed,\r\n    InvalidPropertyValue,\r\n    MissingCardType,\r\n    PropertyCantBeNull,\r\n    TooManyActions,\r\n    UnknownActionType,\r\n    UnknownElementType,\r\n    UnsupportedCardVersion\r\n}\r\n\r\nexport enum ContainerFitStatus {\r\n    FullyInContainer,\r\n    Overflowing,\r\n    FullyOutOfContainer\r\n}\r\n","import * as Enums from \"./enums\";\r\n\r\n/**\r\n * Fast UUID generator, RFC4122 version 4 compliant.\r\n * @author Jeff Ward (jcward.com).\r\n * @license MIT license\r\n * @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136\r\n **/\r\nexport class UUID {\r\n\tprivate static lut = [];\r\n\r\n\tstatic generate(): string {\r\n\t\tlet d0 = Math.random() * 0xffffffff | 0;\r\n\t\tlet d1 = Math.random() * 0xffffffff | 0;\r\n\t\tlet d2 = Math.random() * 0xffffffff | 0;\r\n\t\tlet d3 = Math.random() * 0xffffffff | 0;\r\n\r\n\t\treturn UUID.lut[d0 & 0xff] + UUID.lut[d0 >> 8 & 0xff] + UUID.lut[d0 >> 16 & 0xff] + UUID.lut[d0 >> 24 & 0xff] + '-' +\r\n\t\t\tUUID.lut[d1 & 0xff] + UUID.lut[d1 >> 8 & 0xff] + '-' + UUID.lut[d1 >> 16 & 0x0f | 0x40] + UUID.lut[d1 >> 24 & 0xff] + '-' +\r\n\t\t\tUUID.lut[d2 & 0x3f | 0x80] + UUID.lut[d2 >> 8 & 0xff] + '-' + UUID.lut[d2 >> 16 & 0xff] + UUID.lut[d2 >> 24 & 0xff] +\r\n\t\t\tUUID.lut[d3 & 0xff] + UUID.lut[d3 >> 8 & 0xff] + UUID.lut[d3 >> 16 & 0xff] + UUID.lut[d3 >> 24 & 0xff];\r\n\t}\r\n\r\n\tstatic initialize() {\r\n\t\tfor (let i = 0; i < 256; i++) {\r\n\t\t\tUUID.lut[i] = (i < 16 ? '0' : '') + i.toString(16);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nUUID.initialize();\r\n\r\nexport const ContentTypes = {\r\n\tapplicationJson: \"application/json\",\r\n\tapplicationXWwwFormUrlencoded: \"application/x-www-form-urlencoded\"\r\n}\r\n\r\nexport interface ISeparationDefinition {\r\n\tspacing: number,\r\n\tlineThickness?: number,\r\n\tlineColor?: string\r\n}\r\n\r\nexport interface IInput {\r\n\tid: string;\r\n\tvalue: string;\r\n}\r\n\r\nexport function getValueOrDefault<T>(obj: any, defaultValue: T): T {\r\n\treturn obj ? <T>obj : defaultValue;\r\n}\r\n\r\nexport function isNullOrEmpty(value: string): boolean {\r\n\treturn value === undefined || value === null || value === \"\";\r\n}\r\n\r\nexport function appendChild(node: Node, child: Node) {\r\n\tif (child != null && child != undefined) {\r\n\t\tnode.appendChild(child);\r\n\t}\r\n}\r\n\r\nexport function setProperty(target: any, propertyName: string, propertyValue: any, defaultValue: any = undefined) {\r\n\tif (propertyValue && (!defaultValue || defaultValue !== propertyValue)) {\r\n\t\ttarget[propertyName] = propertyValue;\r\n\t}\r\n}\r\n\r\nexport function setEnumProperty(enumType: { [s: number]: string }, target: any, propertyName: string, propertyValue: number, defaultValue?: number) {\r\n\tif (defaultValue === undefined || defaultValue !== propertyValue) {\r\n\t\ttarget[propertyName] = enumType[propertyValue];\r\n\t}\r\n}\r\n\r\nexport function getEnumValueOrDefault(targetEnum: { [s: number]: string }, name: string, defaultValue: number): number {\r\n\tif (isNullOrEmpty(name)) {\r\n\t\treturn defaultValue;\r\n\t}\r\n\r\n\tfor (var key in targetEnum) {\r\n\t\tlet isValueProperty = parseInt(key, 10) >= 0\r\n\r\n\t\tif (isValueProperty) {\r\n\t\t\tlet value = targetEnum[key];\r\n\r\n\t\t\tif (value && typeof value === \"string\") {\r\n\t\t\t\tif (value.toLowerCase() === name.toLowerCase()) {\r\n\t\t\t\t\treturn parseInt(key, 10);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn defaultValue;\r\n}\r\n\r\nexport function parseHostConfigEnum(targetEnum: { [s: number]: string }, value: string | number, defaultValue: any): any {\r\n\tif (typeof value === \"string\") {\r\n\t\treturn getEnumValueOrDefault(targetEnum, value, defaultValue);\r\n\t} else if (typeof value === \"number\") {\r\n\t\treturn getValueOrDefault<typeof targetEnum>(value, defaultValue);\r\n\t} else {\r\n\t\treturn defaultValue;\r\n\t}\r\n}\r\n\r\nexport function renderSeparation(separationDefinition: ISeparationDefinition, orientation: Enums.Orientation): HTMLElement {\r\n\tif (separationDefinition.spacing > 0 || separationDefinition.lineThickness > 0) {\r\n\t\tvar separator = document.createElement(\"div\");\r\n\r\n\t\tif (orientation == Enums.Orientation.Horizontal) {\r\n\t\t\tif (separationDefinition.lineThickness) {\r\n\t\t\t\tseparator.style.marginTop = (separationDefinition.spacing / 2) + \"px\";\r\n\t\t\t\tseparator.style.paddingTop = (separationDefinition.spacing / 2) + \"px\";\r\n\t\t\t\tseparator.style.borderTop = separationDefinition.lineThickness + \"px solid \" + stringToCssColor(separationDefinition.lineColor);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tseparator.style.height = separationDefinition.spacing + \"px\";\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (separationDefinition.lineThickness) {\r\n\t\t\t\tseparator.style.marginLeft = (separationDefinition.spacing / 2) + \"px\";\r\n\t\t\t\tseparator.style.paddingLeft = (separationDefinition.spacing / 2) + \"px\";\r\n\t\t\t\tseparator.style.borderLeft = separationDefinition.lineThickness + \"px solid \" + stringToCssColor(separationDefinition.lineColor);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tseparator.style.width = separationDefinition.spacing + \"px\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tseparator.style.overflow = \"hidden\";\r\n\r\n\t\treturn separator;\r\n\t}\r\n\telse {\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\nexport function stringToCssColor(color: string): string {\r\n\tvar regEx = /#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi;\r\n\r\n\tvar matches = regEx.exec(color);\r\n\r\n\tif (matches && matches[4]) {\r\n\t\tvar a = parseInt(matches[1], 16) / 255;\r\n\t\tvar r = parseInt(matches[2], 16);\r\n\t\tvar g = parseInt(matches[3], 16);\r\n\t\tvar b = parseInt(matches[4], 16);\r\n\r\n\t\treturn \"rgba(\" + r + \",\" + g + \",\" + b + \",\" + a + \")\";\r\n\t}\r\n\telse {\r\n\t\treturn color;\r\n\t}\r\n}\r\n\r\nexport class StringWithSubstitutions {\r\n\tprivate _isProcessed: boolean = false;\r\n\tprivate _original: string = null;\r\n\tprivate _processed: string = null;\r\n\r\n\tsubstituteInputValues(inputs: Array<IInput>, contentType: string) {\r\n\t\tthis._processed = this._original;\r\n\r\n\t\tvar regEx = /\\{{2}([a-z0-9_$@]+).value\\}{2}/gi;\r\n\t\tvar matches;\r\n\r\n\t\twhile ((matches = regEx.exec(this._original)) != null) {\r\n\t\t\tvar matchedInput: IInput = null;\r\n\r\n\t\t\tfor (var i = 0; i < inputs.length; i++) {\r\n\t\t\t\tif (inputs[i].id.toLowerCase() == matches[1].toLowerCase()) {\r\n\t\t\t\t\tmatchedInput = inputs[i];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (matchedInput) {\r\n\t\t\t\tvar valueForReplace = \"\";\r\n\r\n\t\t\t\tif (matchedInput.value) {\r\n\t\t\t\t\tvalueForReplace = matchedInput.value;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (contentType === ContentTypes.applicationJson) {\r\n\t\t\t\t\tvalueForReplace = JSON.stringify(valueForReplace);\r\n\t\t\t\t\tvalueForReplace = valueForReplace.slice(1, -1);\r\n\t\t\t\t}\r\n\t\t\t\telse if (contentType === ContentTypes.applicationXWwwFormUrlencoded) {\r\n\t\t\t\t\tvalueForReplace = encodeURIComponent(valueForReplace);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._processed = this._processed.replace(matches[0], valueForReplace);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis._isProcessed = true;\r\n\t}\r\n\r\n\tgetOriginal(): string {\r\n\t\treturn this._original;\r\n\t}\r\n\r\n\tget(): string {\r\n\t\tif (!this._isProcessed) {\r\n\t\t\treturn this._original;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn this._processed;\r\n\t\t}\r\n\t}\r\n\r\n\tset(value: string) {\r\n\t\tthis._original = value;\r\n\t\tthis._isProcessed = false;\r\n\t}\r\n}\r\n\r\nexport class SizeAndUnit {\r\n\tphysicalSize: number;\r\n\tunit: Enums.SizeUnit;\r\n\r\n\tstatic parse(input: any): SizeAndUnit {\r\n\t\tlet result = new SizeAndUnit(0, Enums.SizeUnit.Weight);\r\n\r\n\t\tlet regExp = /^([0-9]+)(px|\\*)?$/g;\r\n\t\tlet matches = regExp.exec(input);\r\n\r\n\t\tif (matches && matches.length >= 2) {\r\n\t\t\tresult.physicalSize = parseInt(matches[1]);\r\n\r\n\t\t\tif (matches.length == 3) {\r\n\t\t\t\tif (matches[2] == \"px\") {\r\n\t\t\t\t\tresult.unit = Enums.SizeUnit.Pixel;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tthrow new Error(\"Invalid size: \" + input);\r\n\t}\r\n\r\n\tconstructor(physicalSize: number, unit: Enums.SizeUnit) {\r\n\t\tthis.physicalSize = physicalSize;\r\n\t\tthis.unit = unit;\r\n\t}\r\n}\r\n\r\nexport function truncate(element: HTMLElement,\r\n\tmaxHeight: number,\r\n\tlineHeight?: number) {\r\n\tvar fits = () => {\r\n\t\t// Allow a one pixel overflow to account for rounding differences\r\n\t\t// between browsers\r\n\t\treturn maxHeight - element.scrollHeight >= -1.0;\r\n\t};\r\n\r\n\tif (fits()) return;\r\n\r\n\tvar fullText = element.innerHTML;\r\n\tvar truncateAt = (idx) => {\r\n\t\telement.innerHTML = fullText.substring(0, idx) + '...';\r\n\t}\r\n\r\n\tvar breakableIndices = findBreakableIndices(fullText);\r\n\tvar lo = 0;\r\n\tvar hi = breakableIndices.length;\r\n\tvar bestBreakIdx = 0;\r\n\r\n\t// Do a binary search for the longest string that fits\r\n\twhile (lo < hi) {\r\n\t\tvar mid = Math.floor((lo + hi) / 2);\r\n\t\ttruncateAt(breakableIndices[mid]);\r\n\r\n\t\tif (fits()) {\r\n\t\t\tbestBreakIdx = breakableIndices[mid];\r\n\t\t\tlo = mid + 1;\r\n\t\t}\r\n\t\telse {\r\n\t\t\thi = mid;\r\n\t\t}\r\n\t}\r\n\r\n\ttruncateAt(bestBreakIdx);\r\n\r\n\t// If we have extra room, try to expand the string letter by letter\r\n\t// (covers the case where we have to break in the middle of a long word)\r\n\tif (lineHeight && maxHeight - element.scrollHeight >= lineHeight - 1.0) {\r\n\t\tlet idx = findNextCharacter(fullText, bestBreakIdx);\r\n\r\n\t\twhile (idx < fullText.length) {\r\n\t\t\ttruncateAt(idx);\r\n\r\n\t\t\tif (fits()) {\r\n\t\t\t\tbestBreakIdx = idx;\r\n\t\t\t\tidx = findNextCharacter(fullText, idx);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\ttruncateAt(bestBreakIdx);\r\n\t}\r\n}\r\n\r\nfunction findBreakableIndices(html: string): Array<number> {\r\n\tvar results: Array<number> = [];\r\n\tvar idx = findNextCharacter(html, -1);\r\n\r\n\twhile (idx < html.length) {\r\n\t\tif (html[idx] == ' ') {\r\n\t\t\tresults.push(idx);\r\n\t\t}\r\n\r\n\t\tidx = findNextCharacter(html, idx);\r\n\t}\r\n\r\n\treturn results;\r\n}\r\n\r\nfunction findNextCharacter(html: string, currIdx: number): number {\r\n\tcurrIdx += 1;\r\n\r\n\t// If we found the start of an HTML tag, keep advancing until we get\r\n\t// past it, so we don't end up truncating in the middle of the tag\r\n\twhile (currIdx < html.length && html[currIdx] == '<') {\r\n\t\twhile (currIdx < html.length && html[currIdx++] != '>');\r\n\t}\r\n\r\n\treturn currIdx;\r\n}\r\n\r\nexport function getFitStatus(element: HTMLElement, containerEnd: number): Enums.ContainerFitStatus {\r\n\tvar start = element.offsetTop;\r\n\tvar end = start + element.clientHeight;\r\n\r\n\tif (end <= containerEnd) {\r\n\t\treturn Enums.ContainerFitStatus.FullyInContainer;\r\n\t}\r\n\telse if (start < containerEnd) {\r\n\t\treturn Enums.ContainerFitStatus.Overflowing;\r\n\t}\r\n\telse {\r\n\t\treturn Enums.ContainerFitStatus.FullyOutOfContainer;\r\n\t}\r\n}","import * as Enums from \"./enums\";\r\nimport * as Utils from \"./utils\";\r\n\r\nexport interface IValidationError {\r\n    error: Enums.ValidationError,\r\n    message: string;\r\n}\r\n\r\nexport class TextColorDefinition {\r\n    default: string = \"#000000\";\r\n    subtle: string = \"#666666\";\r\n\r\n    constructor(obj?: any) {\r\n        if (obj) {\r\n            this.default = obj[\"default\"] || this.default;\r\n            this.subtle = obj[\"subtle\"] || this.subtle;\r\n        }\r\n    }\r\n}\r\n\r\nexport class AdaptiveCardConfig {\r\n    allowCustomStyle: boolean = false;\r\n\r\n    constructor(obj?: any) {\r\n        if (obj) {\r\n            this.allowCustomStyle = obj[\"allowCustomStyle\"] || this.allowCustomStyle;\r\n        }\r\n    }\r\n}\r\n\r\nexport class ImageSetConfig {\r\n    imageSize: Enums.Size = Enums.Size.Medium;\r\n    maxImageHeight: number = 100;\r\n\r\n    constructor(obj?: any) {\r\n        if (obj) {\r\n            this.imageSize = obj[\"imageSize\"] != null ? obj[\"imageSize\"] : this.imageSize;\r\n            this.maxImageHeight = Utils.getValueOrDefault<number>(obj[\"maxImageHeight\"], 100);\r\n        }\r\n    }\r\n\r\n    toJSON() {\r\n        return {\r\n            imageSize: Enums.Size[this.imageSize],\r\n            maxImageHeight: this.maxImageHeight\r\n        }\r\n    }\r\n}\r\n\r\nexport class MediaConfig {\r\n    defaultPoster: string;\r\n    allowInlinePlayback: boolean = true;\r\n\r\n    constructor(obj?: any) {\r\n        if (obj) {\r\n            this.defaultPoster = obj[\"defaultPoster\"];\r\n            this.allowInlinePlayback = obj[\"allowInlinePlayback\"] || this.allowInlinePlayback;\r\n        }\r\n    }\r\n\r\n    toJSON() {\r\n        return {\r\n            defaultPoster: this.defaultPoster,\r\n            allowInlinePlayback: this.allowInlinePlayback\r\n        }\r\n    }\r\n}\r\n\r\nexport class FactTextDefinition {\r\n    size: Enums.TextSize = Enums.TextSize.Default;\r\n    color: Enums.TextColor = Enums.TextColor.Default;;\r\n    isSubtle: boolean = false;\r\n    weight: Enums.TextWeight = Enums.TextWeight.Default;\r\n    wrap: boolean = true;\r\n\r\n    constructor(obj?: any) {\r\n        if (obj) {\r\n            this.size = Utils.parseHostConfigEnum(Enums.TextSize, obj[\"size\"], Enums.TextSize.Default);\r\n            this.color = Utils.parseHostConfigEnum(Enums.TextColor, obj[\"color\"], Enums.TextColor.Default);\r\n            this.isSubtle = obj[\"isSubtle\"] || this.isSubtle;\r\n            this.weight = Utils.parseHostConfigEnum(Enums.TextWeight, obj[\"weight\"], this.getDefaultWeight());\r\n            this.wrap = obj[\"wrap\"] != null ? obj[\"wrap\"] : this.wrap;\r\n        }\r\n    }\r\n\r\n    getDefaultWeight() {\r\n\t\treturn Enums.TextWeight.Default;\r\n    }\r\n\r\n    toJSON(): any {\r\n        return {\r\n            size: Enums.TextSize[this.size],\r\n            color: Enums.TextColor[this.color],\r\n            isSubtle: this.isSubtle,\r\n            weight: Enums.TextWeight[this.weight],\r\n            wrap: this.wrap\r\n        }\r\n    }\r\n}\r\n\r\nexport class FactTitleDefinition extends FactTextDefinition {\r\n    maxWidth?: number = 150;\r\n    weight: Enums.TextWeight = Enums.TextWeight.Bolder;\r\n\r\n    constructor(obj?: any) {\r\n        super(obj);\r\n\r\n        if (obj) {\r\n            this.maxWidth = obj[\"maxWidth\"] != null ? obj[\"maxWidth\"] : this.maxWidth;\r\n\t\t\tthis.weight = Utils.parseHostConfigEnum(Enums.TextWeight, obj[\"weight\"], Enums.TextWeight.Bolder);\r\n        }\r\n    }\r\n\r\n    getDefaultWeight() {\r\n        return Enums.TextWeight.Bolder;\r\n    }\r\n}\r\n\r\nexport class FactSetConfig {\r\n    readonly title: FactTitleDefinition = new FactTitleDefinition();\r\n    readonly value: FactTextDefinition = new FactTextDefinition();\r\n    spacing: number = 10;\r\n\r\n    constructor(obj?: any) {\r\n        if (obj) {\r\n            this.title = new FactTitleDefinition(obj[\"title\"]);\r\n            this.value = new FactTextDefinition(obj[\"value\"]);\r\n            this.spacing = obj.spacing && obj.spacing != null ? obj.spacing && obj.spacing : this.spacing;\r\n        }\r\n    }\r\n}\r\n\r\nexport class ShowCardActionConfig {\r\n    actionMode: Enums.ShowCardActionMode = Enums.ShowCardActionMode.Inline;\r\n    inlineTopMargin: number = 16;\r\n    style?: string = Enums.ContainerStyle.Emphasis;\r\n\r\n    constructor(obj?: any) {\r\n        if (obj) {\r\n            this.actionMode = Utils.parseHostConfigEnum(Enums.ShowCardActionMode, obj[\"actionMode\"], Enums.ShowCardActionMode.Inline);\r\n            this.inlineTopMargin = obj[\"inlineTopMargin\"] != null ? obj[\"inlineTopMargin\"] : this.inlineTopMargin;\r\n            this.style = obj[\"style\"] && typeof obj[\"style\"] === \"string\" ? obj[\"style\"] : Enums.ContainerStyle.Emphasis;\r\n        }\r\n    }\r\n\r\n    toJSON() {\r\n        return {\r\n            actionMode: Enums.ShowCardActionMode[this.actionMode],\r\n            inlineTopMargin: this.inlineTopMargin,\r\n            style: this.style\r\n        }\r\n    }\r\n}\r\n\r\nexport class ActionsConfig {\r\n    maxActions: number = 5;\r\n    spacing: Enums.Spacing = Enums.Spacing.Default;\r\n    buttonSpacing: number = 20;\r\n    readonly showCard: ShowCardActionConfig = new ShowCardActionConfig();\r\n    preExpandSingleShowCardAction?: boolean = false;\r\n    actionsOrientation: Enums.Orientation = Enums.Orientation.Horizontal;\r\n    actionAlignment: Enums.ActionAlignment = Enums.ActionAlignment.Left;\r\n    iconPlacement: Enums.ActionIconPlacement = Enums.ActionIconPlacement.LeftOfTitle;\r\n    allowTitleToWrap: boolean = false;\r\n    iconSize: number = 24;\r\n\r\n    constructor(obj?: any) {\r\n        if (obj) {\r\n            this.maxActions = obj[\"maxActions\"] != null ? obj[\"maxActions\"] : this.maxActions;\r\n            this.spacing = Utils.parseHostConfigEnum(Enums.Spacing, obj.spacing && obj.spacing, Enums.Spacing.Default);\r\n            this.buttonSpacing = obj[\"buttonSpacing\"] != null ? obj[\"buttonSpacing\"] : this.buttonSpacing;\r\n            this.showCard = new ShowCardActionConfig(obj[\"showCard\"]);\r\n            this.preExpandSingleShowCardAction = Utils.getValueOrDefault<boolean>(obj[\"preExpandSingleShowCardAction\"], false);\r\n            this.actionsOrientation = Utils.parseHostConfigEnum(Enums.Orientation, obj[\"actionsOrientation\"], Enums.Orientation.Horizontal);\r\n            this.actionAlignment = Utils.parseHostConfigEnum(Enums.ActionAlignment, obj[\"actionAlignment\"], Enums.ActionAlignment.Left);\r\n            this.iconPlacement = Utils.parseHostConfigEnum(Enums.ActionIconPlacement, obj[\"iconPlacement\"], Enums.ActionIconPlacement.LeftOfTitle);\r\n            this.allowTitleToWrap = obj[\"allowTitleToWrap\"] != null ? obj[\"allowTitleToWrap\"] : this.allowTitleToWrap;\r\n\r\n            try {\r\n                let sizeAndUnit = Utils.SizeAndUnit.parse(obj[\"iconSize\"]);\r\n\r\n                if (sizeAndUnit.unit == Enums.SizeUnit.Pixel) {\r\n                    this.iconSize = sizeAndUnit.physicalSize;\r\n                }\r\n            }\r\n            catch (e) {\r\n                // Swallow this, keep default icon size\r\n            }\r\n        }\r\n    }\r\n\r\n    toJSON() {\r\n        return {\r\n            maxActions: this.maxActions,\r\n            spacing: Enums.Spacing[this.spacing],\r\n            buttonSpacing: this.buttonSpacing,\r\n            showCard: this.showCard,\r\n            preExpandSingleShowCardAction: this.preExpandSingleShowCardAction,\r\n            actionsOrientation: Enums.Orientation[this.actionsOrientation],\r\n            actionAlignment: Enums.ActionAlignment[this.actionAlignment]\r\n        }\r\n    }\r\n}\r\n\r\nexport class ContainerStyleDefinition {\r\n    private getTextColorDefinitionOrDefault(obj: any, defaultValue: { default: string, subtle: string }) {\r\n        return new TextColorDefinition(obj ? obj : defaultValue);\r\n    }\r\n\r\n    backgroundColor?: string;\r\n\r\n    readonly foregroundColors = {\r\n        default: new TextColorDefinition(),\r\n        dark: new TextColorDefinition(),\r\n        light: new TextColorDefinition(),\r\n        accent: new TextColorDefinition(),\r\n        good: new TextColorDefinition(),\r\n        warning: new TextColorDefinition(),\r\n        attention: new TextColorDefinition()\r\n    };\r\n\r\n    highlightBackgroundColor?: string;\r\n    highlightForegroundColor?: string;\r\n\r\n    parse(obj: any) {\r\n        if (obj) {\r\n            this.backgroundColor = obj[\"backgroundColor\"];\r\n\r\n            if (obj.foregroundColors) {\r\n                this.foregroundColors.default = this.getTextColorDefinitionOrDefault(obj.foregroundColors[\"default\"], { default: \"#333333\", subtle: \"#EE333333\" });\r\n                this.foregroundColors.dark = this.getTextColorDefinitionOrDefault(obj.foregroundColors[\"dark\"], { default: \"#000000\", subtle: \"#66000000\" });\r\n                this.foregroundColors.light = this.getTextColorDefinitionOrDefault(obj.foregroundColors[\"light\"], { default: \"#FFFFFF\", subtle: \"#33000000\" });\r\n                this.foregroundColors.accent = this.getTextColorDefinitionOrDefault(obj.foregroundColors[\"accent\"], { default: \"#2E89FC\", subtle: \"#882E89FC\" });\r\n                this.foregroundColors.good = this.getTextColorDefinitionOrDefault(obj.foregroundColors[\"good\"], { default: \"#54A254\", subtle: \"#DD54A254\" });\r\n                this.foregroundColors.warning = this.getTextColorDefinitionOrDefault(obj.foregroundColors[\"warning\"], { default: \"#E69500\", subtle: \"#DDE69500\" });\r\n                this.foregroundColors.attention = this.getTextColorDefinitionOrDefault(obj.foregroundColors[\"attention\"], { default: \"#CC3300\", subtle: \"#DDCC3300\" });\r\n            }\r\n\r\n            this.highlightBackgroundColor = obj[\"highlightBackgroundColor\"];\r\n            this.highlightForegroundColor = obj[\"highlightForegroundColor\"];\r\n        }\r\n    }\r\n\r\n    constructor(obj?: any) {\r\n        this.parse(obj);\r\n    }\r\n\r\n    get isBuiltIn(): boolean {\r\n        return false;\r\n    }\r\n}\r\n\r\nclass BuiltInContainerStyleDefinition extends ContainerStyleDefinition {\r\n    get isBuiltIn(): boolean {\r\n        return true;\r\n    }\r\n}\r\n\r\nexport interface ILineHeightDefinitions {\r\n    small: number;\r\n    medium: number;\r\n    default: number;\r\n    large: number;\r\n    extraLarge: number;\r\n}\r\n\r\nexport class ContainerStyleSet {\r\n    private _allStyles: object = {};\r\n\r\n    constructor(obj?: any) {\r\n        this._allStyles[Enums.ContainerStyle.Default] = new BuiltInContainerStyleDefinition();\r\n        this._allStyles[Enums.ContainerStyle.Emphasis] = new BuiltInContainerStyleDefinition();\r\n\r\n        if (obj) {\r\n            this._allStyles[Enums.ContainerStyle.Default].parse(obj[Enums.ContainerStyle.Default]);\r\n            this._allStyles[Enums.ContainerStyle.Emphasis].parse(obj[Enums.ContainerStyle.Emphasis]);\r\n\r\n            const customStyleArray = obj[\"customStyles\"];\r\n\r\n            if (customStyleArray && Array.isArray(customStyleArray)) {\r\n                for (var customStyle of customStyleArray) {\r\n                    if (customStyle) {\r\n                        var styleName = customStyle[\"name\"];\r\n\r\n                        if (styleName && typeof styleName === \"string\") {\r\n                            if (this._allStyles.hasOwnProperty(styleName)) {\r\n                                this._allStyles[styleName].parse(customStyle[\"style\"]);\r\n                            }\r\n                            else {\r\n                                this._allStyles[styleName] = new ContainerStyleDefinition(customStyle[\"style\"]);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    toJSON() {\r\n        var customStyleArray: Array<any> = [];\r\n\r\n        Object.keys(this._allStyles).forEach(\r\n            (key) => {\r\n                if (!this._allStyles[key].isBuiltIn) {\r\n                    customStyleArray.push({\r\n                        name: key,\r\n                        style: this._allStyles[key]\r\n                    });\r\n                }\r\n            });\r\n\r\n        var result: any = {\r\n            default: this.default,\r\n            emphasis: this.emphasis\r\n        }\r\n\r\n        if (customStyleArray.length > 0) {\r\n            result.customStyles = customStyleArray;\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    getStyleByName(name: string, defaultValue: ContainerStyleDefinition = null): ContainerStyleDefinition {\r\n        return this._allStyles.hasOwnProperty(name) ? this._allStyles[name] : defaultValue;\r\n    }\r\n\r\n    get default(): ContainerStyleDefinition {\r\n        return this._allStyles[Enums.ContainerStyle.Default];\r\n    }\r\n\r\n    get emphasis(): ContainerStyleDefinition {\r\n        return this._allStyles[Enums.ContainerStyle.Emphasis];\r\n    }\r\n}\r\n\r\nexport class Version {\r\n    private _versionString: string;\r\n    private _major: number;\r\n    private _minor: number;\r\n    private _isValid: boolean = true;\r\n\r\n    constructor(major: number = 1, minor: number = 1) {\r\n        this._major = major;\r\n        this._minor = minor;\r\n    }\r\n\r\n    static parse(versionString: string, errors?: Array<IValidationError>): Version {\r\n        if (!versionString) {\r\n            return null;\r\n        }\r\n\r\n        var result = new Version();\r\n        result._versionString = versionString;\r\n\r\n        var regEx = /(\\d+).(\\d+)/gi;\r\n        var matches = regEx.exec(versionString);\r\n\r\n        if (matches != null && matches.length == 3) {\r\n            result._major = parseInt(matches[1]);\r\n            result._minor = parseInt(matches[2]);\r\n        }\r\n        else {\r\n            result._isValid = false;\r\n        }\r\n\r\n        if (!result._isValid && errors) {\r\n            errors.push(\r\n                {\r\n                    error: Enums.ValidationError.InvalidPropertyValue,\r\n                    message: \"Invalid version string: \" + result._versionString\r\n                }\r\n            );\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    toString(): string {\r\n        return !this._isValid ? this._versionString : this._major + \".\" + this._minor;\r\n    }\r\n\r\n    compareTo(otherVersion: Version): number {\r\n        if (!this.isValid || !otherVersion.isValid) {\r\n            throw new Error(\"Cannot compare invalid version.\");\r\n        }\r\n\r\n        if (this.major > otherVersion.major) {\r\n            return 1;\r\n        }\r\n        else if (this.major < otherVersion.major) {\r\n            return -1;\r\n        }\r\n        else if (this.minor > otherVersion.minor) {\r\n            return 1; \r\n        }\r\n        else if (this.minor < otherVersion.minor) {\r\n            return -1;\r\n        }\r\n\r\n        return 0;\r\n    }\r\n\r\n    get major(): number {\r\n        return this._major;\r\n    }\r\n\r\n    get minor(): number {\r\n        return this._minor;\r\n    }\r\n\r\n    get isValid(): boolean {\r\n        return this._isValid;\r\n    }\r\n}\r\n\r\nexport type HostCapabilityVersion = Version | \"*\";\r\nexport type HostCapabilityMap = { [key: string]: HostCapabilityVersion };\r\n\r\nexport class HostCapabilities {\r\n    private setCapability(name: string, version: HostCapabilityVersion) {\r\n        if (!this.capabilities) {\r\n            this.capabilities = { };\r\n        }\r\n\r\n        this.capabilities[name] = version;\r\n    }\r\n\r\n    capabilities: HostCapabilityMap = null;\r\n\r\n    parse(json: any, errors?: Array<IValidationError>) {\r\n        if (json) {\r\n            for (let name in json) {\r\n                let jsonVersion = json[name];\r\n\r\n                if (typeof jsonVersion === \"string\") {\r\n                    if (jsonVersion == \"*\") {\r\n                        this.setCapability(name, \"*\");\r\n                    }\r\n                    else {\r\n                        let version = Version.parse(jsonVersion, errors);\r\n\r\n                        if (version.isValid) {\r\n                            this.setCapability(name, version);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    hasCapability(name: string, version: HostCapabilityVersion): boolean {\r\n        if (this.capabilities && this.capabilities.hasOwnProperty(name)) {\r\n            if (version == \"*\" || this.capabilities[name] == \"*\") {\r\n                return true;\r\n            }\r\n\r\n            return version.compareTo(<Version>this.capabilities[name]) <= 0;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    areAllMet(hostCapabilities: HostCapabilities): boolean {\r\n        if (this.capabilities) {\r\n            for (let capabilityName in this.capabilities) {\r\n                if (!hostCapabilities.hasCapability(capabilityName, this.capabilities[capabilityName])) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n}\r\n\r\nexport class HostConfig {\r\n    readonly hostCapabilities = new HostCapabilities();\r\n\r\n    choiceSetInputValueSeparator: string = \",\";\r\n    supportsInteractivity: boolean = true;\r\n    lineHeights?: ILineHeightDefinitions;\r\n\r\n    fontFamily?: string = \"Segoe UI,Segoe,Segoe WP,Helvetica Neue,Helvetica,sans-serif\";\r\n\r\n    readonly spacing = {\r\n        small: 3,\r\n        default: 8,\r\n        medium: 20,\r\n        large: 30,\r\n        extraLarge: 40,\r\n        padding: 15\r\n    };\r\n\r\n    readonly separator = {\r\n        lineThickness: 1,\r\n        lineColor: \"#EEEEEE\"\r\n    };\r\n\r\n    readonly fontSizes = {\r\n        small: 12,\r\n        default: 14,\r\n        medium: 17,\r\n        large: 21,\r\n        extraLarge: 26\r\n    };\r\n\r\n    readonly fontWeights = {\r\n        lighter: 200,\r\n        default: 400,\r\n        bolder: 600\r\n    };\r\n    readonly imageSizes = {\r\n        small: 40,\r\n        medium: 80,\r\n        large: 160\r\n    };\r\n\r\n    readonly containerStyles: ContainerStyleSet = new ContainerStyleSet();\r\n    readonly actions: ActionsConfig = new ActionsConfig();\r\n    readonly adaptiveCard: AdaptiveCardConfig = new AdaptiveCardConfig();\r\n    readonly imageSet: ImageSetConfig = new ImageSetConfig();\r\n    readonly media: MediaConfig = new MediaConfig();\r\n    readonly factSet: FactSetConfig = new FactSetConfig();\r\n\r\n    cssClassNamePrefix: string = null;\r\n\r\n    constructor(obj?: any) {\r\n        if (obj) {\r\n            if (typeof obj === \"string\" || obj instanceof String) {\r\n                obj = JSON.parse(obj as string);\r\n            }\r\n\r\n            this.choiceSetInputValueSeparator = (obj && typeof obj[\"choiceSetInputValueSeparator\"] === \"string\") ? obj[\"choiceSetInputValueSeparator\"] : this.choiceSetInputValueSeparator;\r\n            this.supportsInteractivity = (obj && typeof obj[\"supportsInteractivity\"] === \"boolean\") ? obj[\"supportsInteractivity\"] : this.supportsInteractivity;\r\n            this.fontFamily = obj[\"fontFamily\"] || this.fontFamily;\r\n            this.fontSizes = {\r\n                small: obj.fontSizes && obj.fontSizes[\"small\"] || this.fontSizes.small,\r\n                default: obj.fontSizes && obj.fontSizes[\"default\"] || this.fontSizes.default,\r\n                medium: obj.fontSizes && obj.fontSizes[\"medium\"] || this.fontSizes.medium,\r\n                large: obj.fontSizes && obj.fontSizes[\"large\"] || this.fontSizes.large,\r\n                extraLarge: obj.fontSizes && obj.fontSizes[\"extraLarge\"] || this.fontSizes.extraLarge\r\n            };\r\n\r\n            if (obj.lineHeights) {\r\n                this.lineHeights = {\r\n                    small: obj.lineHeights[\"small\"],\r\n                    default: obj.lineHeights[\"default\"],\r\n                    medium: obj.lineHeights[\"medium\"],\r\n                    large: obj.lineHeights[\"large\"],\r\n                    extraLarge: obj.lineHeights[\"extraLarge\"]\r\n                };\r\n            };\r\n\r\n            this.fontWeights = {\r\n                lighter: obj.fontWeights && obj.fontWeights[\"lighter\"] || this.fontWeights.lighter,\r\n                default: obj.fontWeights && obj.fontWeights[\"default\"] || this.fontWeights.default,\r\n                bolder: obj.fontWeights && obj.fontWeights[\"bolder\"] || this.fontWeights.bolder\r\n            };\r\n\r\n            this.imageSizes = {\r\n                small: obj.imageSizes && obj.imageSizes[\"small\"] || this.imageSizes.small,\r\n                medium: obj.imageSizes && obj.imageSizes[\"medium\"] || this.imageSizes.medium,\r\n                large: obj.imageSizes && obj.imageSizes[\"large\"] || this.imageSizes.large,\r\n            };\r\n\r\n            this.containerStyles = new ContainerStyleSet(obj[\"containerStyles\"]);\r\n            this.spacing = {\r\n                small: obj.spacing && obj.spacing[\"small\"] || this.spacing.small,\r\n                default: obj.spacing && obj.spacing[\"default\"] || this.spacing.default,\r\n                medium: obj.spacing && obj.spacing[\"medium\"] || this.spacing.medium,\r\n                large: obj.spacing && obj.spacing[\"large\"] || this.spacing.large,\r\n                extraLarge: obj.spacing && obj.spacing[\"extraLarge\"] || this.spacing.extraLarge,\r\n                padding: obj.spacing && obj.spacing[\"padding\"] || this.spacing.padding\r\n            };\r\n\r\n            this.separator = {\r\n                lineThickness: obj.separator && obj.separator[\"lineThickness\"] || this.separator.lineThickness,\r\n                lineColor: obj.separator && obj.separator[\"lineColor\"] || this.separator.lineColor\r\n            }\r\n\r\n            this.actions = new ActionsConfig(obj.actions || this.actions);\r\n            this.adaptiveCard = new AdaptiveCardConfig(obj.adaptiveCard || this.adaptiveCard);\r\n            this.imageSet = new ImageSetConfig(obj[\"imageSet\"]);\r\n            this.factSet = new FactSetConfig(obj[\"factSet\"])\r\n        }\r\n    }\r\n\r\n    getEffectiveSpacing(spacing: Enums.Spacing): number {\r\n        switch (spacing) {\r\n            case Enums.Spacing.Small:\r\n                return this.spacing.small;\r\n            case Enums.Spacing.Default:\r\n                return this.spacing.default;\r\n            case Enums.Spacing.Medium:\r\n                return this.spacing.medium;\r\n            case Enums.Spacing.Large:\r\n                return this.spacing.large;\r\n            case Enums.Spacing.ExtraLarge:\r\n                return this.spacing.extraLarge;\r\n            case Enums.Spacing.Padding:\r\n                return this.spacing.padding;\r\n            default:\r\n                return 0;\r\n        }\r\n    }\r\n\r\n    makeCssClassName(...classNames: string[]): string {\r\n        let result = \"\";\r\n\r\n        for (let i = 0; i < classNames.length; i++) {\r\n            if (i > 0) {\r\n                result += \" \";\r\n            }\r\n\r\n            if (this.cssClassNamePrefix) {\r\n                result += this.cssClassNamePrefix + \"-\";\r\n            }\r\n\r\n            result += classNames[i];\r\n        }\r\n\r\n        return result;\r\n    }\r\n}\r\n","export * from \"./card-elements\";\r\nexport * from \"./enums\";\r\nexport * from \"./host-config\";\r\nexport { SizeAndUnit, getEnumValueOrDefault } from \"./utils\";\r\nexport { IAdaptiveCard, ICardElement } from \"./schema\";","import * as Enums from \"./enums\";\r\nimport * as Utils from \"./utils\";\r\nimport * as HostConfig from \"./host-config\";\r\nimport * as TextFormatters from \"./text-formatters\";\r\n\r\nfunction invokeSetCollection(action: Action, collection: ActionCollection) {\r\n\tif (action) {\r\n\t\t// Closest emulation of \"internal\" in TypeScript.\r\n\t\taction[\"setCollection\"](collection);\r\n\t}\r\n}\r\n\r\nfunction isActionAllowed(action: Action, forbiddenActionTypes: Array<string>): boolean {\r\n\tif (forbiddenActionTypes) {\r\n\t\tfor (var i = 0; i < forbiddenActionTypes.length; i++) {\r\n\t\t\tif (action.getJsonTypeName() === forbiddenActionTypes[i]) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn true;\r\n}\r\n\r\nfunction generateUniqueId(): string {\r\n\treturn \"__ac-\" + Utils.UUID.generate();\r\n}\r\n\r\nfunction createCardObjectInstance<T extends ICardObject>(\r\n\tparent: CardElement,\r\n\tjson: any,\r\n\tcreateInstanceCallback: (typeName: string) => T,\r\n\tcreateValidationErrorCallback: (typeName: string) => HostConfig.IValidationError,\r\n\terrors: Array<HostConfig.IValidationError>): T {\r\n\tlet result: T = null;\r\n\r\n\tif (json && typeof json === \"object\") {\r\n\t\tlet tryToFallback = false;\r\n\t\tlet typeName = json[\"type\"];\r\n\r\n\t\tresult = createInstanceCallback(typeName);\r\n\r\n\t\tif (!result) {\r\n\t\t\ttryToFallback = true;\r\n\r\n\t\t\traiseParseError(createValidationErrorCallback(typeName), errors);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tresult.setParent(parent);\r\n\t\t\tresult.parse(json);\r\n\r\n\t\t\ttryToFallback = result.shouldFallback();\r\n\t\t}\r\n\r\n\t\tif (tryToFallback) {\r\n\t\t\tlet fallback = json[\"fallback\"];\r\n\r\n\t\t\tif (!fallback) {\r\n\t\t\t\tparent.setShouldFallback(true);\r\n\t\t\t}\r\n\t\t\tif (typeof fallback === \"string\" && fallback.toLowerCase() === \"drop\") {\r\n\t\t\t\tresult = null;\r\n\t\t\t}\r\n\t\t\telse if (typeof fallback === \"object\") {\r\n\t\t\t\tresult = createCardObjectInstance<T>(\r\n\t\t\t\t\tparent,\r\n\t\t\t\t\tfallback,\r\n\t\t\t\t\tcreateInstanceCallback,\r\n\t\t\t\t\tcreateValidationErrorCallback,\r\n\t\t\t\t\terrors);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\nexport function createActionInstance(\r\n\tparent: CardElement,\r\n\tjson: any,\r\n\terrors: Array<HostConfig.IValidationError>): Action {\r\n\treturn createCardObjectInstance<Action>(\r\n\t\tparent,\r\n\t\tjson,\r\n\t\t(typeName: string) => { return AdaptiveCard.actionTypeRegistry.createInstance(typeName); },\r\n\t\t(typeName: string) => {\r\n\t\t\treturn {\r\n\t\t\t\terror: Enums.ValidationError.UnknownActionType,\r\n\t\t\t\tmessage: \"Unknown action type: \" + typeName + \". Attempting to fall back.\"\r\n\t\t\t}\r\n\t\t},\r\n\t\terrors);\r\n}\r\n\r\nexport function createElementInstance(\r\n\tparent: CardElement,\r\n\tjson: any,\r\n\terrors: Array<HostConfig.IValidationError>): CardElement {\r\n\treturn createCardObjectInstance<CardElement>(\r\n\t\tparent,\r\n\t\tjson,\r\n\t\t(typeName: string) => { return AdaptiveCard.elementTypeRegistry.createInstance(typeName); },\r\n\t\t(typeName: string) => {\r\n\t\t\treturn {\r\n\t\t\t\terror: Enums.ValidationError.UnknownElementType,\r\n\t\t\t\tmessage: \"Unknown element type: \" + typeName + \". Attempting to fall back.\"\r\n\t\t\t}\r\n\t\t},\r\n\t\terrors);\r\n}\r\n\r\nexport class SpacingDefinition {\r\n\tleft: number = 0;\r\n\ttop: number = 0;\r\n\tright: number = 0;\r\n\tbottom: number = 0;\r\n\r\n\tconstructor(top: number = 0,\r\n\t\tright: number = 0,\r\n\t\tbottom: number = 0,\r\n\t\tleft: number = 0) {\r\n\t\tthis.top = top;\r\n\t\tthis.right = right;\r\n\t\tthis.bottom = bottom;\r\n\t\tthis.left = left;\r\n\t}\r\n}\r\n\r\nexport class PaddingDefinition {\r\n\ttop: Enums.Spacing = Enums.Spacing.None;\r\n\tright: Enums.Spacing = Enums.Spacing.None;\r\n\tbottom: Enums.Spacing = Enums.Spacing.None;\r\n\tleft: Enums.Spacing = Enums.Spacing.None;\r\n\r\n\tconstructor(top: Enums.Spacing = Enums.Spacing.None,\r\n\t\tright: Enums.Spacing = Enums.Spacing.None,\r\n\t\tbottom: Enums.Spacing = Enums.Spacing.None,\r\n\t\tleft: Enums.Spacing = Enums.Spacing.None) {\r\n\t\tthis.top = top;\r\n\t\tthis.right = right;\r\n\t\tthis.bottom = bottom;\r\n\t\tthis.left = left;\r\n\t}\r\n\r\n\ttoSpacingDefinition(hostConfig: HostConfig.HostConfig): SpacingDefinition {\r\n\t\treturn new SpacingDefinition(\r\n\t\t\thostConfig.getEffectiveSpacing(this.top),\r\n\t\t\thostConfig.getEffectiveSpacing(this.right),\r\n\t\t\thostConfig.getEffectiveSpacing(this.bottom),\r\n\t\t\thostConfig.getEffectiveSpacing(this.left));\r\n\t}\r\n}\r\n\r\nexport class SizeAndUnit {\r\n\tphysicalSize: number;\r\n\tunit: Enums.SizeUnit;\r\n\r\n\tstatic parse(input: any): SizeAndUnit {\r\n\t\tlet result = new SizeAndUnit(0, Enums.SizeUnit.Weight);\r\n\r\n\t\tlet regExp = /^([0-9]+)(px|\\*)?$/g;\r\n\t\tlet matches = regExp.exec(input);\r\n\r\n\t\tif (matches && matches.length >= 2) {\r\n\t\t\tresult.physicalSize = parseInt(matches[1]);\r\n\r\n\t\t\tif (matches.length == 3) {\r\n\t\t\t\tif (matches[2] == \"px\") {\r\n\t\t\t\t\tresult.unit = Enums.SizeUnit.Pixel;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tthrow new Error(\"Invalid size: \" + input);\r\n\t}\r\n\r\n\tconstructor(physicalSize: number, unit: Enums.SizeUnit) {\r\n\t\tthis.physicalSize = physicalSize;\r\n\t\tthis.unit = unit;\r\n\t}\r\n}\r\n\r\nexport interface IResourceInformation {\r\n\turl: string;\r\n\tmimeType: string;\r\n}\r\n\r\nexport interface ICardObject {\r\n\tshouldFallback(): boolean;\r\n\tsetParent(parent: CardElement);\r\n\tparse(json: any);\r\n}\r\n\r\nexport abstract class CardElement implements ICardObject {\r\n\tprivate _shouldFallback: boolean = false;\r\n\tprivate _lang: string = undefined;\r\n\tprivate _hostConfig?: HostConfig.HostConfig = null;\r\n\tprivate _internalPadding: PaddingDefinition = null;\r\n\tprivate _parent: CardElement = null;\r\n\tprivate _renderedElement: HTMLElement = null;\r\n\tprivate _separatorElement: HTMLElement = null;\r\n\tprivate _isVisible: boolean = true;\r\n\tprivate _truncatedDueToOverflow: boolean = false;\r\n\tprivate _defaultRenderedElementDisplayMode: string = null;\r\n\tprivate _padding: PaddingDefinition = null;\r\n\r\n\tprivate internalRenderSeparator(): HTMLElement {\r\n\t\treturn Utils.renderSeparation(\r\n\t\t\t{\r\n\t\t\t\tspacing: this.hostConfig.getEffectiveSpacing(this.spacing),\r\n\t\t\t\tlineThickness: this.separator ? this.hostConfig.separator.lineThickness : null,\r\n\t\t\t\tlineColor: this.separator ? this.hostConfig.separator.lineColor : null\r\n\t\t\t},\r\n\t\t\tthis.separatorOrientation);\r\n\t}\r\n\r\n\tprivate updateRenderedElementVisibility() {\r\n\t\tif (this._renderedElement) {\r\n\t\t\tthis._renderedElement.style.display = this._isVisible ? this._defaultRenderedElementDisplayMode : \"none\";\r\n\t\t}\r\n\r\n\t\tif (this._separatorElement) {\r\n\t\t\tif (this.parent && this.parent.isFirstElement(this)) {\r\n\t\t\t\tthis._separatorElement.style.display = \"none\";\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._separatorElement.style.display = this._isVisible ? this._defaultRenderedElementDisplayMode : \"none\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate hideElementDueToOverflow() {\r\n\t\tif (this._renderedElement && this._isVisible) {\r\n\t\t\tthis._renderedElement.style.visibility = 'hidden';\r\n\t\t\tthis._isVisible = false;\r\n\t\t\traiseElementVisibilityChangedEvent(this, false);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate showElementHiddenDueToOverflow() {\r\n\t\tif (this._renderedElement && !this._isVisible) {\r\n\t\t\tthis._renderedElement.style.visibility = null;\r\n\t\t\tthis._isVisible = true;\r\n\t\t\traiseElementVisibilityChangedEvent(this, false);\r\n\t\t}\r\n\t}\r\n\r\n\t// Marked private to emulate internal access\r\n\tprivate handleOverflow(maxHeight: number) {\r\n\t\tif (this.isVisible || this.isHiddenDueToOverflow()) {\r\n\t\t\tvar handled = this.truncateOverflow(maxHeight);\r\n\r\n\t\t\t// Even if we were unable to truncate the element to fit this time,\r\n\t\t\t// it still could have been previously truncated\r\n\t\t\tthis._truncatedDueToOverflow = handled || this._truncatedDueToOverflow;\r\n\r\n\t\t\tif (!handled) {\r\n\t\t\t\tthis.hideElementDueToOverflow();\r\n\t\t\t}\r\n\t\t\telse if (handled && !this._isVisible) {\r\n\t\t\t\tthis.showElementHiddenDueToOverflow();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// Marked private to emulate internal access\r\n\tprivate resetOverflow(): boolean {\r\n\t\tvar sizeChanged = false;\r\n\r\n\t\tif (this._truncatedDueToOverflow) {\r\n\t\t\tthis.undoOverflowTruncation();\r\n\t\t\tthis._truncatedDueToOverflow = false;\r\n\t\t\tsizeChanged = true;\r\n\t\t}\r\n\r\n\t\tif (this.isHiddenDueToOverflow) {\r\n\t\t\tthis.showElementHiddenDueToOverflow();\r\n\t\t}\r\n\r\n\t\treturn sizeChanged;\r\n\t}\r\n\r\n\tprotected createPlaceholderElement(): HTMLElement {\r\n\t\tvar element = document.createElement(\"div\");\r\n\t\telement.style.border = \"1px dashed #DDDDDD\";\r\n\t\telement.style.padding = \"4px\";\r\n\t\telement.style.minHeight = \"32px\";\r\n\t\telement.style.fontSize = \"10px\";\r\n\t\telement.innerText = \"Empty \" + this.getJsonTypeName();\r\n\r\n\t\treturn element;\r\n\t}\r\n\r\n\tprotected internalGetNonZeroPadding(padding: PaddingDefinition,\r\n\t\tprocessTop: boolean = true,\r\n\t\tprocessRight: boolean = true,\r\n\t\tprocessBottom: boolean = true,\r\n\t\tprocessLeft: boolean = true) {\r\n\t\tif (processTop) {\r\n\t\t\tif (padding.top == Enums.Spacing.None) {\r\n\t\t\t\tpadding.top = this.internalPadding.top;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (processRight) {\r\n\t\t\tif (padding.right == Enums.Spacing.None) {\r\n\t\t\t\tpadding.right = this.internalPadding.right;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (processBottom) {\r\n\t\t\tif (padding.bottom == Enums.Spacing.None) {\r\n\t\t\t\tpadding.bottom = this.internalPadding.bottom;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (processLeft) {\r\n\t\t\tif (padding.left == Enums.Spacing.None) {\r\n\t\t\t\tpadding.left = this.internalPadding.left;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.parent) {\r\n\t\t\tthis.parent.internalGetNonZeroPadding(\r\n\t\t\t\tpadding,\r\n\t\t\t\tprocessTop && this.isAtTheVeryTop(),\r\n\t\t\t\tprocessRight && this.isAtTheVeryRight(),\r\n\t\t\t\tprocessBottom && this.isAtTheVeryBottom(),\r\n\t\t\t\tprocessLeft && this.isAtTheVeryLeft());\r\n\t\t}\r\n\t}\r\n\r\n\tprotected adjustRenderedElementSize(renderedElement: HTMLElement) {\r\n\t\tif (this.height === \"auto\") {\r\n\t\t\trenderedElement.style.flex = \"0 0 auto\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderedElement.style.flex = \"1 1 auto\";\r\n\t\t}\r\n\t}\r\n\r\n\tprotected abstract internalRender(): HTMLElement;\r\n\r\n    /*\r\n     * Called when this element overflows the bottom of the card.\r\n     * maxHeight will be the amount of space still available on the card (0 if\r\n     * the element is fully off the card).\r\n     */\r\n\tprotected truncateOverflow(maxHeight: number): boolean {\r\n\t\t// Child implementations should return true if the element handled\r\n\t\t// the truncation request such that its content fits within maxHeight,\r\n\t\t// false if the element should fall back to being hidden\r\n\t\treturn false;\r\n\t}\r\n\r\n    /*\r\n     * This should reverse any changes performed in truncateOverflow().\r\n     */\r\n\tprotected undoOverflowTruncation() { }\r\n\r\n\tprotected isDesignMode(): boolean {\r\n\t\tvar rootElement = this.getRootElement();\r\n\r\n\t\treturn rootElement instanceof AdaptiveCard && rootElement.designMode;\r\n\t}\r\n\r\n\tprotected get useDefaultSizing(): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tprotected get allowCustomPadding(): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tprotected get defaultPadding(): PaddingDefinition {\r\n\t\treturn new PaddingDefinition();\r\n\t}\r\n\r\n\tprotected get internalPadding(): PaddingDefinition {\r\n\t\tif (this._padding) {\r\n\t\t\treturn this._padding;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn (this._internalPadding && this.allowCustomPadding) ? this._internalPadding : this.defaultPadding;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected set internalPadding(value: PaddingDefinition) {\r\n\t\tthis._internalPadding = value;\r\n\t}\r\n\r\n\tprotected get separatorOrientation(): Enums.Orientation {\r\n\t\treturn Enums.Orientation.Horizontal;\r\n\t}\r\n\r\n\tprotected getPadding(): PaddingDefinition {\r\n\t\treturn this._padding;\r\n\t}\r\n\r\n\tprotected setPadding(value: PaddingDefinition) {\r\n\t\tthis._padding = value;\r\n\r\n\t\tif (this._padding) {\r\n\t\t\tAdaptiveCard.useAutomaticContainerBleeding = false;\r\n\t\t}\r\n\t}\r\n\r\n\treadonly requires = new HostConfig.HostCapabilities();\r\n\r\n\tid: string;\r\n\tspeak: string;\r\n\thorizontalAlignment?: Enums.HorizontalAlignment = null;\r\n\tspacing: Enums.Spacing = Enums.Spacing.Default;\r\n\tseparator: boolean = false;\r\n\theight: \"auto\" | \"stretch\" = \"auto\";\r\n\tcustomCssSelector: string = null;\r\n\r\n\tabstract getJsonTypeName(): string;\r\n\tabstract renderSpeech(): string;\r\n\r\n\ttoJSON() {\r\n\t\tlet result = {};\r\n\r\n\t\tUtils.setProperty(result, \"type\", this.getJsonTypeName());\r\n\t\tUtils.setProperty(result, \"id\", this.id);\r\n\r\n\t\tif (this.horizontalAlignment !== null) {\r\n\t\t\tUtils.setEnumProperty(Enums.HorizontalAlignment, result, \"horizontalAlignment\", this.horizontalAlignment);\r\n\t\t}\r\n\r\n\t\tUtils.setEnumProperty(Enums.Spacing, result, \"spacing\", this.spacing, Enums.Spacing.Default);\r\n\t\tUtils.setProperty(result, \"separator\", this.separator, false);\r\n\t\tUtils.setProperty(result, \"height\", this.height, \"auto\");\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tsetParent(value: CardElement) {\r\n\t\tthis._parent = value;\r\n\t}\r\n\r\n\tgetNonZeroPadding(): PaddingDefinition {\r\n\t\tvar padding: PaddingDefinition = new PaddingDefinition();\r\n\r\n\t\tthis.internalGetNonZeroPadding(padding);\r\n\r\n\t\treturn padding;\r\n\t}\r\n\r\n\tgetForbiddenElementTypes(): Array<string> {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tgetForbiddenActionTypes(): Array<any> {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\traiseParseElementEvent(this, json, errors);\r\n\r\n\t\tthis.requires.parse(json[\"requires\"], errors);\r\n\t\tthis.id = json[\"id\"];\r\n\t\tthis.speak = json[\"speak\"];\r\n\t\tthis.horizontalAlignment = Utils.getEnumValueOrDefault(Enums.HorizontalAlignment, json[\"horizontalAlignment\"], null);\r\n\r\n\t\tthis.spacing = Utils.getEnumValueOrDefault(Enums.Spacing, json[\"spacing\"], Enums.Spacing.Default);\r\n\t\tthis.separator = json[\"separator\"];\r\n\r\n\t\tvar jsonSeparation = json[\"separation\"];\r\n\r\n\t\tif (jsonSeparation !== undefined) {\r\n\t\t\tif (jsonSeparation === \"none\") {\r\n\t\t\t\tthis.spacing = Enums.Spacing.None;\r\n\t\t\t\tthis.separator = false;\r\n\t\t\t}\r\n\t\t\telse if (jsonSeparation === \"strong\") {\r\n\t\t\t\tthis.spacing = Enums.Spacing.Large;\r\n\t\t\t\tthis.separator = true;\r\n\t\t\t}\r\n\t\t\telse if (jsonSeparation === \"default\") {\r\n\t\t\t\tthis.spacing = Enums.Spacing.Default;\r\n\t\t\t\tthis.separator = false;\r\n\t\t\t}\r\n\r\n\t\t\traiseParseError(\r\n\t\t\t\t{\r\n\t\t\t\t\terror: Enums.ValidationError.Deprecated,\r\n\t\t\t\t\tmessage: \"The \\\"separation\\\" property is deprecated and will be removed. Use the \\\"spacing\\\" and \\\"separator\\\" properties instead.\"\r\n\t\t\t\t},\r\n\t\t\t\terrors\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tvar jsonHeight = json[\"height\"];\r\n\r\n\t\tif (jsonHeight === \"auto\" || jsonHeight === \"stretch\") {\r\n\t\t\tthis.height = jsonHeight;\r\n\t\t}\r\n\t}\r\n\r\n\tgetActionCount(): number {\r\n\t\treturn 0;\r\n\t}\r\n\r\n\tgetActionAt(index: number): Action {\r\n\t\tthrow new Error(\"Index out of range.\");\r\n\t}\r\n\r\n\tvalidate(): Array<HostConfig.IValidationError> {\r\n\t\treturn [];\r\n\t}\r\n\r\n\tremove(): boolean {\r\n\t\tif (this.parent && this.parent instanceof CardElementContainer) {\r\n\t\t\treturn this.parent.removeItem(this);\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\trender(): HTMLElement {\r\n\t\tthis._renderedElement = this.internalRender();\r\n\t\tthis._separatorElement = this.internalRenderSeparator();\r\n\r\n\t\tif (this._renderedElement) {\r\n\t\t\tif (this.customCssSelector) {\r\n\t\t\t\tthis._renderedElement.classList.add(this.customCssSelector);\r\n\t\t\t}\r\n\r\n\t\t\tthis._renderedElement.style.boxSizing = \"border-box\";\r\n\t\t\tthis._defaultRenderedElementDisplayMode = this._renderedElement.style.display;\r\n\r\n\t\t\tthis.adjustRenderedElementSize(this._renderedElement);\r\n\t\t\tthis.updateLayout(false);\r\n\t\t}\r\n\t\telse if (this.isDesignMode()) {\r\n\t\t\tthis._renderedElement = this.createPlaceholderElement();\r\n\t\t}\r\n\r\n\t\treturn this._renderedElement;\r\n\t}\r\n\r\n\tupdateLayout(processChildren: boolean = true) {\r\n\t\tthis.updateRenderedElementVisibility();\r\n\t}\r\n\r\n\tindexOf(cardElement: CardElement): number {\r\n\t\treturn -1;\r\n\t}\r\n\r\n\tisRendered(): boolean {\r\n\t\treturn this._renderedElement && this._renderedElement.offsetHeight > 0;\r\n\t}\r\n\r\n\tisAtTheVeryTop(): boolean {\r\n\t\treturn this.parent ? this.parent.isFirstElement(this) && this.parent.isAtTheVeryTop() : true;\r\n\t}\r\n\r\n\tisFirstElement(element: CardElement): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tisAtTheVeryBottom(): boolean {\r\n\t\treturn this.parent ? this.parent.isLastElement(this) && this.parent.isAtTheVeryBottom() : true;\r\n\t}\r\n\r\n\tisLastElement(element: CardElement): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tisAtTheVeryLeft(): boolean {\r\n\t\treturn this.parent ? this.parent.isLeftMostElement(this) && this.parent.isAtTheVeryLeft() : true;\r\n\t}\r\n\r\n\tisBleeding(): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tisLeftMostElement(element: CardElement): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tisAtTheVeryRight(): boolean {\r\n\t\treturn this.parent ? this.parent.isRightMostElement(this) && this.parent.isAtTheVeryRight() : true;\r\n\t}\r\n\r\n\tisRightMostElement(element: CardElement): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tisHiddenDueToOverflow(): boolean {\r\n\t\treturn this._renderedElement && this._renderedElement.style.visibility == 'hidden';\r\n\t}\r\n\r\n\tcanContentBleed(): boolean {\r\n\t\treturn this.parent ? this.parent.canContentBleed() : true;\r\n\t}\r\n\r\n\tgetRootElement(): CardElement {\r\n\t\tvar rootElement: CardElement = this;\r\n\r\n\t\twhile (rootElement.parent) {\r\n\t\t\trootElement = rootElement.parent;\r\n\t\t}\r\n\r\n\t\treturn rootElement;\r\n\t}\r\n\r\n\tgetParentContainer(): Container {\r\n\t\tvar currentElement: CardElement = this.parent;\r\n\r\n\t\twhile (currentElement) {\r\n\t\t\tif (currentElement instanceof Container) {\r\n\t\t\t\treturn <Container>currentElement;\r\n\t\t\t}\r\n\r\n\t\t\tcurrentElement = currentElement.parent;\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tgetAllInputs(): Array<Input> {\r\n\t\treturn [];\r\n\t}\r\n\r\n\tgetResourceInformation(): Array<IResourceInformation> {\r\n\t\treturn [];\r\n\t}\r\n\r\n\tgetElementById(id: string): CardElement {\r\n\t\treturn this.id === id ? this : null;\r\n\t}\r\n\r\n\tgetActionById(id: string): Action {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tshouldFallback(): boolean {\r\n\t\treturn this._shouldFallback || !this.requires.areAllMet(this.hostConfig.hostCapabilities);\r\n\t}\r\n\r\n\tsetShouldFallback(value: boolean) {\r\n\t\tthis._shouldFallback = value;\r\n\t}\r\n\r\n\tget lang(): string {\r\n\t\tif (this._lang) {\r\n\t\t\treturn this._lang;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (this.parent) {\r\n\t\t\t\treturn this.parent.lang;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tset lang(value: string) {\r\n\t\tif (value && value != \"\") {\r\n\t\t\tvar regEx = /^[a-z]{2,3}$/ig;\r\n\r\n\t\t\tvar matches = regEx.exec(value);\r\n\r\n\t\t\tif (!matches) {\r\n\t\t\t\tthrow new Error(\"Invalid language identifier: \" + value);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._lang = value;\r\n\t}\r\n\r\n\tget hostConfig(): HostConfig.HostConfig {\r\n\t\tif (this._hostConfig) {\r\n\t\t\treturn this._hostConfig;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (this.parent) {\r\n\t\t\t\treturn this.parent.hostConfig;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn defaultHostConfig;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tset hostConfig(value: HostConfig.HostConfig) {\r\n\t\tthis._hostConfig = value;\r\n\t}\r\n\r\n\tget index(): number {\r\n\t\tif (this.parent) {\r\n\t\t\treturn this.parent.indexOf(this);\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t}\r\n\r\n\tget isInteractive(): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tget isStandalone(): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tget parent(): CardElement {\r\n\t\treturn this._parent;\r\n\t}\r\n\r\n\tget isVisible(): boolean {\r\n\t\treturn this._isVisible;\r\n\t}\r\n\r\n\tget hasVisibleSeparator(): boolean {\r\n\t\tvar parentContainer = this.getParentContainer();\r\n\r\n\t\tif (parentContainer) {\r\n\t\t\treturn this.separatorElement && !parentContainer.isFirstElement(this);\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tset isVisible(value: boolean) {\r\n\t\t// If the element is going to be hidden, reset any changes that were due\r\n\t\t// to overflow truncation (this ensures that if the element is later\r\n\t\t// un-hidden it has the right content)\r\n\t\tif (AdaptiveCard.useAdvancedCardBottomTruncation && !value) {\r\n\t\t\tthis.undoOverflowTruncation();\r\n\t\t}\r\n\r\n\t\tif (this._isVisible != value) {\r\n\t\t\tthis._isVisible = value;\r\n\r\n\t\t\tthis.updateRenderedElementVisibility();\r\n\r\n\t\t\tif (this._renderedElement) {\r\n\t\t\t\traiseElementVisibilityChangedEvent(this);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tget renderedElement(): HTMLElement {\r\n\t\treturn this._renderedElement;\r\n\t}\r\n\r\n\tget separatorElement(): HTMLElement {\r\n\t\treturn this._separatorElement;\r\n\t}\r\n}\r\n\r\nexport abstract class CardElementContainer extends CardElement {\r\n\tabstract getItemCount(): number;\r\n\tabstract getItemAt(index: number): CardElement;\r\n\tabstract removeItem(item: CardElement): boolean;\r\n}\r\n\r\nexport class TextBlock extends CardElement {\r\n\tprivate _computedLineHeight: number;\r\n\tprivate _originalInnerHtml: string;\r\n\tprivate _text: string;\r\n\tprivate _processedText: string = null;\r\n\tprivate _treatAsPlainText: boolean = true;\r\n\tprivate _selectAction: Action = null;\r\n\tprivate _effectiveStyleDefinition: HostConfig.ContainerStyleDefinition = null;\r\n\r\n\tprivate restoreOriginalContent() {\r\n\t\tvar maxHeight = this.maxLines\r\n\t\t\t? (this._computedLineHeight * this.maxLines) + 'px'\r\n\t\t\t: null;\r\n\r\n\t\tthis.renderedElement.style.maxHeight = maxHeight;\r\n\t\tthis.renderedElement.innerHTML = this._originalInnerHtml;\r\n\t}\r\n\r\n\tprivate truncateIfSupported(maxHeight: number): boolean {\r\n\t\t// For now, only truncate TextBlocks that contain just a single\r\n\t\t// paragraph -- since the maxLines calculation doesn't take into\r\n\t\t// account Markdown lists\r\n\t\tvar children = this.renderedElement.children;\r\n\t\tvar isTextOnly = !children.length;\r\n\r\n\t\tvar truncationSupported = isTextOnly || children.length == 1\r\n\t\t\t&& (<HTMLElement>children[0]).tagName.toLowerCase() == 'p';\r\n\r\n\t\tif (truncationSupported) {\r\n\t\t\tvar element = isTextOnly\r\n\t\t\t\t? this.renderedElement\r\n\t\t\t\t: <HTMLElement>children[0];\r\n\r\n\t\t\tUtils.truncate(element, maxHeight, this._computedLineHeight);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprivate getEffectiveStyleDefinition() {\r\n\t\tif (!this._effectiveStyleDefinition) {\r\n\t\t\tthis._effectiveStyleDefinition = this.hostConfig.containerStyles.default;\r\n\r\n\t\t\tlet parentContainer = this.getParentContainer();\r\n\r\n\t\t\twhile (parentContainer) {\r\n\t\t\t\tif (parentContainer.style) {\r\n\t\t\t\t\tthis._effectiveStyleDefinition = this.hostConfig.containerStyles.getStyleByName(parentContainer.style);\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tparentContainer = parentContainer.getParentContainer();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this._effectiveStyleDefinition;\r\n\t}\r\n\r\n\tprotected getRenderedDomElementType(): string {\r\n\t\treturn \"div\";\r\n\t}\r\n\r\n\tprotected internalRender(): HTMLElement {\r\n\t\tthis._effectiveStyleDefinition = null;\r\n\t\tthis._processedText = null;\r\n\r\n\t\tif (!Utils.isNullOrEmpty(this.text)) {\r\n\t\t\tlet hostConfig = this.hostConfig;\r\n\r\n\t\t\tlet element = document.createElement(this.getRenderedDomElementType());\r\n\t\t\telement.classList.add(hostConfig.makeCssClassName(\"ac-textBlock\"));\r\n\t\t\telement.style.overflow = \"hidden\";\r\n\r\n\t\t\tthis.applyStylesTo(element);\r\n\r\n\t\t\tif (this.selectAction) {\r\n\t\t\t\telement.onclick = (e) => {\r\n\t\t\t\t\tthis.selectAction.execute();\r\n\r\n\t\t\t\t\te.cancelBubble = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!this._processedText) {\r\n\t\t\t\tthis._treatAsPlainText = true;\r\n\r\n\t\t\t\tlet formattedText = TextFormatters.formatText(this.lang, this.text);\r\n\r\n\t\t\t\tif (this.useMarkdown) {\r\n\t\t\t\t\tif (AdaptiveCard.allowMarkForTextHighlighting) {\r\n\t\t\t\t\t\tformattedText = formattedText.replace(/<mark>/g, \"===\").replace(/<\\/mark>/g, \"/==\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet markdownProcessingResult = AdaptiveCard.applyMarkdown(formattedText);\r\n\r\n\t\t\t\t\tif (markdownProcessingResult.didProcess && markdownProcessingResult.outputHtml) {\r\n\t\t\t\t\t\tthis._processedText = markdownProcessingResult.outputHtml;\r\n\t\t\t\t\t\tthis._treatAsPlainText = false;\r\n\r\n\t\t\t\t\t\t// Only process <mark> tag if markdown processing was applied because\r\n\t\t\t\t\t\t// markdown processing is also responsible for sanitizing the input string\r\n\t\t\t\t\t\tif (AdaptiveCard.allowMarkForTextHighlighting) {\r\n\t\t\t\t\t\t\tlet markStyle: string = \"\";\r\n\t\t\t\t\t\t\tlet effectiveStyle = this.getEffectiveStyleDefinition();\r\n\r\n\t\t\t\t\t\t\tif (effectiveStyle.highlightBackgroundColor) {\r\n\t\t\t\t\t\t\t\tmarkStyle += \"background-color: \" + effectiveStyle.highlightBackgroundColor + \";\";\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (effectiveStyle.highlightForegroundColor) {\r\n\t\t\t\t\t\t\t\tmarkStyle += \"color: \" + effectiveStyle.highlightForegroundColor + \";\";\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (!Utils.isNullOrEmpty(markStyle)) {\r\n\t\t\t\t\t\t\t\tmarkStyle = 'style=\"' + markStyle + '\"';\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tthis._processedText = this._processedText.replace(/===/g, \"<mark \" + markStyle + \">\").replace(/\\/==/g, \"</mark>\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis._processedText = formattedText;\r\n\t\t\t\t\t\tthis._treatAsPlainText = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis._processedText = formattedText;\r\n\t\t\t\t\tthis._treatAsPlainText = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this._treatAsPlainText) {\r\n\t\t\t\telement.innerText = this._processedText;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\telement.innerHTML = this._processedText;\r\n\t\t\t}\r\n\r\n\t\t\tif (element.firstElementChild instanceof HTMLElement) {\r\n\t\t\t\tlet firstElementChild = <HTMLElement>element.firstElementChild;\r\n\t\t\t\tfirstElementChild.style.marginTop = \"0px\";\r\n\t\t\t\tfirstElementChild.style.width = \"100%\";\r\n\r\n\t\t\t\tif (!this.wrap) {\r\n\t\t\t\t\tfirstElementChild.style.overflow = \"hidden\";\r\n\t\t\t\t\tfirstElementChild.style.textOverflow = \"ellipsis\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (element.lastElementChild instanceof HTMLElement) {\r\n\t\t\t\t(<HTMLElement>element.lastElementChild).style.marginBottom = \"0px\";\r\n\t\t\t}\r\n\r\n\t\t\tlet anchors = element.getElementsByTagName(\"a\");\r\n\r\n\t\t\tfor (let i = 0; i < anchors.length; i++) {\r\n\t\t\t\tlet anchor = <HTMLAnchorElement>anchors[i];\r\n\t\t\t\tanchor.classList.add(this.hostConfig.makeCssClassName(\"ac-anchor\"));\r\n\t\t\t\tanchor.target = \"_blank\";\r\n\t\t\t\tanchor.onclick = (e) => {\r\n\t\t\t\t\tif (raiseAnchorClickedEvent(this, e.target as HTMLAnchorElement)) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this.wrap) {\r\n\t\t\t\telement.style.wordWrap = \"break-word\";\r\n\r\n\t\t\t\tif (this.maxLines > 0) {\r\n\t\t\t\t\telement.style.maxHeight = (this._computedLineHeight * this.maxLines) + \"px\";\r\n\t\t\t\t\telement.style.overflow = \"hidden\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\telement.style.whiteSpace = \"nowrap\";\r\n\t\t\t\telement.style.textOverflow = \"ellipsis\";\r\n\t\t\t}\r\n\r\n\t\t\tif (AdaptiveCard.useAdvancedTextBlockTruncation || AdaptiveCard.useAdvancedCardBottomTruncation) {\r\n\t\t\t\tthis._originalInnerHtml = element.innerHTML;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.selectAction != null && hostConfig.supportsInteractivity) {\r\n\t\t\t\telement.tabIndex = 0\r\n\t\t\t\telement.setAttribute(\"role\", \"button\");\r\n\t\t\t\telement.setAttribute(\"aria-label\", this.selectAction.title);\r\n\t\t\t\telement.classList.add(hostConfig.makeCssClassName(\"ac-selectable\"));\r\n\t\t\t}\r\n\r\n\t\t\treturn element;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected truncateOverflow(maxHeight: number): boolean {\r\n\t\tif (maxHeight >= this._computedLineHeight) {\r\n\t\t\treturn this.truncateIfSupported(maxHeight);\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprotected undoOverflowTruncation() {\r\n\t\tthis.restoreOriginalContent();\r\n\r\n\t\tif (AdaptiveCard.useAdvancedTextBlockTruncation && this.maxLines) {\r\n\t\t\tvar maxHeight = this._computedLineHeight * this.maxLines;\r\n\t\t\tthis.truncateIfSupported(maxHeight);\r\n\t\t}\r\n\t}\r\n\r\n\tsize: Enums.TextSize = Enums.TextSize.Default;\r\n\tweight: Enums.TextWeight = Enums.TextWeight.Default;\r\n\tcolor: Enums.TextColor = Enums.TextColor.Default;\r\n\tisSubtle: boolean = false;\r\n\twrap: boolean = false;\r\n\tmaxLines: number;\r\n\tuseMarkdown: boolean = true;\r\n\r\n\ttoJSON() {\r\n\t\tlet result = super.toJSON();\r\n\r\n\t\tUtils.setEnumProperty(Enums.TextSize, result, \"size\", this.size, Enums.TextSize.Default);\r\n\t\tUtils.setEnumProperty(Enums.TextWeight, result, \"weight\", this.weight, Enums.TextWeight.Default);\r\n\t\tUtils.setEnumProperty(Enums.TextColor, result, \"color\", this.color, Enums.TextColor.Default);\r\n\t\tUtils.setProperty(result, \"text\", this.text);\r\n\t\tUtils.setProperty(result, \"isSubtle\", this.isSubtle, false);\r\n\t\tUtils.setProperty(result, \"wrap\", this.wrap, false);\r\n\t\tUtils.setProperty(result, \"maxLines\", this.maxLines, 0);\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tapplyStylesTo(targetElement: HTMLElement) {\r\n\t\tif (this.hostConfig.fontFamily) {\r\n\t\t\ttargetElement.style.fontFamily = this.hostConfig.fontFamily;\r\n\t\t}\r\n\r\n\t\tlet parentContainer = this.getParentContainer();\r\n\t\tlet isRtl = parentContainer ? parentContainer.isRtl() : false;\r\n\r\n\t\tswitch (this.horizontalAlignment) {\r\n\t\t\tcase Enums.HorizontalAlignment.Center:\r\n\t\t\t\ttargetElement.style.textAlign = \"center\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase Enums.HorizontalAlignment.Right:\r\n\t\t\t\ttargetElement.style.textAlign = isRtl ? \"left\" : \"right\";\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\ttargetElement.style.textAlign = isRtl ? \"right\" : \"left\";\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tvar fontSize: number;\r\n\r\n\t\tswitch (this.size) {\r\n\t\t\tcase Enums.TextSize.Small:\r\n\t\t\t\tfontSize = this.hostConfig.fontSizes.small;\r\n\t\t\t\tbreak;\r\n\t\t\tcase Enums.TextSize.Medium:\r\n\t\t\t\tfontSize = this.hostConfig.fontSizes.medium;\r\n\t\t\t\tbreak;\r\n\t\t\tcase Enums.TextSize.Large:\r\n\t\t\t\tfontSize = this.hostConfig.fontSizes.large;\r\n\t\t\t\tbreak;\r\n\t\t\tcase Enums.TextSize.ExtraLarge:\r\n\t\t\t\tfontSize = this.hostConfig.fontSizes.extraLarge;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tfontSize = this.hostConfig.fontSizes.default;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tif (this.hostConfig.lineHeights) {\r\n\t\t\tswitch (this.size) {\r\n\t\t\t\tcase Enums.TextSize.Small:\r\n\t\t\t\t\tthis._computedLineHeight = this.hostConfig.lineHeights.small;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Enums.TextSize.Medium:\r\n\t\t\t\t\tthis._computedLineHeight = this.hostConfig.lineHeights.medium;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Enums.TextSize.Large:\r\n\t\t\t\t\tthis._computedLineHeight = this.hostConfig.lineHeights.large;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Enums.TextSize.ExtraLarge:\r\n\t\t\t\t\tthis._computedLineHeight = this.hostConfig.lineHeights.extraLarge;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthis._computedLineHeight = this.hostConfig.lineHeights.default;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// Looks like 1.33 is the magic number to compute line-height\r\n\t\t\t// from font size.\r\n\t\t\tthis._computedLineHeight = fontSize * 1.33;\r\n\t\t}\r\n\r\n\t\ttargetElement.style.fontSize = fontSize + \"px\";\r\n\t\ttargetElement.style.lineHeight = this._computedLineHeight + \"px\";\r\n\r\n\t\tlet styleDefinition = this.getEffectiveStyleDefinition();\r\n\r\n\t\tlet actualTextColor = this.color ? this.color : Enums.TextColor.Default;\r\n\t\tlet colorDefinition: HostConfig.TextColorDefinition;\r\n\r\n\t\tswitch (actualTextColor) {\r\n\t\t\tcase Enums.TextColor.Accent:\r\n\t\t\t\tcolorDefinition = styleDefinition.foregroundColors.accent;\r\n\t\t\t\tbreak;\r\n\t\t\tcase Enums.TextColor.Dark:\r\n\t\t\t\tcolorDefinition = styleDefinition.foregroundColors.dark;\r\n\t\t\t\tbreak;\r\n\t\t\tcase Enums.TextColor.Light:\r\n\t\t\t\tcolorDefinition = styleDefinition.foregroundColors.light;\r\n\t\t\t\tbreak;\r\n\t\t\tcase Enums.TextColor.Good:\r\n\t\t\t\tcolorDefinition = styleDefinition.foregroundColors.good;\r\n\t\t\t\tbreak;\r\n\t\t\tcase Enums.TextColor.Warning:\r\n\t\t\t\tcolorDefinition = styleDefinition.foregroundColors.warning;\r\n\t\t\t\tbreak;\r\n\t\t\tcase Enums.TextColor.Attention:\r\n\t\t\t\tcolorDefinition = styleDefinition.foregroundColors.attention;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tcolorDefinition = styleDefinition.foregroundColors.default;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\ttargetElement.style.color = Utils.stringToCssColor(this.isSubtle ? colorDefinition.subtle : colorDefinition.default);\r\n\r\n\t\tlet fontWeight: number;\r\n\r\n\t\tswitch (this.weight) {\r\n\t\t\tcase Enums.TextWeight.Lighter:\r\n\t\t\t\tfontWeight = this.hostConfig.fontWeights.lighter;\r\n\t\t\t\tbreak;\r\n\t\t\tcase Enums.TextWeight.Bolder:\r\n\t\t\t\tfontWeight = this.hostConfig.fontWeights.bolder;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tfontWeight = this.hostConfig.fontWeights.default;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\ttargetElement.style.fontWeight = fontWeight.toString();\r\n\t}\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tsuper.parse(json, errors);\r\n\r\n\t\tthis.text = json[\"text\"];\r\n\r\n\t\tvar sizeString = json[\"size\"];\r\n\r\n\t\tif (sizeString && typeof sizeString === \"string\" && sizeString.toLowerCase() === \"normal\") {\r\n\t\t\tthis.size = Enums.TextSize.Default;\r\n\r\n\t\t\traiseParseError(\r\n\t\t\t\t{\r\n\t\t\t\t\terror: Enums.ValidationError.Deprecated,\r\n\t\t\t\t\tmessage: \"The TextBlock.size value \\\"normal\\\" is deprecated and will be removed. Use \\\"default\\\" instead.\"\r\n\t\t\t\t},\r\n\t\t\t\terrors\r\n\t\t\t);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.size = Utils.getEnumValueOrDefault(Enums.TextSize, sizeString, this.size);\r\n\t\t}\r\n\r\n\t\tvar weightString = json[\"weight\"];\r\n\r\n\t\tif (weightString && typeof weightString === \"string\" && weightString.toLowerCase() === \"normal\") {\r\n\t\t\tthis.weight = Enums.TextWeight.Default;\r\n\r\n\t\t\traiseParseError(\r\n\t\t\t\t{\r\n\t\t\t\t\terror: Enums.ValidationError.Deprecated,\r\n\t\t\t\t\tmessage: \"The TextBlock.weight value \\\"normal\\\" is deprecated and will be removed. Use \\\"default\\\" instead.\"\r\n\t\t\t\t},\r\n\t\t\t\terrors\r\n\t\t\t);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.weight = Utils.getEnumValueOrDefault(Enums.TextWeight, weightString, this.weight);\r\n\t\t}\r\n\r\n\t\tthis.color = Utils.getEnumValueOrDefault(Enums.TextColor, json[\"color\"], this.color);\r\n\t\tthis.isSubtle = json[\"isSubtle\"];\r\n\t\tthis.wrap = json[\"wrap\"] === undefined ? false : json[\"wrap\"];\r\n\r\n\t\tif (typeof json[\"maxLines\"] === \"number\") {\r\n\t\t\tthis.maxLines = json[\"maxLines\"];\r\n\t\t}\r\n\t}\r\n\r\n\tgetJsonTypeName(): string {\r\n\t\treturn \"TextBlock\";\r\n\t}\r\n\r\n\trenderSpeech(): string {\r\n\t\tif (this.speak != null)\r\n\t\t\treturn this.speak + '\\n';\r\n\r\n\t\tif (this.text)\r\n\t\t\treturn '<s>' + this.text + '</s>\\n';\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tupdateLayout(processChildren: boolean = false) {\r\n\t\tsuper.updateLayout(processChildren);\r\n\r\n\t\tif (AdaptiveCard.useAdvancedTextBlockTruncation && this.maxLines && this.isRendered()) {\r\n\t\t\t// Reset the element's innerHTML in case the available room for\r\n\t\t\t// content has increased\r\n\t\t\tthis.restoreOriginalContent();\r\n\t\t\tvar maxHeight = this._computedLineHeight * this.maxLines;\r\n\t\t\tthis.truncateIfSupported(maxHeight);\r\n\t\t}\r\n\t}\r\n\r\n\tget text(): string {\r\n\t\treturn this._text;\r\n\t}\r\n\r\n\tset text(value: string) {\r\n\t\tif (this._text != value) {\r\n\t\t\tthis._text = value;\r\n\r\n\t\t\tthis._processedText = null;\r\n\t\t}\r\n\t}\r\n\r\n\tget selectAction(): Action {\r\n\t\treturn this._selectAction;\r\n\t}\r\n\r\n\tset selectAction(value: Action) {\r\n\t\tthis._selectAction = value;\r\n\r\n\t\tif (this._selectAction) {\r\n\t\t\tthis._selectAction.setParent(this);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass Label extends TextBlock {\r\n\tprotected getRenderedDomElementType(): string {\r\n\t\treturn \"label\";\r\n\t}\r\n\r\n\tprotected internalRender(): HTMLElement {\r\n\t\tlet renderedElement = <HTMLLabelElement>super.internalRender();\r\n\r\n\t\tif (!Utils.isNullOrEmpty(this.forElementId)) {\r\n\t\t\trenderedElement.htmlFor = this.forElementId;\r\n\t\t}\r\n\r\n\t\treturn renderedElement;\r\n\t}\r\n\r\n\tforElementId: string;\r\n}\r\n\r\nexport class Fact {\r\n\tname: string;\r\n\tvalue: string;\r\n\tspeak: string;\r\n\r\n\tconstructor(name: string = undefined, value: string = undefined) {\r\n\t\tthis.name = name;\r\n\t\tthis.value = value;\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\treturn { title: this.name, value: this.value };\r\n\t}\r\n\r\n\trenderSpeech(): string {\r\n\t\tif (this.speak != null) {\r\n\t\t\treturn this.speak + '\\n';\r\n\t\t}\r\n\r\n\t\treturn '<s>' + this.name + ' ' + this.value + '</s>\\n';\r\n\t}\r\n}\r\n\r\nexport class FactSet extends CardElement {\r\n\tprotected get useDefaultSizing(): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprotected internalRender(): HTMLElement {\r\n\t\tlet element: HTMLElement = null;\r\n\t\tlet hostConfig = this.hostConfig;\r\n\r\n\t\tif (this.facts.length > 0) {\r\n\t\t\telement = document.createElement(\"table\");\r\n\t\t\telement.style.borderWidth = \"0px\";\r\n\t\t\telement.style.borderSpacing = \"0px\";\r\n\t\t\telement.style.borderStyle = \"none\";\r\n\t\t\telement.style.borderCollapse = \"collapse\";\r\n\t\t\telement.style.display = \"block\";\r\n\t\t\telement.style.overflow = \"hidden\";\r\n\t\t\telement.classList.add(hostConfig.makeCssClassName(\"ac-factset\"));\r\n\r\n\t\t\tfor (let i = 0; i < this.facts.length; i++) {\r\n\t\t\t\tlet trElement = document.createElement(\"tr\");\r\n\r\n\t\t\t\tif (i > 0) {\r\n\t\t\t\t\ttrElement.style.marginTop = this.hostConfig.factSet.spacing + \"px\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Title column\r\n\t\t\t\tlet tdElement = document.createElement(\"td\");\r\n\t\t\t\ttdElement.style.padding = \"0\";\r\n\t\t\t\ttdElement.classList.add(hostConfig.makeCssClassName(\"ac-fact-title\"));\r\n\r\n\t\t\t\tif (this.hostConfig.factSet.title.maxWidth) {\r\n\t\t\t\t\ttdElement.style.maxWidth = this.hostConfig.factSet.title.maxWidth + \"px\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttdElement.style.verticalAlign = \"top\";\r\n\r\n\t\t\t\tlet textBlock = new TextBlock();\r\n\t\t\t\ttextBlock.setParent(this);\r\n\t\t\t\ttextBlock.text = Utils.isNullOrEmpty(this.facts[i].name) ? \"Title\" : this.facts[i].name;\r\n\t\t\t\ttextBlock.size = this.hostConfig.factSet.title.size;\r\n\t\t\t\ttextBlock.color = this.hostConfig.factSet.title.color;\r\n\t\t\t\ttextBlock.isSubtle = this.hostConfig.factSet.title.isSubtle;\r\n\t\t\t\ttextBlock.weight = this.hostConfig.factSet.title.weight;\r\n\t\t\t\ttextBlock.wrap = this.hostConfig.factSet.title.wrap;\r\n\t\t\t\ttextBlock.spacing = Enums.Spacing.None;\r\n\r\n\t\t\t\tUtils.appendChild(tdElement, textBlock.render());\r\n\t\t\t\tUtils.appendChild(trElement, tdElement);\r\n\r\n\t\t\t\t// Spacer column\r\n\t\t\t\ttdElement = document.createElement(\"td\");\r\n\t\t\t\ttdElement.style.width = \"10px\";\r\n\r\n\t\t\t\tUtils.appendChild(trElement, tdElement);\r\n\r\n\t\t\t\t// Value column\r\n\t\t\t\ttdElement = document.createElement(\"td\");\r\n\t\t\t\ttdElement.style.verticalAlign = \"top\";\r\n\t\t\t\ttdElement.classList.add(hostConfig.makeCssClassName(\"ac-fact-value\"));\r\n\r\n\t\t\t\ttextBlock = new TextBlock();\r\n\t\t\t\ttextBlock.setParent(this);\r\n\t\t\t\ttextBlock.text = Utils.isNullOrEmpty(this.facts[i].value) ? \"Value\" : this.facts[i].value;\r\n\t\t\t\ttextBlock.size = this.hostConfig.factSet.value.size;\r\n\t\t\t\ttextBlock.color = this.hostConfig.factSet.value.color;\r\n\t\t\t\ttextBlock.isSubtle = this.hostConfig.factSet.value.isSubtle;\r\n\t\t\t\ttextBlock.weight = this.hostConfig.factSet.value.weight;\r\n\t\t\t\ttextBlock.wrap = this.hostConfig.factSet.value.wrap;\r\n\t\t\t\ttextBlock.spacing = Enums.Spacing.None;\r\n\r\n\t\t\t\tUtils.appendChild(tdElement, textBlock.render());\r\n\t\t\t\tUtils.appendChild(trElement, tdElement);\r\n\t\t\t\tUtils.appendChild(element, trElement);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn element;\r\n\t}\r\n\r\n\tfacts: Array<Fact> = [];\r\n\r\n\tgetJsonTypeName(): string {\r\n\t\treturn \"FactSet\";\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\tlet result = super.toJSON();\r\n\r\n\t\tlet facts = []\r\n\r\n\t\tfor (let fact of this.facts) {\r\n\t\t\tfacts.push(fact.toJSON());\r\n\t\t}\r\n\r\n\t\tUtils.setProperty(result, \"facts\", facts);\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tsuper.parse(json, errors);\r\n\r\n\t\tthis.facts = [];\r\n\r\n\t\tif (json[\"facts\"] != null) {\r\n\t\t\tvar jsonFacts = json[\"facts\"] as Array<any>;\r\n\r\n\t\t\tthis.facts = [];\r\n\r\n\t\t\tfor (var i = 0; i < jsonFacts.length; i++) {\r\n\t\t\t\tlet fact = new Fact();\r\n\r\n\t\t\t\tfact.name = jsonFacts[i][\"title\"];\r\n\t\t\t\tfact.value = jsonFacts[i][\"value\"];\r\n\t\t\t\tfact.speak = jsonFacts[i][\"speak\"];\r\n\r\n\t\t\t\tthis.facts.push(fact);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\trenderSpeech(): string {\r\n\t\tif (this.speak != null) {\r\n\t\t\treturn this.speak + '\\n';\r\n\t\t}\r\n\r\n\t\t// render each fact\r\n\t\tlet speak = null;\r\n\r\n\t\tif (this.facts.length > 0) {\r\n\t\t\tspeak = '';\r\n\r\n\t\t\tfor (var i = 0; i < this.facts.length; i++) {\r\n\t\t\t\tlet speech = this.facts[i].renderSpeech();\r\n\r\n\t\t\t\tif (speech) {\r\n\t\t\t\t\tspeak += speech;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn '<p>' + speak + '\\n</p>\\n';\r\n\t}\r\n}\r\n\r\nexport class Image extends CardElement {\r\n\tprivate _selectAction: Action;\r\n\r\n\tprivate parseDimension(name: string, value: any, errors: Array<HostConfig.IValidationError>): number {\r\n\t\tif (value) {\r\n\t\t\tif (typeof value === \"string\") {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tlet size = Utils.SizeAndUnit.parse(value);\r\n\r\n\t\t\t\t\tif (size.unit == Enums.SizeUnit.Pixel) {\r\n\t\t\t\t\t\treturn size.physicalSize;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tcatch {\r\n\t\t\t\t\t// Ignore error\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\traiseParseError(\r\n\t\t\t\t{\r\n\t\t\t\t\terror: Enums.ValidationError.InvalidPropertyValue,\r\n\t\t\t\t\tmessage: \"Invalid image \" + name + \": \" + value\r\n\t\t\t\t},\r\n\t\t\t\terrors\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn 0;\r\n\t}\r\n\r\n\tprivate applySize(element: HTMLElement) {\r\n\t\tif (this.pixelWidth || this.pixelHeight) {\r\n\t\t\tif (this.pixelWidth) {\r\n\t\t\t\telement.style.width = this.pixelWidth + \"px\";\r\n\t\t\t}\r\n\r\n\t\t\tif (this.pixelHeight) {\r\n\t\t\t\telement.style.height = this.pixelHeight + \"px\";\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tswitch (this.size) {\r\n\t\t\t\tcase Enums.Size.Stretch:\r\n\t\t\t\t\telement.style.width = \"100%\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Enums.Size.Auto:\r\n\t\t\t\t\telement.style.maxWidth = \"100%\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Enums.Size.Small:\r\n\t\t\t\t\telement.style.width = this.hostConfig.imageSizes.small + \"px\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Enums.Size.Large:\r\n\t\t\t\t\telement.style.width = this.hostConfig.imageSizes.large + \"px\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Enums.Size.Medium:\r\n\t\t\t\t\telement.style.width = this.hostConfig.imageSizes.medium + \"px\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected get useDefaultSizing() {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprotected internalRender(): HTMLElement {\r\n\t\tvar element: HTMLElement = null;\r\n\r\n\t\tif (!Utils.isNullOrEmpty(this.url)) {\r\n\t\t\telement = document.createElement(\"div\");\r\n\t\t\telement.style.display = \"flex\";\r\n\t\t\telement.style.alignItems = \"flex-start\";\r\n\r\n\t\t\telement.onkeypress = (e) => {\r\n\t\t\t\tif (this.selectAction) {\r\n\t\t\t\t\tif (e.keyCode == 13 || e.keyCode == 32) { // enter or space pressed\r\n\t\t\t\t\t\tthis.selectAction.execute();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\telement.onclick = (e) => {\r\n\t\t\t\tif (this.selectAction) {\r\n\t\t\t\t\tthis.selectAction.execute();\r\n\t\t\t\t\te.cancelBubble = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tswitch (this.horizontalAlignment) {\r\n\t\t\t\tcase Enums.HorizontalAlignment.Center:\r\n\t\t\t\t\telement.style.justifyContent = \"center\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Enums.HorizontalAlignment.Right:\r\n\t\t\t\t\telement.style.justifyContent = \"flex-end\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\telement.style.justifyContent = \"flex-start\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\t// Cache hostConfig to avoid walking the parent hierarchy multiple times\r\n\t\t\tlet hostConfig = this.hostConfig;\r\n\r\n\t\t\tlet imageElement = document.createElement(\"img\");\r\n\t\t\timageElement.onload = (e: Event) => {\r\n\t\t\t\traiseImageLoadedEvent(this);\r\n\t\t\t}\r\n\t\t\timageElement.onerror = (e: Event) => {\r\n\t\t\t\tlet card = this.getRootElement() as AdaptiveCard;\r\n\r\n\t\t\t\tthis.renderedElement.innerHTML = \"\";\r\n\r\n\t\t\t\tif (card && card.designMode) {\r\n\t\t\t\t\tlet errorElement = document.createElement(\"div\");\r\n\t\t\t\t\terrorElement.style.display = \"flex\";\r\n\t\t\t\t\terrorElement.style.alignItems = \"center\";\r\n\t\t\t\t\terrorElement.style.justifyContent = \"center\";\r\n\t\t\t\t\terrorElement.style.backgroundColor = \"#EEEEEE\";\r\n\t\t\t\t\terrorElement.style.color = \"black\";\r\n\t\t\t\t\terrorElement.innerText = \":-(\";\r\n\t\t\t\t\terrorElement.style.padding = \"10px\";\r\n\r\n\t\t\t\t\tthis.applySize(errorElement);\r\n\r\n\t\t\t\t\tthis.renderedElement.appendChild(errorElement);\r\n\t\t\t\t}\r\n\r\n\t\t\t\traiseImageLoadedEvent(this);\r\n\t\t\t}\r\n\t\t\timageElement.style.maxHeight = \"100%\";\r\n\t\t\timageElement.style.minWidth = \"0\";\r\n\t\t\timageElement.classList.add(hostConfig.makeCssClassName(\"ac-image\"));\r\n\r\n\t\t\tif (this.selectAction != null && hostConfig.supportsInteractivity) {\r\n\t\t\t\timageElement.tabIndex = 0\r\n\t\t\t\timageElement.setAttribute(\"role\", \"button\");\r\n\t\t\t\timageElement.setAttribute(\"aria-label\", this.selectAction.title);\r\n\t\t\t\timageElement.classList.add(hostConfig.makeCssClassName(\"ac-selectable\"));\r\n\t\t\t}\r\n\r\n\t\t\tthis.applySize(imageElement);\r\n\r\n\t\t\tif (this.style === Enums.ImageStyle.Person) {\r\n\t\t\t\timageElement.style.borderRadius = \"50%\";\r\n\t\t\t\timageElement.style.backgroundPosition = \"50% 50%\";\r\n\t\t\t\timageElement.style.backgroundRepeat = \"no-repeat\";\r\n\t\t\t}\r\n\r\n\t\t\tif (!Utils.isNullOrEmpty(this.backgroundColor)) {\r\n\t\t\t\timageElement.style.backgroundColor = Utils.stringToCssColor(this.backgroundColor);\r\n\t\t\t}\r\n\r\n\t\t\timageElement.src = this.url;\r\n\t\t\timageElement.alt = this.altText;\r\n\r\n\t\t\telement.appendChild(imageElement);\r\n\t\t}\r\n\r\n\t\treturn element;\r\n\t}\r\n\r\n\tstyle: Enums.ImageStyle = Enums.ImageStyle.Default;\r\n\tbackgroundColor: string;\r\n\turl: string;\r\n\tsize: Enums.Size = Enums.Size.Auto;\r\n\twidth: Utils.SizeAndUnit;\r\n\tpixelWidth?: number = null;\r\n\tpixelHeight?: number = null;\r\n\taltText: string = \"\";\r\n\r\n\ttoJSON() {\r\n\t\tlet result = super.toJSON();\r\n\r\n\t\tif (this._selectAction) {\r\n\t\t\tUtils.setProperty(result, \"selectAction\", this._selectAction.toJSON());\r\n\t\t}\r\n\r\n\t\tUtils.setEnumProperty(Enums.ImageStyle, result, \"style\", this.style, Enums.ImageStyle.Default);\r\n\t\tUtils.setProperty(result, \"backgroundColor\", this.backgroundColor);\r\n\t\tUtils.setProperty(result, \"url\", this.url);\r\n\t\tUtils.setEnumProperty(Enums.Size, result, \"size\", this.size, Enums.Size.Auto);\r\n\r\n\t\tif (this.pixelWidth) {\r\n\t\t\tUtils.setProperty(result, \"width\", this.pixelWidth + \"px\");\r\n\t\t}\r\n\r\n\t\tif (this.pixelHeight) {\r\n\t\t\tUtils.setProperty(result, \"height\", this.pixelHeight + \"px\");\r\n\t\t}\r\n\r\n\t\tUtils.setProperty(result, \"altText\", this.altText);\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tgetJsonTypeName(): string {\r\n\t\treturn \"Image\";\r\n\t}\r\n\r\n\tgetActionById(id: string) {\r\n\t\tvar result = super.getActionById(id);\r\n\r\n\t\tif (!result && this.selectAction) {\r\n\t\t\tresult = this.selectAction.getActionById(id);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tsuper.parse(json, errors);\r\n\r\n\t\tthis.url = json[\"url\"];\r\n\t\tthis.backgroundColor = json[\"backgroundColor\"];\r\n\r\n\t\tvar styleString = json[\"style\"];\r\n\r\n\t\tif (styleString && typeof styleString === \"string\" && styleString.toLowerCase() === \"normal\") {\r\n\t\t\tthis.style = Enums.ImageStyle.Default;\r\n\r\n\t\t\traiseParseError(\r\n\t\t\t\t{\r\n\t\t\t\t\terror: Enums.ValidationError.Deprecated,\r\n\t\t\t\t\tmessage: \"The Image.style value \\\"normal\\\" is deprecated and will be removed. Use \\\"default\\\" instead.\"\r\n\t\t\t\t},\r\n\t\t\t\terrors\r\n\t\t\t);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.style = Utils.getEnumValueOrDefault(Enums.ImageStyle, styleString, this.style);\r\n\t\t}\r\n\r\n\t\tthis.size = Utils.getEnumValueOrDefault(Enums.Size, json[\"size\"], this.size);\r\n\t\tthis.altText = json[\"altText\"];\r\n\r\n\t\t// pixelWidth and pixelHeight are only parsed for backwards compatibility.\r\n\t\t// Payloads should use the width and height proerties instead.\r\n\t\tif (json[\"pixelWidth\"] && typeof json[\"pixelWidth\"] === \"number\") {\r\n\t\t\tthis.pixelWidth = json[\"pixelWidth\"];\r\n\r\n\t\t\traiseParseError(\r\n\t\t\t\t{\r\n\t\t\t\t\terror: Enums.ValidationError.Deprecated,\r\n\t\t\t\t\tmessage: \"The pixelWidth property is deprecated and will be removed. Use the width property instead.\"\r\n\t\t\t\t},\r\n\t\t\t\terrors\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tif (json[\"pixelHeight\"] && typeof json[\"pixelHeight\"] === \"number\") {\r\n\t\t\tthis.pixelHeight = json[\"pixelHeight\"];\r\n\r\n\t\t\traiseParseError(\r\n\t\t\t\t{\r\n\t\t\t\t\terror: Enums.ValidationError.Deprecated,\r\n\t\t\t\t\tmessage: \"The pixelHeight property is deprecated and will be removed. Use the height property instead.\"\r\n\t\t\t\t},\r\n\t\t\t\terrors\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tlet size = this.parseDimension(\"width\", json[\"width\"], errors);\r\n\r\n\t\tif (size > 0) {\r\n\t\t\tthis.pixelWidth = size;\r\n\t\t}\r\n\r\n\t\tsize = this.parseDimension(\"height\", json[\"height\"], errors);\r\n\r\n\t\tif (size > 0) {\r\n\t\t\tthis.pixelHeight = size;\r\n\t\t}\r\n\r\n\t\tthis.selectAction = createActionInstance(\r\n\t\t\tthis,\r\n\t\t\tjson[\"selectAction\"],\r\n\t\t\terrors);\r\n\t}\r\n\r\n\tgetResourceInformation(): Array<IResourceInformation> {\r\n\t\tif (!Utils.isNullOrEmpty(this.url)) {\r\n\t\t\treturn [{ url: this.url, mimeType: \"image\" }]\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\r\n\trenderSpeech(): string {\r\n\t\tif (this.speak != null) {\r\n\t\t\treturn this.speak + '\\n';\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tget selectAction(): Action {\r\n\t\treturn this._selectAction;\r\n\t}\r\n\r\n\tset selectAction(value: Action) {\r\n\t\tthis._selectAction = value;\r\n\r\n\t\tif (this._selectAction) {\r\n\t\t\tthis._selectAction.setParent(this);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class ImageSet extends CardElementContainer {\r\n\tprivate _images: Array<Image> = [];\r\n\r\n\tprotected internalRender(): HTMLElement {\r\n\t\tlet element: HTMLElement = null;\r\n\r\n\t\tif (this._images.length > 0) {\r\n\t\t\telement = document.createElement(\"div\");\r\n\t\t\telement.style.display = \"flex\";\r\n\t\t\telement.style.flexWrap = \"wrap\";\r\n\r\n\t\t\tfor (var i = 0; i < this._images.length; i++) {\r\n\t\t\t\tthis._images[i].size = this.imageSize;\r\n\r\n\t\t\t\tlet renderedImage = this._images[i].render();\r\n\r\n\t\t\t\trenderedImage.style.display = \"inline-flex\";\r\n\t\t\t\trenderedImage.style.margin = \"0px\";\r\n\t\t\t\trenderedImage.style.marginRight = \"10px\";\r\n\t\t\t\trenderedImage.style.maxHeight = this.hostConfig.imageSet.maxImageHeight + \"px\";\r\n\r\n\t\t\t\tUtils.appendChild(element, renderedImage);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn element;\r\n\t}\r\n\r\n\timageSize: Enums.Size = Enums.Size.Medium;\r\n\r\n\tgetItemCount(): number {\r\n\t\treturn this._images.length;\r\n\t}\r\n\r\n\tgetItemAt(index: number): CardElement {\r\n\t\treturn this._images[index];\r\n\t}\r\n\r\n\tgetResourceInformation(): Array<IResourceInformation> {\r\n\t\tlet result: Array<IResourceInformation> = [];\r\n\r\n\t\tfor (let image of this._images) {\r\n\t\t\tresult = result.concat(image.getResourceInformation());\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tremoveItem(item: CardElement): boolean {\r\n\t\tif (item instanceof Image) {\r\n\t\t\tvar itemIndex = this._images.indexOf(item);\r\n\r\n\t\t\tif (itemIndex >= 0) {\r\n\t\t\t\tthis._images.splice(itemIndex, 1);\r\n\r\n\t\t\t\titem.setParent(null);\r\n\r\n\t\t\t\tthis.updateLayout();\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tgetJsonTypeName(): string {\r\n\t\treturn \"ImageSet\";\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\tlet result = super.toJSON();\r\n\r\n\t\tUtils.setEnumProperty(Enums.Size, result, \"imageSize\", this.imageSize, Enums.Size.Medium);\r\n\r\n\t\tif (this._images.length > 0) {\r\n\t\t\tlet images = [];\r\n\r\n\t\t\tfor (let image of this._images) {\r\n\t\t\t\timages.push(image.toJSON());\r\n\t\t\t}\r\n\r\n\t\t\tUtils.setProperty(result, \"images\", images);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tsuper.parse(json, errors);\r\n\r\n\t\tthis.imageSize = Utils.getEnumValueOrDefault(Enums.Size, json[\"imageSize\"], Enums.Size.Medium);\r\n\r\n\t\tif (json[\"images\"] != null) {\r\n\t\t\tlet jsonImages = json[\"images\"] as Array<any>;\r\n\r\n\t\t\tthis._images = [];\r\n\r\n\t\t\tfor (let i = 0; i < jsonImages.length; i++) {\r\n\t\t\t\tvar image = new Image();\r\n\t\t\t\timage.parse(jsonImages[i], errors);\r\n\r\n\t\t\t\tthis.addImage(image);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\taddImage(image: Image) {\r\n\t\tif (!image.parent) {\r\n\t\t\tthis._images.push(image);\r\n\r\n\t\t\timage.setParent(this);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthrow new Error(\"This image already belongs to another ImageSet\");\r\n\t\t}\r\n\t}\r\n\r\n\tindexOf(cardElement: CardElement): number {\r\n\t\treturn cardElement instanceof Image ? this._images.indexOf(cardElement) : -1;\r\n\t}\r\n\r\n\trenderSpeech(): string {\r\n\t\tif (this.speak != null) {\r\n\t\t\treturn this.speak;\r\n\t\t}\r\n\r\n\t\tvar speak = null;\r\n\r\n\t\tif (this._images.length > 0) {\r\n\t\t\tspeak = '';\r\n\r\n\t\t\tfor (var i = 0; i < this._images.length; i++) {\r\n\t\t\t\tspeak += this._images[i].renderSpeech();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn speak;\r\n\t}\r\n}\r\n\r\nexport class MediaSource {\r\n\tmimeType: string;\r\n\turl: string;\r\n\r\n\tconstructor(url: string = undefined, mimeType: string = undefined) {\r\n\t\tthis.url = url;\r\n\t\tthis.mimeType = mimeType;\r\n\t}\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tthis.mimeType = json[\"mimeType\"];\r\n\t\tthis.url = json[\"url\"];\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\treturn {\r\n\t\t\tmimeType: this.mimeType,\r\n\t\t\turl: this.url\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class Media extends CardElement {\r\n\tstatic readonly supportedMediaTypes = [\"audio\", \"video\"];\r\n\r\n\tprivate _selectedMediaType: string;\r\n\tprivate _selectedSources: Array<MediaSource>;\r\n\r\n\tprivate getPosterUrl(): string {\r\n\t\treturn this.poster ? this.poster : this.hostConfig.media.defaultPoster;\r\n\t}\r\n\r\n\tprivate processSources() {\r\n\t\tthis._selectedSources = [];\r\n\t\tthis._selectedMediaType = undefined;\r\n\r\n\t\tfor (let source of this.sources) {\r\n\t\t\tlet mimeComponents = source.mimeType.split('/');\r\n\r\n\t\t\tif (mimeComponents.length == 2) {\r\n\t\t\t\tif (!this._selectedMediaType) {\r\n\t\t\t\t\tlet index = Media.supportedMediaTypes.indexOf(mimeComponents[0]);\r\n\r\n\t\t\t\t\tif (index >= 0) {\r\n\t\t\t\t\t\tthis._selectedMediaType = Media.supportedMediaTypes[index];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (mimeComponents[0] == this._selectedMediaType) {\r\n\t\t\t\t\tthis._selectedSources.push(source);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate renderPoster(): HTMLElement {\r\n\t\tconst playButtonArrowWidth = 12;\r\n\t\tconst playButtonArrowHeight = 15;\r\n\r\n\t\tlet posterRootElement = document.createElement(\"div\");\r\n\t\tposterRootElement.className = \"ac-media-poster\";\r\n\t\tposterRootElement.setAttribute(\"role\", \"contentinfo\");\r\n\t\tposterRootElement.setAttribute(\"aria-label\", this.altText ? this.altText : \"Media content\");\r\n\t\tposterRootElement.style.position = \"relative\";\r\n\t\tposterRootElement.style.display = \"flex\";\r\n\r\n\t\tlet posterUrl = this.getPosterUrl();\r\n\r\n\t\tif (posterUrl) {\r\n\t\t\tlet posterImageElement = document.createElement(\"img\");\r\n\t\t\tposterImageElement.style.width = \"100%\";\r\n\t\t\tposterImageElement.style.height = \"100%\";\r\n\r\n\t\t\tposterImageElement.onerror = (e: Event) => {\r\n\t\t\t\tposterImageElement.parentNode.removeChild(posterImageElement);\r\n\t\t\t\tposterRootElement.classList.add(\"empty\");\r\n\t\t\t\tposterRootElement.style.minHeight = \"150px\";\r\n\t\t\t}\r\n\r\n\t\t\tposterImageElement.src = posterUrl;\r\n\r\n\t\t\tposterRootElement.appendChild(posterImageElement);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tposterRootElement.classList.add(\"empty\");\r\n\t\t\tposterRootElement.style.minHeight = \"150px\";\r\n\t\t}\r\n\r\n\t\tif (this.hostConfig.supportsInteractivity && this._selectedSources.length > 0) {\r\n\t\t\tlet playButtonOuterElement = document.createElement(\"div\");\r\n\t\t\tplayButtonOuterElement.setAttribute(\"role\", \"button\");\r\n\t\t\tplayButtonOuterElement.setAttribute(\"aria-label\", \"Play media\");\r\n\t\t\tplayButtonOuterElement.className = \"ac-media-playButton\";\r\n\t\t\tplayButtonOuterElement.style.display = \"flex\";\r\n\t\t\tplayButtonOuterElement.style.alignItems = \"center\";\r\n\t\t\tplayButtonOuterElement.style.justifyContent = \"center\";\r\n\t\t\tplayButtonOuterElement.onclick = (e) => {\r\n\t\t\t\tif (this.hostConfig.media.allowInlinePlayback) {\r\n\t\t\t\t\tlet mediaPlayerElement = this.renderMediaPlayer();\r\n\r\n\t\t\t\t\tthis.renderedElement.innerHTML = \"\";\r\n\t\t\t\t\tthis.renderedElement.appendChild(mediaPlayerElement);\r\n\r\n\t\t\t\t\tmediaPlayerElement.play();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (Media.onPlay) {\r\n\t\t\t\t\t\tMedia.onPlay(this);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tlet playButtonInnerElement = document.createElement(\"div\");\r\n\t\t\tplayButtonInnerElement.className = \"ac-media-playButton-arrow\";\r\n\t\t\tplayButtonInnerElement.style.width = playButtonArrowWidth + \"px\";\r\n\t\t\tplayButtonInnerElement.style.height = playButtonArrowHeight + \"px\";\r\n\t\t\tplayButtonInnerElement.style.borderTopWidth = (playButtonArrowHeight / 2) + \"px\";\r\n\t\t\tplayButtonInnerElement.style.borderBottomWidth = (playButtonArrowHeight / 2) + \"px\";\r\n\t\t\tplayButtonInnerElement.style.borderLeftWidth = playButtonArrowWidth + \"px\";\r\n\t\t\tplayButtonInnerElement.style.borderRightWidth = \"0\";\r\n\t\t\tplayButtonInnerElement.style.borderStyle = \"solid\";\r\n\t\t\tplayButtonInnerElement.style.borderTopColor = \"transparent\";\r\n\t\t\tplayButtonInnerElement.style.borderRightColor = \"transparent\";\r\n\t\t\tplayButtonInnerElement.style.borderBottomColor = \"transparent\";\r\n\t\t\tplayButtonInnerElement.style.transform = \"translate(\" + (playButtonArrowWidth / 10) + \"px,0px)\";\r\n\r\n\t\t\tplayButtonOuterElement.appendChild(playButtonInnerElement);\r\n\r\n\t\t\tlet playButtonContainer = document.createElement(\"div\");\r\n\t\t\tplayButtonContainer.style.position = \"absolute\";\r\n\t\t\tplayButtonContainer.style.left = \"0\";\r\n\t\t\tplayButtonContainer.style.top = \"0\";\r\n\t\t\tplayButtonContainer.style.width = \"100%\";\r\n\t\t\tplayButtonContainer.style.height = \"100%\";\r\n\t\t\tplayButtonContainer.style.display = \"flex\";\r\n\t\t\tplayButtonContainer.style.justifyContent = \"center\";\r\n\t\t\tplayButtonContainer.style.alignItems = \"center\";\r\n\r\n\t\t\tplayButtonContainer.appendChild(playButtonOuterElement);\r\n\t\t\tposterRootElement.appendChild(playButtonContainer);\r\n\t\t}\r\n\r\n\t\treturn posterRootElement;\r\n\t}\r\n\r\n\tprivate renderMediaPlayer(): HTMLMediaElement {\r\n\t\tlet mediaElement: HTMLMediaElement;\r\n\r\n\t\tif (this._selectedMediaType == \"video\") {\r\n\t\t\tlet videoPlayer = document.createElement(\"video\");\r\n\r\n\t\t\tlet posterUrl = this.getPosterUrl();\r\n\r\n\t\t\tif (posterUrl) {\r\n\t\t\t\tvideoPlayer.poster = posterUrl;\r\n\t\t\t}\r\n\r\n\t\t\tmediaElement = videoPlayer;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tmediaElement = document.createElement(\"audio\");\r\n\t\t}\r\n\r\n\t\tmediaElement.controls = true;\r\n\t\tmediaElement.preload = \"none\";\r\n\t\tmediaElement.style.width = \"100%\";\r\n\r\n\t\tfor (let source of this.sources) {\r\n\t\t\tlet src: HTMLSourceElement = document.createElement(\"source\");\r\n\t\t\tsrc.src = source.url;\r\n\t\t\tsrc.type = source.mimeType;\r\n\r\n\t\t\tmediaElement.appendChild(src);\r\n\t\t}\r\n\r\n\t\treturn mediaElement;\r\n\t}\r\n\r\n\tprotected internalRender(): HTMLElement {\r\n\t\tlet element = <HTMLElement>document.createElement(\"div\");\r\n\t\telement.className = this.hostConfig.makeCssClassName(\"ac-media\");\r\n\r\n\t\tthis.processSources();\r\n\r\n\t\telement.appendChild(this.renderPoster());\r\n\r\n\t\treturn element;\r\n\t}\r\n\r\n\tstatic onPlay: (sender: Media) => void;\r\n\r\n\tsources: Array<MediaSource> = [];\r\n\tposter: string;\r\n\taltText: string;\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tsuper.parse(json, errors);\r\n\r\n\t\tthis.poster = json[\"poster\"];\r\n\t\tthis.altText = json[\"altText\"];\r\n\r\n\t\tif (json[\"sources\"] != null) {\r\n\t\t\tlet jsonSources = json[\"sources\"] as Array<any>;\r\n\r\n\t\t\tthis.sources = [];\r\n\r\n\t\t\tfor (let i = 0; i < jsonSources.length; i++) {\r\n\t\t\t\tlet source = new MediaSource();\r\n\t\t\t\tsource.parse(jsonSources[i], errors);\r\n\r\n\t\t\t\tthis.sources.push(source);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\tlet result = super.toJSON();\r\n\r\n\t\tUtils.setProperty(result, \"poster\", this.poster);\r\n\t\tUtils.setProperty(result, \"altText\", this.altText);\r\n\r\n\t\tif (this.sources.length > 0) {\r\n\t\t\tlet serializedSources = [];\r\n\r\n\t\t\tfor (let source of this.sources) {\r\n\t\t\t\tserializedSources.push(source.toJSON());\r\n\t\t\t}\r\n\r\n\t\t\tUtils.setProperty(result, \"sources\", serializedSources);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tgetJsonTypeName(): string {\r\n\t\treturn \"Media\";\r\n\t}\r\n\r\n\tgetResourceInformation(): Array<IResourceInformation> {\r\n\t\tlet result: Array<IResourceInformation> = [];\r\n\r\n\t\tlet posterUrl = this.getPosterUrl();\r\n\r\n\t\tif (!Utils.isNullOrEmpty(posterUrl)) {\r\n\t\t\tresult.push({ url: posterUrl, mimeType: \"image\" });\r\n\t\t}\r\n\r\n\t\tfor (let mediaSource of this.sources) {\r\n\t\t\tif (!Utils.isNullOrEmpty(mediaSource.url)) {\r\n\t\t\t\tresult.push({ url: mediaSource.url, mimeType: mediaSource.mimeType });\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\trenderSpeech(): string {\r\n\t\treturn this.altText;\r\n\t}\r\n\r\n\tget selectedMediaType(): string {\r\n\t\treturn this._selectedMediaType;\r\n\t}\r\n}\r\n\r\nexport abstract class Input extends CardElement implements Utils.IInput {\r\n\tprotected valueChanged() {\r\n\t\tif (this.onValueChanged) {\r\n\t\t\tthis.onValueChanged(this);\r\n\t\t}\r\n\t}\r\n\r\n\tabstract get value(): string;\r\n\r\n\tonValueChanged: (sender: Input) => void;\r\n\r\n\ttitle: string;\r\n\tdefaultValue: string;\r\n\r\n\ttoJSON() {\r\n\t\tlet result = super.toJSON();\r\n\r\n\t\tUtils.setProperty(result, \"title\", this.title);\r\n\t\tUtils.setProperty(result, \"value\", this.renderedElement ? this.value : this.defaultValue);\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tvalidate(): Array<HostConfig.IValidationError> {\r\n\t\tif (!this.id) {\r\n\t\t\treturn [{ error: Enums.ValidationError.PropertyCantBeNull, message: \"All inputs must have a unique Id\" }];\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tsuper.parse(json, errors);\r\n\r\n\t\tthis.id = json[\"id\"];\r\n\t\tthis.defaultValue = json[\"value\"];\r\n\t}\r\n\r\n\trenderSpeech(): string {\r\n\t\tif (this.speak != null) {\r\n\t\t\treturn this.speak;\r\n\t\t}\r\n\r\n\t\tif (this.title) {\r\n\t\t\treturn '<s>' + this.title + '</s>\\n';\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tgetAllInputs(): Array<Input> {\r\n\t\treturn [this];\r\n\t}\r\n\r\n\tget isInteractive(): boolean {\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nexport class TextInput extends Input {\r\n\tprivate _textareaElement: HTMLTextAreaElement;\r\n\tprivate _inputElement: HTMLInputElement;\r\n\r\n\tprotected internalRender(): HTMLElement {\r\n\t\tif (this.isMultiline) {\r\n\t\t\tthis._textareaElement = document.createElement(\"textarea\");\r\n\t\t\tthis._textareaElement.className = this.hostConfig.makeCssClassName(\"ac-input\", \"ac-textInput\", \"ac-multiline\");\r\n\t\t\tthis._textareaElement.style.width = \"100%\";\r\n\t\t\tthis._textareaElement.tabIndex = 0;\r\n\r\n\t\t\tif (!Utils.isNullOrEmpty(this.placeholder)) {\r\n\t\t\t\tthis._textareaElement.placeholder = this.placeholder;\r\n\t\t\t\tthis._textareaElement.setAttribute(\"aria-label\", this.placeholder)\r\n\t\t\t}\r\n\r\n\t\t\tif (!Utils.isNullOrEmpty(this.defaultValue)) {\r\n\t\t\t\tthis._textareaElement.value = this.defaultValue;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.maxLength > 0) {\r\n\t\t\t\tthis._textareaElement.maxLength = this.maxLength;\r\n\t\t\t}\r\n\r\n\t\t\tthis._textareaElement.oninput = () => { this.valueChanged(); }\r\n\r\n\t\t\treturn this._textareaElement;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis._inputElement = document.createElement(\"input\");\r\n\t\t\tthis._inputElement.type = Enums.InputTextStyle[this.style].toLowerCase();\r\n\t\t\tthis._inputElement.className = this.hostConfig.makeCssClassName(\"ac-input\", \"ac-textInput\");\r\n\t\t\tthis._inputElement.style.width = \"100%\";\r\n\t\t\tthis._inputElement.tabIndex = 0;\r\n\r\n\t\t\tif (!Utils.isNullOrEmpty(this.placeholder)) {\r\n\t\t\t\tthis._inputElement.placeholder = this.placeholder;\r\n\t\t\t\tthis._inputElement.setAttribute(\"aria-label\", this.placeholder)\r\n\t\t\t}\r\n\r\n\t\t\tif (!Utils.isNullOrEmpty(this.defaultValue)) {\r\n\t\t\t\tthis._inputElement.value = this.defaultValue;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.maxLength > 0) {\r\n\t\t\t\tthis._inputElement.maxLength = this.maxLength;\r\n\t\t\t}\r\n\r\n\t\t\tthis._inputElement.oninput = () => { this.valueChanged(); }\r\n\r\n\t\t\treturn this._inputElement;\r\n\t\t}\r\n\t}\r\n\r\n\tmaxLength: number;\r\n\tisMultiline: boolean;\r\n\tplaceholder: string;\r\n\tstyle: Enums.InputTextStyle = Enums.InputTextStyle.Text;\r\n\r\n\tgetJsonTypeName(): string {\r\n\t\treturn \"Input.Text\";\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\tlet result = super.toJSON();\r\n\r\n\t\tUtils.setProperty(result, \"placeholder\", this.placeholder);\r\n\t\tUtils.setProperty(result, \"maxLength\", this.maxLength, 0);\r\n\t\tUtils.setProperty(result, \"isMultiline\", this.isMultiline, false);\r\n\t\tUtils.setEnumProperty(Enums.InputTextStyle, result, \"style\", this.style, Enums.InputTextStyle.Text);\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tsuper.parse(json, errors);\r\n\r\n\t\tthis.maxLength = json[\"maxLength\"];\r\n\t\tthis.isMultiline = json[\"isMultiline\"];\r\n\t\tthis.placeholder = json[\"placeholder\"];\r\n\t\tthis.style = Utils.getEnumValueOrDefault(Enums.InputTextStyle, json[\"style\"], this.style);\r\n\t}\r\n\r\n\tget value(): string {\r\n\t\tif (this.isMultiline) {\r\n\t\t\treturn this._textareaElement ? this._textareaElement.value : null;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn this._inputElement ? this._inputElement.value : null;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class ToggleInput extends Input {\r\n\tprivate _checkboxInputElement: HTMLInputElement;\r\n\r\n\tprotected internalRender(): HTMLElement {\r\n\t\tlet element = document.createElement(\"div\");\r\n\t\telement.className = this.hostConfig.makeCssClassName(\"ac-input\");\r\n\t\telement.style.width = \"100%\";\r\n\t\telement.style.display = \"flex\";\r\n\t\telement.style.alignItems = \"center\";\r\n\r\n\t\tthis._checkboxInputElement = document.createElement(\"input\");\r\n\t\tthis._checkboxInputElement.id = generateUniqueId();\r\n\t\tthis._checkboxInputElement.type = \"checkbox\";\r\n\t\tthis._checkboxInputElement.style.display = \"inline-block\";\r\n\t\tthis._checkboxInputElement.style.verticalAlign = \"middle\";\r\n\t\tthis._checkboxInputElement.style.margin = \"0\";\r\n\t\tthis._checkboxInputElement.style.flex = \"0 0 auto\";\r\n\t\tthis._checkboxInputElement.setAttribute(\"aria-label\", this.title);\r\n\t\tthis._checkboxInputElement.tabIndex = 0;\r\n\r\n\t\tif (this.defaultValue == this.valueOn) {\r\n\t\t\tthis._checkboxInputElement.checked = true;\r\n\t\t}\r\n\r\n\t\tthis._checkboxInputElement.onchange = () => { this.valueChanged(); }\r\n\r\n\t\tUtils.appendChild(element, this._checkboxInputElement);\r\n\r\n\t\tif (!Utils.isNullOrEmpty(this.title) || this.isDesignMode()) {\r\n\t\t\tlet label = new Label();\r\n\t\t\tlabel.setParent(this);\r\n\t\t\tlabel.forElementId = this._checkboxInputElement.id;\r\n\t\t\tlabel.hostConfig = this.hostConfig;\r\n\t\t\tlabel.text = Utils.isNullOrEmpty(this.title) ? this.getJsonTypeName() : this.title;\r\n\t\t\tlabel.useMarkdown = AdaptiveCard.useMarkdownInRadioButtonAndCheckbox;\r\n\r\n\t\t\tlet labelElement = label.render();\r\n\t\t\tlabelElement.style.display = \"inline-block\";\r\n\t\t\tlabelElement.style.flex = \"1 1 auto\";\r\n\t\t\tlabelElement.style.verticalAlign = \"middle\";\r\n\r\n\t\t\tlet spacerElement = document.createElement(\"div\");\r\n\t\t\tspacerElement.style.width = \"6px\";\r\n\r\n\t\t\tUtils.appendChild(element, spacerElement);\r\n\t\t\tUtils.appendChild(element, labelElement);\r\n\t\t}\r\n\r\n\t\treturn element;\r\n\t}\r\n\r\n\tvalueOn: string = \"true\";\r\n\tvalueOff: string = \"false\";\r\n\r\n\tgetJsonTypeName(): string {\r\n\t\treturn \"Input.Toggle\";\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\tlet result = super.toJSON();\r\n\r\n\t\tUtils.setProperty(result, \"valueOn\", this.valueOn, \"true\");\r\n\t\tUtils.setProperty(result, \"valueOff\", this.valueOff, \"false\");\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tsuper.parse(json, errors);\r\n\r\n\t\tthis.title = json[\"title\"];\r\n\r\n\t\tthis.valueOn = Utils.getValueOrDefault<string>(json[\"valueOn\"], this.valueOn);\r\n\t\tthis.valueOff = Utils.getValueOrDefault<string>(json[\"valueOff\"], this.valueOff);\r\n\t}\r\n\r\n\tget value(): string {\r\n\t\tif (this._checkboxInputElement) {\r\n\t\t\treturn this._checkboxInputElement.checked ? this.valueOn : this.valueOff;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class Choice {\r\n\ttitle: string;\r\n\tvalue: string;\r\n\r\n\tconstructor(title: string = undefined, value: string = undefined) {\r\n\t\tthis.title = title;\r\n\t\tthis.value = value;\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\treturn { title: this.title, value: this.value };\r\n\t}\r\n}\r\n\r\nexport class ChoiceSetInput extends Input {\r\n\tprivate static uniqueCategoryCounter = 0;\r\n\r\n\tprivate static getUniqueCategoryName(): string {\r\n\t\tlet uniqueCwtegoryName = \"__ac-category\" + ChoiceSetInput.uniqueCategoryCounter;\r\n\r\n\t\tChoiceSetInput.uniqueCategoryCounter++;\r\n\r\n\t\treturn uniqueCwtegoryName;\r\n\t}\r\n\r\n\tprivate _selectElement: HTMLSelectElement;\r\n\tprivate _toggleInputs: Array<HTMLInputElement>;\r\n\r\n\tprotected internalRender(): HTMLElement {\r\n\t\tif (!this.isMultiSelect) {\r\n\t\t\tif (this.isCompact) {\r\n\t\t\t\t// Render as a combo box\r\n\t\t\t\tthis._selectElement = document.createElement(\"select\");\r\n\t\t\t\tthis._selectElement.className = this.hostConfig.makeCssClassName(\"ac-input\", \"ac-multichoiceInput\");\r\n\t\t\t\tthis._selectElement.style.width = \"100%\";\r\n\r\n\t\t\t\tlet option = document.createElement(\"option\");\r\n\t\t\t\toption.selected = true;\r\n\t\t\t\toption.disabled = true;\r\n\t\t\t\toption.hidden = true;\r\n\t\t\t\toption.value = \"\";\r\n\r\n\t\t\t\tif (this.placeholder) {\r\n\t\t\t\t\toption.text = this.placeholder;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tUtils.appendChild(this._selectElement, option);\r\n\r\n\t\t\t\tfor (var i = 0; i < this.choices.length; i++) {\r\n\t\t\t\t\tlet option = document.createElement(\"option\");\r\n\t\t\t\t\toption.value = this.choices[i].value;\r\n\t\t\t\t\toption.text = this.choices[i].title;\r\n\t\t\t\t\toption.setAttribute(\"aria-label\", this.choices[i].title);\r\n\r\n\t\t\t\t\tif (this.choices[i].value == this.defaultValue) {\r\n\t\t\t\t\t\toption.selected = true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tUtils.appendChild(this._selectElement, option);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._selectElement.onchange = () => { this.valueChanged(); }\r\n\r\n\t\t\t\treturn this._selectElement;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t// Render as a series of radio buttons\r\n\t\t\t\tlet uniqueCategoryName = ChoiceSetInput.getUniqueCategoryName();\r\n\r\n\t\t\t\tlet element = document.createElement(\"div\");\r\n\t\t\t\telement.className = this.hostConfig.makeCssClassName(\"ac-input\");\r\n\t\t\t\telement.style.width = \"100%\";\r\n\r\n\t\t\t\tthis._toggleInputs = [];\r\n\r\n\t\t\t\tfor (let i = 0; i < this.choices.length; i++) {\r\n\t\t\t\t\tlet radioInput = document.createElement(\"input\");\r\n\t\t\t\t\tradioInput.id = generateUniqueId();\r\n\t\t\t\t\tradioInput.type = \"radio\";\r\n\t\t\t\t\tradioInput.style.margin = \"0\";\r\n\t\t\t\t\tradioInput.style.display = \"inline-block\";\r\n\t\t\t\t\tradioInput.style.verticalAlign = \"middle\";\r\n\t\t\t\t\tradioInput.name = Utils.isNullOrEmpty(this.id) ? uniqueCategoryName : this.id;\r\n\t\t\t\t\tradioInput.value = this.choices[i].value;\r\n\t\t\t\t\tradioInput.style.flex = \"0 0 auto\";\r\n\t\t\t\t\tradioInput.setAttribute(\"aria-label\", this.choices[i].title);\r\n\r\n\t\t\t\t\tif (this.choices[i].value == this.defaultValue) {\r\n\t\t\t\t\t\tradioInput.checked = true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tradioInput.onchange = () => { this.valueChanged(); }\r\n\r\n\t\t\t\t\tthis._toggleInputs.push(radioInput);\r\n\r\n\t\t\t\t\tlet label = new Label();\r\n\t\t\t\t\tlabel.setParent(this);\r\n\t\t\t\t\tlabel.forElementId = radioInput.id;\r\n\t\t\t\t\tlabel.hostConfig = this.hostConfig;\r\n\t\t\t\t\tlabel.text = Utils.isNullOrEmpty(this.choices[i].title) ? \"Choice \" + i : this.choices[i].title;\r\n\t\t\t\t\tlabel.useMarkdown = AdaptiveCard.useMarkdownInRadioButtonAndCheckbox;\r\n\r\n\t\t\t\t\tlet labelElement = label.render();\r\n\t\t\t\t\tlabelElement.style.display = \"inline-block\";\r\n\t\t\t\t\tlabelElement.style.flex = \"1 1 auto\";\r\n\t\t\t\t\tlabelElement.style.marginLeft = \"6px\";\r\n\t\t\t\t\tlabelElement.style.verticalAlign = \"middle\";\r\n\r\n\t\t\t\t\tlet spacerElement = document.createElement(\"div\");\r\n\t\t\t\t\tspacerElement.style.width = \"6px\";\r\n\r\n\t\t\t\t\tlet compoundInput = document.createElement(\"div\");\r\n\t\t\t\t\tcompoundInput.style.display = \"flex\";\r\n\r\n\t\t\t\t\tUtils.appendChild(compoundInput, radioInput);\r\n\t\t\t\t\tUtils.appendChild(compoundInput, spacerElement);\r\n\t\t\t\t\tUtils.appendChild(compoundInput, labelElement);\r\n\r\n\t\t\t\t\tUtils.appendChild(element, compoundInput);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn element;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// Render as a list of toggle inputs\r\n\t\t\tlet defaultValues = this.defaultValue ? this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator) : null;\r\n\r\n\t\t\tlet element = document.createElement(\"div\");\r\n\t\t\telement.className = this.hostConfig.makeCssClassName(\"ac-input\");\r\n\t\t\telement.style.width = \"100%\";\r\n\r\n\t\t\tthis._toggleInputs = [];\r\n\r\n\t\t\tfor (let i = 0; i < this.choices.length; i++) {\r\n\t\t\t\tlet checkboxInput = document.createElement(\"input\");\r\n\t\t\t\tcheckboxInput.id = generateUniqueId();\r\n\t\t\t\tcheckboxInput.type = \"checkbox\";\r\n\t\t\t\tcheckboxInput.style.margin = \"0\";\r\n\t\t\t\tcheckboxInput.style.display = \"inline-block\";\r\n\t\t\t\tcheckboxInput.style.verticalAlign = \"middle\";\r\n\t\t\t\tcheckboxInput.value = this.choices[i].value;\r\n\t\t\t\tcheckboxInput.style.flex = \"0 0 auto\";\r\n\t\t\t\tcheckboxInput.setAttribute(\"aria-label\", this.choices[i].title);\r\n\r\n\t\t\t\tif (defaultValues) {\r\n\t\t\t\t\tif (defaultValues.indexOf(this.choices[i].value) >= 0) {\r\n\t\t\t\t\t\tcheckboxInput.checked = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcheckboxInput.onchange = () => { this.valueChanged(); }\r\n\r\n\t\t\t\tthis._toggleInputs.push(checkboxInput);\r\n\r\n\t\t\t\tlet label = new Label();\r\n\t\t\t\tlabel.setParent(this);\r\n\t\t\t\tlabel.forElementId = checkboxInput.id;\r\n\t\t\t\tlabel.hostConfig = this.hostConfig;\r\n\t\t\t\tlabel.text = Utils.isNullOrEmpty(this.choices[i].title) ? \"Choice \" + i : this.choices[i].title;\r\n\t\t\t\tlabel.useMarkdown = AdaptiveCard.useMarkdownInRadioButtonAndCheckbox;\r\n\r\n\t\t\t\tlet labelElement = label.render();\r\n\t\t\t\tlabelElement.style.display = \"inline-block\";\r\n\t\t\t\tlabelElement.style.flex = \"1 1 auto\";\r\n\t\t\t\t// labelElement.style.marginLeft = \"6px\";\r\n\t\t\t\tlabelElement.style.verticalAlign = \"middle\";\r\n\r\n\t\t\t\tlet spacerElement = document.createElement(\"div\");\r\n\t\t\t\tspacerElement.style.width = \"6px\";\r\n\r\n\t\t\t\tlet compoundInput = document.createElement(\"div\");\r\n\t\t\t\tcompoundInput.style.display = \"flex\";\r\n\t\t\t\tcompoundInput.style.alignItems = \"center\";\r\n\r\n\t\t\t\tUtils.appendChild(compoundInput, checkboxInput);\r\n\t\t\t\tUtils.appendChild(compoundInput, spacerElement);\r\n\t\t\t\tUtils.appendChild(compoundInput, labelElement);\r\n\r\n\t\t\t\tUtils.appendChild(element, compoundInput);\r\n\t\t\t}\r\n\r\n\t\t\treturn element;\r\n\t\t}\r\n\t}\r\n\r\n\tchoices: Array<Choice> = [];\r\n\tisCompact: boolean;\r\n\tisMultiSelect: boolean;\r\n\tplaceholder: string;\r\n\r\n\tgetJsonTypeName(): string {\r\n\t\treturn \"Input.ChoiceSet\";\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\tlet result = super.toJSON();\r\n\r\n\t\tUtils.setProperty(result, \"placeholder\", this.placeholder);\r\n\r\n\t\tif (this.choices.length > 0) {\r\n\t\t\tvar choices = [];\r\n\r\n\t\t\tfor (let choice of this.choices) {\r\n\t\t\t\tchoices.push(choice.toJSON());\r\n\t\t\t}\r\n\r\n\t\t\tUtils.setProperty(result, \"choices\", choices);\r\n\t\t}\r\n\r\n\t\tif (!this.isCompact) {\r\n\t\t\tUtils.setProperty(result, \"style\", \"expanded\", false);\r\n\t\t}\r\n\r\n\t\tUtils.setProperty(result, \"isMultiSelect\", this.isMultiSelect, false);\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tvalidate(): Array<HostConfig.IValidationError> {\r\n\t\tvar result: Array<HostConfig.IValidationError> = [];\r\n\r\n\t\tif (this.choices.length == 0) {\r\n\t\t\tresult = [{ error: Enums.ValidationError.CollectionCantBeEmpty, message: \"An Input.ChoiceSet must have at least one choice defined.\" }];\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < this.choices.length; i++) {\r\n\t\t\tif (!this.choices[i].title || !this.choices[i].value) {\r\n\t\t\t\tresult = result.concat([{ error: Enums.ValidationError.PropertyCantBeNull, message: \"All choices in an Input.ChoiceSet must have their title and value properties set.\" }])\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tsuper.parse(json, errors);\r\n\r\n\t\tthis.isCompact = !(json[\"style\"] === \"expanded\");\r\n\t\tthis.isMultiSelect = json[\"isMultiSelect\"];\r\n\t\tthis.placeholder = json[\"placeholder\"];\r\n\r\n\t\tthis.choices = [];\r\n\r\n\t\tif (json[\"choices\"] != undefined) {\r\n\t\t\tvar choiceArray = json[\"choices\"] as Array<any>;\r\n\r\n\t\t\tfor (var i = 0; i < choiceArray.length; i++) {\r\n\t\t\t\tvar choice = new Choice();\r\n\r\n\t\t\t\tchoice.title = choiceArray[i][\"title\"];\r\n\t\t\t\tchoice.value = choiceArray[i][\"value\"];\r\n\r\n\t\t\t\tthis.choices.push(choice);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tget value(): string {\r\n\t\tif (!this.isMultiSelect) {\r\n\t\t\tif (this.isCompact) {\r\n\t\t\t\treturn this._selectElement ? this._selectElement.value : null;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (!this._toggleInputs || this._toggleInputs.length == 0) {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (var i = 0; i < this._toggleInputs.length; i++) {\r\n\t\t\t\t\tif (this._toggleInputs[i].checked) {\r\n\t\t\t\t\t\treturn this._toggleInputs[i].value;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (!this._toggleInputs || this._toggleInputs.length == 0) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tvar result: string = \"\";\r\n\r\n\t\t\tfor (var i = 0; i < this._toggleInputs.length; i++) {\r\n\t\t\t\tif (this._toggleInputs[i].checked) {\r\n\t\t\t\t\tif (result != \"\") {\r\n\t\t\t\t\t\tresult += this.hostConfig.choiceSetInputValueSeparator;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tresult += this._toggleInputs[i].value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn result == \"\" ? null : result;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class NumberInput extends Input {\r\n\tprivate _numberInputElement: HTMLInputElement;\r\n\r\n\tprotected internalRender(): HTMLElement {\r\n\t\tthis._numberInputElement = document.createElement(\"input\");\r\n\t\tthis._numberInputElement.setAttribute(\"type\", \"number\");\r\n\t\tthis._numberInputElement.className = this.hostConfig.makeCssClassName(\"ac-input\", \"ac-numberInput\");\r\n\t\tthis._numberInputElement.setAttribute(\"min\", this.min);\r\n\t\tthis._numberInputElement.setAttribute(\"max\", this.max);\r\n\t\tthis._numberInputElement.style.width = \"100%\";\r\n\t\tthis._numberInputElement.tabIndex = 0;\r\n\r\n\t\tif (!Utils.isNullOrEmpty(this.defaultValue)) {\r\n\t\t\tthis._numberInputElement.value = this.defaultValue;\r\n\t\t}\r\n\r\n\t\tif (!Utils.isNullOrEmpty(this.placeholder)) {\r\n\t\t\tthis._numberInputElement.placeholder = this.placeholder;\r\n\t\t\tthis._numberInputElement.setAttribute(\"aria-label\", this.placeholder);\r\n\t\t}\r\n\r\n\t\tthis._numberInputElement.oninput = () => { this.valueChanged(); }\r\n\r\n\t\treturn this._numberInputElement;\r\n\t}\r\n\r\n\tmin: string;\r\n\tmax: string;\r\n\tplaceholder: string;\r\n\r\n\tgetJsonTypeName(): string {\r\n\t\treturn \"Input.Number\";\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\tlet result = super.toJSON();\r\n\r\n\t\tUtils.setProperty(result, \"placeholder\", this.placeholder);\r\n\t\tUtils.setProperty(result, \"min\", this.min);\r\n\t\tUtils.setProperty(result, \"max\", this.max);\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tsuper.parse(json, errors);\r\n\r\n\t\tthis.placeholder = json[\"placeholder\"];\r\n\t\tthis.min = json[\"min\"];\r\n\t\tthis.max = json[\"max\"];\r\n\t}\r\n\r\n\tget value(): string {\r\n\t\treturn this._numberInputElement ? this._numberInputElement.value : null;\r\n\t}\r\n}\r\n\r\nexport class DateInput extends Input {\r\n\tprivate _dateInputElement: HTMLInputElement;\r\n\r\n\tprotected internalRender(): HTMLElement {\r\n\t\tthis._dateInputElement = document.createElement(\"input\");\r\n\t\tthis._dateInputElement.setAttribute(\"type\", \"date\");\r\n\t\tthis._dateInputElement.className = this.hostConfig.makeCssClassName(\"ac-input\", \"ac-dateInput\");\r\n\t\tthis._dateInputElement.style.width = \"100%\";\r\n\r\n\t\tif (!Utils.isNullOrEmpty(this.defaultValue)) {\r\n\t\t\tthis._dateInputElement.value = this.defaultValue;\r\n\t\t}\r\n\r\n\t\treturn this._dateInputElement;\r\n\t}\r\n\r\n\tgetJsonTypeName(): string {\r\n\t\treturn \"Input.Date\";\r\n\t}\r\n\r\n\tget value(): string {\r\n\t\treturn this._dateInputElement ? this._dateInputElement.value : null;\r\n\t}\r\n}\r\n\r\nexport class TimeInput extends Input {\r\n\tprivate _timeInputElement: HTMLInputElement;\r\n\r\n\tprotected internalRender(): HTMLElement {\r\n\t\tthis._timeInputElement = document.createElement(\"input\");\r\n\t\tthis._timeInputElement.setAttribute(\"type\", \"time\");\r\n\t\tthis._timeInputElement.className = this.hostConfig.makeCssClassName(\"ac-input\", \"ac-timeInput\");\r\n\t\tthis._timeInputElement.style.width = \"100%\";\r\n\r\n\t\tif (!Utils.isNullOrEmpty(this.defaultValue)) {\r\n\t\t\tthis._timeInputElement.value = this.defaultValue;\r\n\t\t}\r\n\r\n\t\treturn this._timeInputElement;\r\n\t}\r\n\r\n\tgetJsonTypeName(): string {\r\n\t\treturn \"Input.Time\";\r\n\t}\r\n\r\n\tget value(): string {\r\n\t\treturn this._timeInputElement ? this._timeInputElement.value : null;\r\n\t}\r\n}\r\n\r\nenum ActionButtonState {\r\n\tNormal,\r\n\tExpanded,\r\n\tSubdued\r\n}\r\n\r\nclass ActionButton {\r\n\tprivate _parentContainerStyle: string;\r\n\tprivate _action: Action;\r\n\tprivate _element: HTMLButtonElement = null;\r\n\tprivate _state: ActionButtonState = ActionButtonState.Normal;\r\n\r\n\tprivate updateCssStyle() {\r\n\t\tlet hostConfig = this.action.parent.hostConfig;\r\n\r\n\t\tthis.action.renderedElement.className = hostConfig.makeCssClassName(\"ac-pushButton\");\r\n\t\tthis.action.renderedElement.classList.add(\"style-\" + this._parentContainerStyle);\r\n\r\n\t\tif (this.action instanceof ShowCardAction) {\r\n\t\t\tthis.action.renderedElement.classList.add(hostConfig.makeCssClassName(\"expandable\"));\r\n\t\t}\r\n\r\n\t\tthis.action.renderedElement.classList.remove(hostConfig.makeCssClassName(\"expanded\"));\r\n\t\tthis.action.renderedElement.classList.remove(hostConfig.makeCssClassName(\"subdued\"));\r\n\r\n\t\tswitch (this._state) {\r\n\t\t\tcase ActionButtonState.Expanded:\r\n\t\t\t\tthis.action.renderedElement.classList.add(hostConfig.makeCssClassName(\"expanded\"));\r\n\t\t\t\tbreak;\r\n\t\t\tcase ActionButtonState.Subdued:\r\n\t\t\t\tthis.action.renderedElement.classList.add(hostConfig.makeCssClassName(\"subdued\"));\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tif (this.action.isPrimary) {\r\n\t\t\tthis.action.renderedElement.classList.add(hostConfig.makeCssClassName(\"primary\"));\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treadonly action: Action;\r\n\r\n\tconstructor(action: Action, parentContainerStyle: string) {\r\n\t\tthis.action = action;\r\n\t\tthis._parentContainerStyle = parentContainerStyle;\r\n\t}\r\n\r\n\tonClick: (actionButton: ActionButton) => void = null;\r\n\r\n\trender(alignment: Enums.ActionAlignment) {\r\n\t\tthis.action.render();\r\n\t\tthis.action.renderedElement.style.flex = alignment === Enums.ActionAlignment.Stretch ? \"0 1 100%\" : \"0 1 auto\";\r\n\t\tthis.action.renderedElement.onclick = (e) => { this.click(); };\r\n\r\n\t\tthis.updateCssStyle();\r\n\t}\r\n\r\n\tclick() {\r\n\t\tif (this.onClick != null) {\r\n\t\t\tthis.onClick(this);\r\n\t\t}\r\n\t}\r\n\r\n\tget state(): ActionButtonState {\r\n\t\treturn this._state;\r\n\t}\r\n\r\n\tset state(value: ActionButtonState) {\r\n\t\tthis._state = value;\r\n\r\n\t\tthis.updateCssStyle();\r\n\t}\r\n}\r\n\r\nexport abstract class Action implements ICardObject {\r\n\tprivate _shouldFallback: boolean = false;\r\n\tprivate _parent: CardElement = null;\r\n\tprivate _actionCollection: ActionCollection = null; // hold the reference to its action collection\r\n\tprivate _renderedElement: HTMLElement = null;\r\n\r\n\tprivate setCollection(actionCollection: ActionCollection) {\r\n\t\tthis._actionCollection = actionCollection;\r\n\t}\r\n\r\n\tprotected addCssClasses(element: HTMLElement) {\r\n\t\t// Do nothing in base implementation\r\n\t}\r\n\r\n\tabstract getJsonTypeName(): string;\r\n\r\n\treadonly requires = new HostConfig.HostCapabilities();\r\n\r\n\tid: string;\r\n\ttitle: string;\r\n\ticonUrl: string;\r\n\tisPrimary: boolean;\r\n\r\n\tonExecute: (sender: Action) => void;\r\n\r\n\ttoJSON() {\r\n\t\tlet result = {};\r\n\r\n\t\tUtils.setProperty(result, \"type\", this.getJsonTypeName());\r\n\t\tUtils.setProperty(result, \"id\", this.id);\r\n\t\tUtils.setProperty(result, \"title\", this.title);\r\n\t\tUtils.setProperty(result, \"iconUrl\", this.iconUrl);\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\trender() {\r\n\t\t// Cache hostConfig for perf\r\n\t\tlet hostConfig = this.parent.hostConfig;\r\n\r\n\t\tvar buttonElement = document.createElement(\"button\");\r\n\t\tbuttonElement.className = hostConfig.makeCssClassName(\"ac-pushButton\");\r\n\r\n\t\tthis.addCssClasses(buttonElement);\r\n\r\n\t\tbuttonElement.setAttribute(\"aria-label\", this.title);\r\n\t\tbuttonElement.type = \"button\";\r\n\t\tbuttonElement.style.display = \"flex\";\r\n\t\tbuttonElement.style.alignItems = \"center\";\r\n\t\tbuttonElement.style.justifyContent = \"center\";\r\n\r\n\t\tlet hasTitle = !Utils.isNullOrEmpty(this.title);\r\n\r\n\t\tlet titleElement = document.createElement(\"div\");\r\n\t\ttitleElement.style.overflow = \"hidden\";\r\n\t\ttitleElement.style.textOverflow = \"ellipsis\";\r\n\r\n\t\tif (!(hostConfig.actions.iconPlacement == Enums.ActionIconPlacement.AboveTitle || hostConfig.actions.allowTitleToWrap)) {\r\n\t\t\ttitleElement.style.whiteSpace = \"nowrap\";\r\n\t\t}\r\n\r\n\t\tif (hasTitle) {\r\n\t\t\ttitleElement.innerText = this.title;\r\n\t\t}\r\n\r\n\t\tif (Utils.isNullOrEmpty(this.iconUrl)) {\r\n\t\t\tbuttonElement.classList.add(\"noIcon\");\r\n\r\n\t\t\tbuttonElement.appendChild(titleElement);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet iconElement = document.createElement(\"img\");\r\n\t\t\ticonElement.src = this.iconUrl;\r\n\t\t\ticonElement.style.width = hostConfig.actions.iconSize + \"px\";\r\n\t\t\ticonElement.style.height = hostConfig.actions.iconSize + \"px\";\r\n\t\t\ticonElement.style.flex = \"0 0 auto\";\r\n\r\n\t\t\tif (hostConfig.actions.iconPlacement == Enums.ActionIconPlacement.AboveTitle) {\r\n\t\t\t\tbuttonElement.classList.add(\"iconAbove\");\r\n\t\t\t\tbuttonElement.style.flexDirection = \"column\";\r\n\r\n\t\t\t\tif (hasTitle) {\r\n\t\t\t\t\ticonElement.style.marginBottom = \"4px\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tbuttonElement.classList.add(\"iconLeft\");\r\n\r\n\t\t\t\tif (hasTitle) {\r\n\t\t\t\t\ticonElement.style.marginRight = \"4px\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tbuttonElement.appendChild(iconElement);\r\n\t\t\tbuttonElement.appendChild(titleElement);\r\n\t\t}\r\n\r\n\t\tthis._renderedElement = buttonElement;\r\n\t}\r\n\r\n\tsetParent(value: CardElement) {\r\n\t\tthis._parent = value;\r\n\t}\r\n\r\n\texecute() {\r\n\t\tif (this.onExecute) {\r\n\t\t\tthis.onExecute(this);\r\n\t\t}\r\n\r\n\t\traiseExecuteActionEvent(this);\r\n\t}\r\n\r\n\t// Expand the action card pane with a inline status card\r\n\t// Null status will clear the status bar\r\n\tsetStatus(status: any) {\r\n\t\tif (this._actionCollection == null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (status) {\r\n\t\t\tlet statusCard = new InlineAdaptiveCard();\r\n\t\t\tstatusCard.parse(status);\r\n\t\t\tthis._actionCollection.showStatusCard(statusCard);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis._actionCollection.hideStatusCard();\r\n\t\t}\r\n\t}\r\n\r\n\tvalidate(): Array<HostConfig.IValidationError> {\r\n\t\treturn [];\r\n\t}\r\n\r\n\tprepare(inputs: Array<Input>) {\r\n\t\t// Do nothing in base implementation\r\n\t};\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\traiseParseActionEvent(this, json, errors);\r\n\r\n\t\tthis.requires.parse(json[\"requires\"], errors);\r\n\t\tthis.id = json[\"id\"];\r\n\r\n\t\tif (!json[\"title\"] && json[\"title\"] !== \"\") {\r\n\t\t\traiseParseError(\r\n\t\t\t\t{\r\n\t\t\t\t\terror: Enums.ValidationError.PropertyCantBeNull,\r\n\t\t\t\t\tmessage: \"Actions should always have a title.\"\r\n\t\t\t\t},\r\n\t\t\t\terrors\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tthis.title = json[\"title\"];\r\n\t\tthis.iconUrl = json[\"iconUrl\"];\r\n\t}\r\n\r\n\tremove(): boolean {\r\n\t\tif (this._actionCollection) {\r\n\t\t\treturn this._actionCollection.removeAction(this);\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tgetAllInputs(): Array<Input> {\r\n\t\treturn [];\r\n\t}\r\n\r\n\tgetResourceInformation(): Array<IResourceInformation> {\r\n\t\tif (!Utils.isNullOrEmpty(this.iconUrl)) {\r\n\t\t\treturn [{ url: this.iconUrl, mimeType: \"image\" }]\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\r\n\tgetActionById(id: string): Action {\r\n\t\tif (this.id == id) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t}\r\n\r\n\tget parent(): CardElement {\r\n\t\treturn this._parent;\r\n\t}\r\n\r\n\tget renderedElement(): HTMLElement {\r\n\t\treturn this._renderedElement;\r\n\t}\r\n\r\n\tshouldFallback(): boolean {\r\n\t\treturn this._shouldFallback || !this.requires.areAllMet(this.parent.hostConfig.hostCapabilities);\r\n\t}\r\n}\r\n\r\nexport class SubmitAction extends Action {\r\n\tprivate _isPrepared: boolean = false;\r\n\tprivate _originalData: Object;\r\n\tprivate _processedData: Object;\r\n\r\n\tgetJsonTypeName(): string {\r\n\t\treturn \"Action.Submit\";\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\tlet result = super.toJSON();\r\n\r\n\t\tUtils.setProperty(result, \"data\", this._originalData);\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprepare(inputs: Array<Input>) {\r\n\t\tif (this._originalData) {\r\n\t\t\tthis._processedData = JSON.parse(JSON.stringify(this._originalData));\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis._processedData = {};\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < inputs.length; i++) {\r\n\t\t\tvar inputValue = inputs[i].value;\r\n\r\n\t\t\tif (inputValue != null) {\r\n\t\t\t\tthis._processedData[inputs[i].id] = inputs[i].value;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._isPrepared = true;\r\n\t}\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tsuper.parse(json, errors);\r\n\r\n\t\tthis.data = json[\"data\"];\r\n\t}\r\n\r\n\tget data(): Object {\r\n\t\treturn this._isPrepared ? this._processedData : this._originalData;\r\n\t}\r\n\r\n\tset data(value: Object) {\r\n\t\tthis._originalData = value;\r\n\t\tthis._isPrepared = false;\r\n\t}\r\n}\r\n\r\nexport class OpenUrlAction extends Action {\r\n\turl: string;\r\n\r\n\tgetJsonTypeName(): string {\r\n\t\treturn \"Action.OpenUrl\";\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\tlet result = super.toJSON();\r\n\r\n\t\tUtils.setProperty(result, \"url\", this.url);\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tvalidate(): Array<HostConfig.IValidationError> {\r\n\t\tif (!this.url) {\r\n\t\t\treturn [{ error: Enums.ValidationError.PropertyCantBeNull, message: \"An Action.OpenUrl must have its url property set.\" }];\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tsuper.parse(json, errors);\r\n\r\n\t\tthis.url = json[\"url\"];\r\n\t}\r\n}\r\n\r\nexport class HttpHeader {\r\n\tprivate _value = new Utils.StringWithSubstitutions();\r\n\r\n\tname: string;\r\n\r\n\tconstructor(name: string = \"\", value: string = \"\") {\r\n\t\tthis.name = name;\r\n\t\tthis.value = value;\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\treturn { name: this.name, value: this._value.getOriginal() };\r\n\t}\r\n\r\n\tprepare(inputs: Array<Input>) {\r\n\t\tthis._value.substituteInputValues(inputs, Utils.ContentTypes.applicationXWwwFormUrlencoded);\r\n\t}\r\n\r\n\tget value(): string {\r\n\t\treturn this._value.get();\r\n\t}\r\n\r\n\tset value(newValue: string) {\r\n\t\tthis._value.set(newValue);\r\n\t}\r\n}\r\n\r\nexport class HttpAction extends Action {\r\n\tprivate _url = new Utils.StringWithSubstitutions();\r\n\tprivate _body = new Utils.StringWithSubstitutions();\r\n\tprivate _headers: Array<HttpHeader> = [];\r\n\r\n\tmethod: string;\r\n\r\n\tgetJsonTypeName(): string {\r\n\t\treturn \"Action.Http\";\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\tlet result = super.toJSON();\r\n\r\n\t\tUtils.setProperty(result, \"method\", this.method);\r\n\t\tUtils.setProperty(result, \"url\", this._url.getOriginal());\r\n\t\tUtils.setProperty(result, \"body\", this._body.getOriginal());\r\n\r\n\t\tif (this._headers.length > 0) {\r\n\t\t\tlet headers = [];\r\n\r\n\t\t\tfor (let header of this._headers) {\r\n\t\t\t\theaders.push(header.toJSON());\r\n\t\t\t}\r\n\r\n\t\t\tUtils.setProperty(result, \"headers\", headers);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tvalidate(): Array<HostConfig.IValidationError> {\r\n\t\tvar result: Array<HostConfig.IValidationError> = [];\r\n\r\n\t\tif (!this.url) {\r\n\t\t\tresult = [{ error: Enums.ValidationError.PropertyCantBeNull, message: \"An Action.Http must have its url property set.\" }];\r\n\t\t}\r\n\r\n\t\tif (this.headers.length > 0) {\r\n\t\t\tfor (var i = 0; i < this.headers.length; i++) {\r\n\t\t\t\tif (!this.headers[i].name || !this.headers[i].value) {\r\n\t\t\t\t\tresult = result.concat([{ error: Enums.ValidationError.PropertyCantBeNull, message: \"All headers of an Action.Http must have their name and value properties set.\" }]);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprepare(inputs: Array<Input>) {\r\n\t\tthis._url.substituteInputValues(inputs, Utils.ContentTypes.applicationXWwwFormUrlencoded);\r\n\r\n\t\tlet contentType = Utils.ContentTypes.applicationJson;\r\n\r\n\t\tfor (var i = 0; i < this._headers.length; i++) {\r\n\t\t\tthis._headers[i].prepare(inputs);\r\n\r\n\t\t\tif (this._headers[i].name && this._headers[i].name.toLowerCase() == \"content-type\") {\r\n\t\t\t\tcontentType = this._headers[i].value;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._body.substituteInputValues(inputs, contentType);\r\n\t};\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tsuper.parse(json, errors);\r\n\r\n\t\tthis.url = json[\"url\"];\r\n\t\tthis.method = json[\"method\"];\r\n\t\tthis.body = json[\"body\"];\r\n\r\n\t\tthis._headers = [];\r\n\r\n\t\tif (json[\"headers\"] != null) {\r\n\t\t\tvar jsonHeaders = json[\"headers\"] as Array<any>;\r\n\r\n\t\t\tfor (var i = 0; i < jsonHeaders.length; i++) {\r\n\t\t\t\tlet httpHeader = new HttpHeader();\r\n\r\n\t\t\t\thttpHeader.name = jsonHeaders[i][\"name\"];\r\n\t\t\t\thttpHeader.value = jsonHeaders[i][\"value\"];\r\n\r\n\t\t\t\tthis.headers.push(httpHeader);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tget url(): string {\r\n\t\treturn this._url.get();\r\n\t}\r\n\r\n\tset url(value: string) {\r\n\t\tthis._url.set(value);\r\n\t}\r\n\r\n\tget body(): string {\r\n\t\treturn this._body.get();\r\n\t}\r\n\r\n\tset body(value: string) {\r\n\t\tthis._body.set(value);\r\n\t}\r\n\r\n\tget headers(): Array<HttpHeader> {\r\n\t\treturn this._headers ? this._headers : [];\r\n\t}\r\n\r\n\tset headers(value: Array<HttpHeader>) {\r\n\t\tthis._headers = value;\r\n\t}\r\n}\r\n\r\nexport class ShowCardAction extends Action {\r\n\tprotected addCssClasses(element: HTMLElement) {\r\n\t\tsuper.addCssClasses(element);\r\n\r\n\t\telement.classList.add(this.parent.hostConfig.makeCssClassName(\"expandable\"));\r\n\t}\r\n\r\n\treadonly card: AdaptiveCard = new InlineAdaptiveCard();\r\n\r\n\tgetJsonTypeName(): string {\r\n\t\treturn \"Action.ShowCard\";\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\tlet result = super.toJSON();\r\n\r\n\t\tif (this.card) {\r\n\t\t\tUtils.setProperty(result, \"card\", this.card.toJSON());\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tvalidate(): Array<HostConfig.IValidationError> {\r\n\t\treturn this.card.validate();\r\n\t}\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tsuper.parse(json, errors);\r\n\r\n\t\tthis.card.parse(json[\"card\"], errors);\r\n\t}\r\n\r\n\tsetParent(value: CardElement) {\r\n\t\tsuper.setParent(value);\r\n\r\n\t\tthis.card.setParent(value);\r\n\t}\r\n\r\n\tgetAllInputs(): Array<Input> {\r\n\t\treturn this.card.getAllInputs();\r\n\t}\r\n\r\n\tgetResourceInformation(): Array<IResourceInformation> {\r\n\t\treturn super.getResourceInformation().concat(this.card.getResourceInformation());\r\n\t}\r\n\r\n\tgetActionById(id: string): Action {\r\n\t\tvar result = super.getActionById(id);\r\n\r\n\t\tif (!result) {\r\n\t\t\tresult = this.card.getActionById(id);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n}\r\n\r\nclass ActionCollection {\r\n\tprivate _owner: CardElement;\r\n\tprivate _actionCardContainer: HTMLDivElement;\r\n\tprivate _expandedAction: ShowCardAction = null;\r\n\tprivate _renderedActionCount: number = 0;\r\n\tprivate _statusCard: HTMLElement = null;\r\n\tprivate _actionCard: HTMLElement = null;\r\n\r\n\tprivate refreshContainer() {\r\n\t\tthis._actionCardContainer.innerHTML = \"\";\r\n\r\n\t\tif (this._actionCard === null && this._statusCard === null) {\r\n\t\t\tthis._actionCardContainer.style.padding = \"0px\";\r\n\t\t\tthis._actionCardContainer.style.marginTop = \"0px\";\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._actionCardContainer.style.marginTop = this._renderedActionCount > 0 ? this._owner.hostConfig.actions.showCard.inlineTopMargin + \"px\" : \"0px\";\r\n\r\n\t\tvar padding = this._owner.getNonZeroPadding().toSpacingDefinition(this._owner.hostConfig);\r\n\r\n\t\tif (this._actionCard !== null) {\r\n\t\t\tthis._actionCard.style.paddingLeft = padding.left + \"px\";\r\n\t\t\tthis._actionCard.style.paddingRight = padding.right + \"px\";\r\n\r\n\t\t\tthis._actionCard.style.marginLeft = \"-\" + padding.left + \"px\";\r\n\t\t\tthis._actionCard.style.marginRight = \"-\" + padding.right + \"px\";\r\n\r\n\t\t\tUtils.appendChild(this._actionCardContainer, this._actionCard);\r\n\t\t}\r\n\r\n\t\tif (this._statusCard !== null) {\r\n\t\t\tthis._statusCard.style.paddingLeft = padding.left + \"px\";\r\n\t\t\tthis._statusCard.style.paddingRight = padding.right + \"px\";\r\n\r\n\t\t\tthis._statusCard.style.marginLeft = \"-\" + padding.left + \"px\";\r\n\t\t\tthis._statusCard.style.marginRight = \"-\" + padding.right + \"px\";\r\n\r\n\t\t\tUtils.appendChild(this._actionCardContainer, this._statusCard);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate layoutChanged() {\r\n\t\tthis._owner.getRootElement().updateLayout();\r\n\t}\r\n\r\n\tprivate hideActionCard() {\r\n\t\tvar previouslyExpandedAction = this._expandedAction;\r\n\r\n\t\tthis._expandedAction = null;\r\n\t\tthis._actionCard = null;\r\n\r\n\t\tthis.refreshContainer();\r\n\r\n\t\tif (previouslyExpandedAction) {\r\n\t\t\tthis.layoutChanged();\r\n\r\n\t\t\traiseInlineCardExpandedEvent(previouslyExpandedAction, false);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate showActionCard(action: ShowCardAction, suppressStyle: boolean = false, raiseEvent: boolean = true) {\r\n\t\tif (action.card == null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t(<InlineAdaptiveCard>action.card).suppressStyle = suppressStyle;\r\n\r\n\t\tvar renderedCard = action.card.render();\r\n\r\n\t\tthis._actionCard = renderedCard;\r\n\t\tthis._expandedAction = action;\r\n\r\n\t\tthis.refreshContainer();\r\n\r\n\t\tif (raiseEvent) {\r\n\t\t\tthis.layoutChanged();\r\n\r\n\t\t\traiseInlineCardExpandedEvent(action, true);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate collapseExpandedAction() {\r\n\t\tfor (var i = 0; i < this.buttons.length; i++) {\r\n\t\t\tthis.buttons[i].state = ActionButtonState.Normal;\r\n\t\t}\r\n\r\n\t\tthis.hideActionCard();\r\n\t}\r\n\r\n\tprivate expandShowCardAction(action: ShowCardAction, raiseEvent: boolean) {\r\n\t\tfor (var i = 0; i < this.buttons.length; i++) {\r\n\t\t\tif (this.buttons[i].action !== action) {\r\n\t\t\t\tthis.buttons[i].state = ActionButtonState.Subdued;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.buttons[i].state = ActionButtonState.Expanded;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.showActionCard(\r\n\t\t\taction,\r\n\t\t\t!(this._owner.isAtTheVeryLeft() && this._owner.isAtTheVeryRight()),\r\n\t\t\traiseEvent);\r\n\t}\r\n\r\n\tprivate actionClicked(actionButton: ActionButton) {\r\n\t\tif (!(actionButton.action instanceof ShowCardAction)) {\r\n\t\t\tfor (var i = 0; i < this.buttons.length; i++) {\r\n\t\t\t\tthis.buttons[i].state = ActionButtonState.Normal;\r\n\t\t\t}\r\n\r\n\t\t\tthis.hideStatusCard();\r\n\t\t\tthis.hideActionCard();\r\n\r\n\t\t\tactionButton.action.execute();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.hideStatusCard();\r\n\r\n\t\t\tif (this._owner.hostConfig.actions.showCard.actionMode === Enums.ShowCardActionMode.Popup) {\r\n\t\t\t\tactionButton.action.execute();\r\n\t\t\t}\r\n\t\t\telse if (actionButton.action === this._expandedAction) {\r\n\t\t\t\tthis.collapseExpandedAction();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.expandShowCardAction(actionButton.action, true);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getParentContainer(): Container {\r\n\t\tif (this._owner instanceof Container) {\r\n\t\t\treturn this._owner;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn this._owner.getParentContainer();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate findActionButton(action: Action): ActionButton {\r\n\t\tfor (let actionButton of this.buttons) {\r\n\t\t\tif (actionButton.action == action) {\r\n\t\t\t\treturn actionButton;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\titems: Array<Action> = [];\r\n\tbuttons: Array<ActionButton> = [];\r\n\r\n\tconstructor(owner: CardElement) {\r\n\t\tthis._owner = owner;\r\n\t}\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tthis.clear();\r\n\r\n\t\tif (json && json instanceof Array) {\r\n\t\t\tfor (let jsonAction of json) {\r\n\t\t\t\tlet action = createActionInstance(\r\n\t\t\t\t\tthis._owner,\r\n\t\t\t\t\tjsonAction,\r\n\t\t\t\t\terrors);\r\n\r\n\t\t\t\tif (action) {\r\n\t\t\t\t\tthis.addAction(action);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\tif (this.items.length > 0) {\r\n\t\t\tlet result = [];\r\n\r\n\t\t\tfor (let action of this.items) {\r\n\t\t\t\tresult.push(action.toJSON());\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tshowStatusCard(status: AdaptiveCard) {\r\n\t\tstatus.setParent(this._owner);\r\n\r\n\t\tthis._statusCard = status.render();\r\n\r\n\t\tthis.refreshContainer();\r\n\t}\r\n\r\n\thideStatusCard() {\r\n\t\tthis._statusCard = null;\r\n\r\n\t\tthis.refreshContainer();\r\n\t}\r\n\r\n\tgetActionById(id: string): Action {\r\n\t\tvar result: Action = null;\r\n\r\n\t\tfor (var i = 0; i < this.items.length; i++) {\r\n\t\t\tresult = this.items[i].getActionById(id);\r\n\r\n\t\t\tif (result) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tvalidate(): Array<HostConfig.IValidationError> {\r\n\t\tvar result: Array<HostConfig.IValidationError> = [];\r\n\r\n\t\tif (this._owner.hostConfig.actions.maxActions && this.items.length > this._owner.hostConfig.actions.maxActions) {\r\n\t\t\tresult.push(\r\n\t\t\t\t{\r\n\t\t\t\t\terror: Enums.ValidationError.TooManyActions,\r\n\t\t\t\t\tmessage: \"A maximum of \" + this._owner.hostConfig.actions.maxActions + \" actions are allowed.\"\r\n\t\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (this.items.length > 0 && !this._owner.hostConfig.supportsInteractivity) {\r\n\t\t\tresult.push(\r\n\t\t\t\t{\r\n\t\t\t\t\terror: Enums.ValidationError.InteractivityNotAllowed,\r\n\t\t\t\t\tmessage: \"Interactivity is not allowed.\"\r\n\t\t\t\t});\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < this.items.length; i++) {\r\n\t\t\tif (!isActionAllowed(this.items[i], this._owner.getForbiddenActionTypes())) {\r\n\t\t\t\tresult.push(\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\terror: Enums.ValidationError.ActionTypeNotAllowed,\r\n\t\t\t\t\t\tmessage: \"Actions of type \" + this.items[i].getJsonTypeName() + \" are not allowe.\"\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < this.items.length; i++) {\r\n\t\t\tresult = result.concat(this.items[i].validate());\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\trender(orientation: Enums.Orientation, isDesignMode: boolean): HTMLElement {\r\n\t\tif (!this._owner.hostConfig.supportsInteractivity) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tlet element = document.createElement(\"div\");\r\n\t\tlet maxActions = this._owner.hostConfig.actions.maxActions ? Math.min(this._owner.hostConfig.actions.maxActions, this.items.length) : this.items.length;\r\n\t\tlet forbiddenActionTypes = this._owner.getForbiddenActionTypes();\r\n\r\n\t\tthis._actionCardContainer = document.createElement(\"div\");\r\n\t\tthis._renderedActionCount = 0;\r\n\r\n\t\tif (this._owner.hostConfig.actions.preExpandSingleShowCardAction && maxActions == 1 && this.items[0] instanceof ShowCardAction && isActionAllowed(this.items[0], forbiddenActionTypes)) {\r\n\t\t\tthis.showActionCard(<ShowCardAction>this.items[0], true);\r\n\t\t\tthis._renderedActionCount = 1;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet buttonStrip = document.createElement(\"div\");\r\n\t\t\tbuttonStrip.className = this._owner.hostConfig.makeCssClassName(\"ac-actionSet\");\r\n\t\t\tbuttonStrip.style.display = \"flex\";\r\n\r\n\t\t\tif (orientation == Enums.Orientation.Horizontal) {\r\n\t\t\t\tbuttonStrip.style.flexDirection = \"row\";\r\n\r\n\t\t\t\tif (this._owner.horizontalAlignment && this._owner.hostConfig.actions.actionAlignment != Enums.ActionAlignment.Stretch) {\r\n\t\t\t\t\tswitch (this._owner.horizontalAlignment) {\r\n\t\t\t\t\t\tcase Enums.HorizontalAlignment.Center:\r\n\t\t\t\t\t\t\tbuttonStrip.style.justifyContent = \"center\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase Enums.HorizontalAlignment.Right:\r\n\t\t\t\t\t\t\tbuttonStrip.style.justifyContent = \"flex-end\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tbuttonStrip.style.justifyContent = \"flex-start\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tswitch (this._owner.hostConfig.actions.actionAlignment) {\r\n\t\t\t\t\t\tcase Enums.ActionAlignment.Center:\r\n\t\t\t\t\t\t\tbuttonStrip.style.justifyContent = \"center\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase Enums.ActionAlignment.Right:\r\n\t\t\t\t\t\t\tbuttonStrip.style.justifyContent = \"flex-end\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tbuttonStrip.style.justifyContent = \"flex-start\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tbuttonStrip.style.flexDirection = \"column\";\r\n\r\n\t\t\t\tif (this._owner.horizontalAlignment && this._owner.hostConfig.actions.actionAlignment != Enums.ActionAlignment.Stretch) {\r\n\t\t\t\t\tswitch (this._owner.horizontalAlignment) {\r\n\t\t\t\t\t\tcase Enums.HorizontalAlignment.Center:\r\n\t\t\t\t\t\t\tbuttonStrip.style.alignItems = \"center\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase Enums.HorizontalAlignment.Right:\r\n\t\t\t\t\t\t\tbuttonStrip.style.alignItems = \"flex-end\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tbuttonStrip.style.alignItems = \"flex-start\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tswitch (this._owner.hostConfig.actions.actionAlignment) {\r\n\t\t\t\t\t\tcase Enums.ActionAlignment.Center:\r\n\t\t\t\t\t\t\tbuttonStrip.style.alignItems = \"center\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase Enums.ActionAlignment.Right:\r\n\t\t\t\t\t\t\tbuttonStrip.style.alignItems = \"flex-end\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase Enums.ActionAlignment.Stretch:\r\n\t\t\t\t\t\t\tbuttonStrip.style.alignItems = \"stretch\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tbuttonStrip.style.alignItems = \"flex-start\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tlet parentContainerStyle = this.getParentContainer().style;\r\n\r\n\t\t\tfor (let i = 0; i < this.items.length; i++) {\r\n\t\t\t\tif (isActionAllowed(this.items[i], forbiddenActionTypes)) {\r\n\t\t\t\t\tlet actionButton: ActionButton = this.findActionButton(this.items[i]);\r\n\r\n\t\t\t\t\tif (!actionButton) {\r\n\t\t\t\t\t\tactionButton = new ActionButton(this.items[i], parentContainerStyle);\r\n\t\t\t\t\t\tactionButton.onClick = (ab) => { this.actionClicked(ab); };\r\n\r\n\t\t\t\t\t\tthis.buttons.push(actionButton);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tactionButton.render(this._owner.hostConfig.actions.actionAlignment);\r\n\r\n\t\t\t\t\tbuttonStrip.appendChild(actionButton.action.renderedElement);\r\n\r\n\t\t\t\t\tthis._renderedActionCount++;\r\n\r\n\t\t\t\t\tif (this._renderedActionCount >= this._owner.hostConfig.actions.maxActions || i == this.items.length - 1) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (this._owner.hostConfig.actions.buttonSpacing > 0) {\r\n\t\t\t\t\t\tvar spacer = document.createElement(\"div\");\r\n\r\n\t\t\t\t\t\tif (orientation === Enums.Orientation.Horizontal) {\r\n\t\t\t\t\t\t\tspacer.style.flex = \"0 0 auto\";\r\n\t\t\t\t\t\t\tspacer.style.width = this._owner.hostConfig.actions.buttonSpacing + \"px\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tspacer.style.height = this._owner.hostConfig.actions.buttonSpacing + \"px\";\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tUtils.appendChild(buttonStrip, spacer);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tlet buttonStripContainer = document.createElement(\"div\");\r\n\t\t\tbuttonStripContainer.style.overflow = \"hidden\";\r\n\t\t\tbuttonStripContainer.appendChild(buttonStrip);\r\n\r\n\t\t\tUtils.appendChild(element, buttonStripContainer);\r\n\t\t}\r\n\r\n\t\tUtils.appendChild(element, this._actionCardContainer);\r\n\r\n\t\tfor (let i = 0; i < this.buttons.length; i++) {\r\n\t\t\tif (this.buttons[i].state == ActionButtonState.Expanded) {\r\n\t\t\t\tthis.expandShowCardAction(<ShowCardAction>this.buttons[i].action, false);\r\n\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this._renderedActionCount > 0 ? element : null;\r\n\t}\r\n\r\n\taddAction(action: Action) {\r\n\t\tif (!action) {\r\n\t\t\tthrow new Error(\"The action parameter cannot be null.\");\r\n\t\t}\r\n\r\n\t\tif ((!action.parent || action.parent === this._owner) && this.items.indexOf(action) < 0) {\r\n\t\t\tthis.items.push(action);\r\n\r\n\t\t\tif (!action.parent) {\r\n\t\t\t\taction.setParent(this._owner);\r\n\t\t\t}\r\n\r\n\t\t\tinvokeSetCollection(action, this);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthrow new Error(\"The action already belongs to another element.\");\r\n\t\t}\r\n\t}\r\n\r\n\tremoveAction(action: Action): boolean {\r\n\t\tif (this.expandedAction && this._expandedAction == action) {\r\n\t\t\tthis.collapseExpandedAction();\r\n\t\t}\r\n\r\n\t\tvar actionIndex = this.items.indexOf(action);\r\n\r\n\t\tif (actionIndex >= 0) {\r\n\t\t\tthis.items.splice(actionIndex, 1);\r\n\r\n\t\t\taction.setParent(null);\r\n\r\n\t\t\tinvokeSetCollection(action, null);\r\n\r\n\t\t\tfor (let i = 0; i < this.buttons.length; i++) {\r\n\t\t\t\tif (this.buttons[i].action == action) {\r\n\t\t\t\t\tthis.buttons.splice(i, 1);\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.items = [];\r\n\t\tthis.buttons = [];\r\n\r\n\t\tthis._expandedAction = null;\r\n\t\tthis._renderedActionCount = 0;\r\n\t}\r\n\r\n\tgetAllInputs(): Array<Input> {\r\n\t\tvar result: Array<Input> = [];\r\n\r\n\t\tfor (var i = 0; i < this.items.length; i++) {\r\n\t\t\tvar action = this.items[i];\r\n\r\n\t\t\tresult = result.concat(action.getAllInputs());\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tgetResourceInformation(): Array<IResourceInformation> {\r\n\t\tlet result: Array<IResourceInformation> = [];\r\n\r\n\t\tfor (var i = 0; i < this.items.length; i++) {\r\n\t\t\tresult = result.concat(this.items[i].getResourceInformation());\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tget renderedActionCount(): number {\r\n\t\treturn this._renderedActionCount;\r\n\t}\r\n\r\n\tget expandedAction(): ShowCardAction {\r\n\t\treturn this._expandedAction;\r\n\t}\r\n}\r\n\r\nexport class ActionSet extends CardElement {\r\n\tprivate _actionCollection: ActionCollection;\r\n\r\n\tprotected internalRender(): HTMLElement {\r\n\t\treturn this._actionCollection.render(this.orientation ? this.orientation : this.hostConfig.actions.actionsOrientation, this.isDesignMode());\r\n\t}\r\n\r\n\torientation?: Enums.Orientation = null;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis._actionCollection = new ActionCollection(this);\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\tlet result = super.toJSON();\r\n\r\n\t\tUtils.setEnumProperty(Enums.Orientation, result, \"orientation\", this.orientation);\r\n\t\tUtils.setProperty(result, \"actions\", this._actionCollection.toJSON());\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tisBleeding(): boolean {\r\n\t\treturn this._actionCollection.expandedAction ? true : false;\r\n\t}\r\n\r\n\tgetJsonTypeName(): string {\r\n\t\treturn \"ActionSet\";\r\n\t}\r\n\r\n\tgetActionCount(): number {\r\n\t\treturn this._actionCollection.items.length;\r\n\t}\r\n\r\n\tgetActionAt(index: number): Action {\r\n\t\tif (index >= 0 && index < this.getActionCount()) {\r\n\t\t\treturn this._actionCollection.items[index];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tsuper.getActionAt(index);\r\n\t\t}\r\n\t}\r\n\r\n\tvalidate(): Array<HostConfig.IValidationError> {\r\n\t\treturn this._actionCollection.validate();\r\n\t}\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tsuper.parse(json, errors);\r\n\r\n\t\tvar jsonOrientation = json[\"orientation\"];\r\n\r\n\t\tif (jsonOrientation) {\r\n\t\t\tthis.orientation = Utils.getEnumValueOrDefault(Enums.Orientation, jsonOrientation, Enums.Orientation.Horizontal);\r\n\t\t}\r\n\r\n\t\tthis._actionCollection.parse(json[\"actions\"], errors);\r\n\t}\r\n\r\n\taddAction(action: Action) {\r\n\t\tthis._actionCollection.addAction(action);\r\n\t}\r\n\r\n\tgetAllInputs(): Array<Input> {\r\n\t\treturn this._actionCollection.getAllInputs();\r\n\t}\r\n\r\n\tgetResourceInformation(): Array<IResourceInformation> {\r\n\t\treturn this._actionCollection.getResourceInformation();\r\n\t}\r\n\r\n\trenderSpeech(): string {\r\n\t\t// TODO: What's the right thing to do here?\r\n\t\treturn \"\";\r\n\t}\r\n\r\n\tget isInteractive(): boolean {\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nexport class BackgroundImage {\r\n\turl: string;\r\n\tmode: Enums.BackgroundImageMode = Enums.BackgroundImageMode.Stretch;\r\n\thorizontalAlignment: Enums.HorizontalAlignment = Enums.HorizontalAlignment.Left;\r\n\tverticalAlignment: Enums.VerticalAlignment = Enums.VerticalAlignment.Top;\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tthis.url = json[\"url\"];\r\n\t\tthis.mode = Utils.getEnumValueOrDefault(Enums.BackgroundImageMode, json[\"mode\"], this.mode);\r\n\t\tthis.horizontalAlignment = Utils.getEnumValueOrDefault(Enums.HorizontalAlignment, json[\"horizontalAlignment\"], this.horizontalAlignment);\r\n\t\tthis.verticalAlignment = Utils.getEnumValueOrDefault(Enums.VerticalAlignment, json[\"verticalAlignment\"], this.verticalAlignment);\r\n\t}\r\n\r\n\tapply(element: HTMLElement) {\r\n\t\tif (this.url) {\r\n\t\t\telement.style.backgroundImage = \"url('\" + this.url + \"')\";\r\n\r\n\t\t\tswitch (this.mode) {\r\n\t\t\t\tcase Enums.BackgroundImageMode.Repeat:\r\n\t\t\t\t\telement.style.backgroundRepeat = \"repeat\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Enums.BackgroundImageMode.RepeatHorizontally:\r\n\t\t\t\t\telement.style.backgroundRepeat = \"repeat-x\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Enums.BackgroundImageMode.RepeatVertically:\r\n\t\t\t\t\telement.style.backgroundRepeat = \"repeat-y\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Enums.BackgroundImageMode.Stretch:\r\n\t\t\t\tdefault:\r\n\t\t\t\t\telement.style.backgroundRepeat = \"no-repeat\";\r\n\t\t\t\t\telement.style.backgroundSize = \"cover\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tswitch (this.horizontalAlignment) {\r\n\t\t\t\tcase Enums.HorizontalAlignment.Center:\r\n\t\t\t\t\telement.style.backgroundPositionX = \"center\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Enums.HorizontalAlignment.Right:\r\n\t\t\t\t\telement.style.backgroundPositionX = \"right\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tswitch (this.verticalAlignment) {\r\n\t\t\t\tcase Enums.VerticalAlignment.Center:\r\n\t\t\t\t\telement.style.backgroundPositionY = \"center\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Enums.VerticalAlignment.Bottom:\r\n\t\t\t\t\telement.style.backgroundPositionY = \"bottom\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class Container extends CardElementContainer {\r\n\tprivate _selectAction: Action;\r\n\tprivate _items: Array<CardElement> = [];\r\n\tprivate _renderedItems: Array<CardElement> = [];\r\n\tprivate _style?: string = null;\r\n\r\n\tprivate isElementAllowed(element: CardElement, forbiddenElementTypes: Array<string>) {\r\n\t\tif (!this.hostConfig.supportsInteractivity && element.isInteractive) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (forbiddenElementTypes) {\r\n\t\t\tfor (var i = 0; i < forbiddenElementTypes.length; i++) {\r\n\t\t\t\tif (element.getJsonTypeName() === forbiddenElementTypes[i]) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tprivate insertItemAt(\r\n\t\titem: CardElement,\r\n\t\tindex: number,\r\n\t\tforceInsert: boolean) {\r\n\t\tif (!item.parent || forceInsert) {\r\n\t\t\tif (item.isStandalone) {\r\n\t\t\t\tif (index < 0 || index >= this._items.length) {\r\n\t\t\t\t\tthis._items.push(item);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis._items.splice(index, 0, item);\r\n\t\t\t\t}\r\n\r\n\t\t\t\titem.setParent(this);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthrow new Error(\"Elements of type \" + item.getJsonTypeName() + \" cannot be used as standalone elements.\");\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthrow new Error(\"The element already belongs to another container.\")\r\n\t\t}\r\n\t}\r\n\r\n\tprivate get hasExplicitStyle(): boolean {\r\n\t\treturn this._style != null;\r\n\t}\r\n\r\n\tprotected getItemsCollectionPropertyName(): string {\r\n\t\treturn \"items\";\r\n\t}\r\n\r\n\tprotected isLastElementBleeding(): boolean {\r\n\t\treturn this._renderedItems.length > 0 ? this._renderedItems[this._renderedItems.length - 1].isBleeding() : false;\r\n\t}\r\n\r\n\tprotected applyPadding() {\r\n\t\tif (!this.renderedElement) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (this.padding) {\r\n\t\t\tvar physicalPadding = this.padding.toSpacingDefinition(this.hostConfig);\r\n\r\n\t\t\tthis.renderedElement.style.paddingTop = physicalPadding.top + \"px\";\r\n\t\t\tthis.renderedElement.style.paddingRight = physicalPadding.right + \"px\";\r\n\t\t\tthis.renderedElement.style.paddingBottom = physicalPadding.bottom + \"px\";\r\n\t\t\tthis.renderedElement.style.paddingLeft = physicalPadding.left + \"px\";\r\n\t\t}\r\n\t\telse if (this.hasBackground) {\r\n\t\t\tvar physicalMargin: SpacingDefinition = new SpacingDefinition();\r\n\t\t\tvar physicalPadding: SpacingDefinition = new SpacingDefinition();\r\n\r\n\t\t\tvar useAutoPadding = (this.parent ? this.parent.canContentBleed() : false) && AdaptiveCard.useAutomaticContainerBleeding;\r\n\r\n\t\t\tif (useAutoPadding) {\r\n\t\t\t\tvar effectivePadding = this.getNonZeroPadding();\r\n\t\t\t\tvar effectiveMargin: PaddingDefinition = new PaddingDefinition(\r\n\t\t\t\t\teffectivePadding.top,\r\n\t\t\t\t\teffectivePadding.right,\r\n\t\t\t\t\teffectivePadding.bottom,\r\n\t\t\t\t\teffectivePadding.left);\r\n\r\n\t\t\t\tif (!this.isAtTheVeryTop()) {\r\n\t\t\t\t\teffectivePadding.top = Enums.Spacing.None;\r\n\t\t\t\t\teffectiveMargin.top = Enums.Spacing.None;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!this.isAtTheVeryBottom()) {\r\n\t\t\t\t\teffectivePadding.bottom = Enums.Spacing.None;\r\n\t\t\t\t\teffectiveMargin.bottom = Enums.Spacing.None;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!this.isAtTheVeryLeft()) {\r\n\t\t\t\t\teffectivePadding.left = Enums.Spacing.None;\r\n\t\t\t\t\teffectiveMargin.left = Enums.Spacing.None;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!this.isAtTheVeryRight()) {\r\n\t\t\t\t\teffectivePadding.right = Enums.Spacing.None;\r\n\t\t\t\t\teffectiveMargin.right = Enums.Spacing.None;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (effectivePadding.left != Enums.Spacing.None || effectivePadding.right != Enums.Spacing.None) {\r\n\t\t\t\t\tif (effectivePadding.left == Enums.Spacing.None) {\r\n\t\t\t\t\t\teffectivePadding.left = effectivePadding.right;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (effectivePadding.right == Enums.Spacing.None) {\r\n\t\t\t\t\t\teffectivePadding.right = effectivePadding.left;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (effectivePadding.top != Enums.Spacing.None || effectivePadding.bottom != Enums.Spacing.None) {\r\n\t\t\t\t\tif (effectivePadding.top == Enums.Spacing.None) {\r\n\t\t\t\t\t\teffectivePadding.top = effectivePadding.bottom;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (effectivePadding.bottom == Enums.Spacing.None) {\r\n\t\t\t\t\t\teffectivePadding.bottom = effectivePadding.top;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (effectivePadding.top != Enums.Spacing.None\r\n\t\t\t\t\t|| effectivePadding.right != Enums.Spacing.None\r\n\t\t\t\t\t|| effectivePadding.bottom != Enums.Spacing.None\r\n\t\t\t\t\t|| effectivePadding.left != Enums.Spacing.None) {\r\n\t\t\t\t\tif (effectivePadding.top == Enums.Spacing.None) {\r\n\t\t\t\t\t\teffectivePadding.top = Enums.Spacing.Default;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (effectivePadding.right == Enums.Spacing.None) {\r\n\t\t\t\t\t\teffectivePadding.right = Enums.Spacing.Default;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (effectivePadding.bottom == Enums.Spacing.None) {\r\n\t\t\t\t\t\teffectivePadding = Object.assign(\r\n\t\t\t\t\t\t\t{},\r\n\t\t\t\t\t\t\teffectivePadding,\r\n\t\t\t\t\t\t\t{ bottom: Enums.Spacing.Default }\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (effectivePadding.left == Enums.Spacing.None) {\r\n\t\t\t\t\t\teffectivePadding = Object.assign(\r\n\t\t\t\t\t\t\t{},\r\n\t\t\t\t\t\t\teffectivePadding,\r\n\t\t\t\t\t\t\t{ left: Enums.Spacing.Default }\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (effectivePadding.top == Enums.Spacing.None &&\r\n\t\t\t\t\teffectivePadding.right == Enums.Spacing.None &&\r\n\t\t\t\t\teffectivePadding.bottom == Enums.Spacing.None &&\r\n\t\t\t\t\teffectivePadding.left == Enums.Spacing.None) {\r\n\t\t\t\t\teffectivePadding = new PaddingDefinition(\r\n\t\t\t\t\t\tEnums.Spacing.Padding,\r\n\t\t\t\t\t\tEnums.Spacing.Padding,\r\n\t\t\t\t\t\tEnums.Spacing.Padding,\r\n\t\t\t\t\t\tEnums.Spacing.Padding);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tphysicalMargin = effectiveMargin.toSpacingDefinition(this.hostConfig);\r\n\t\t\t\tphysicalPadding = effectivePadding.toSpacingDefinition(this.hostConfig);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tphysicalPadding = new PaddingDefinition(\r\n\t\t\t\t\tEnums.Spacing.Padding,\r\n\t\t\t\t\tEnums.Spacing.Padding,\r\n\t\t\t\t\tEnums.Spacing.Padding,\r\n\t\t\t\t\tEnums.Spacing.Padding\r\n\t\t\t\t).toSpacingDefinition(this.hostConfig);\r\n\t\t\t}\r\n\r\n\t\t\tthis.renderedElement.style.marginTop = \"-\" + physicalMargin.top + \"px\";\r\n\t\t\tthis.renderedElement.style.marginRight = \"-\" + physicalMargin.right + \"px\";\r\n\t\t\tthis.renderedElement.style.marginBottom = \"-\" + physicalMargin.bottom + \"px\";\r\n\t\t\tthis.renderedElement.style.marginLeft = \"-\" + physicalMargin.left + \"px\";\r\n\r\n\t\t\tthis.renderedElement.style.paddingTop = physicalPadding.top + \"px\";\r\n\t\t\tthis.renderedElement.style.paddingRight = physicalPadding.right + \"px\";\r\n\t\t\tthis.renderedElement.style.paddingBottom = physicalPadding.bottom + \"px\";\r\n\t\t\tthis.renderedElement.style.paddingLeft = physicalPadding.left + \"px\";\r\n\r\n\t\t\tif (this.separatorElement) {\r\n\t\t\t\tif (this.separatorOrientation == Enums.Orientation.Horizontal) {\r\n\t\t\t\t\tthis.separatorElement.style.marginLeft = \"-\" + physicalMargin.left + \"px\";\r\n\t\t\t\t\tthis.separatorElement.style.marginRight = \"-\" + physicalMargin.right + \"px\";\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.separatorElement.style.marginTop = \"-\" + physicalMargin.top + \"px\";\r\n\t\t\t\t\tthis.separatorElement.style.marginBottom = \"-\" + physicalMargin.bottom + \"px\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isLastElementBleeding()) {\r\n\t\t\tthis.renderedElement.style.paddingBottom = \"0px\";\r\n\t\t}\r\n\t}\r\n\r\n\tprotected internalRender(): HTMLElement {\r\n\t\tthis._renderedItems = [];\r\n\r\n\t\t// Cache hostConfig to avoid walking the parent hierarchy several times\r\n\t\tlet hostConfig = this.hostConfig;\r\n\r\n\t\tvar element = document.createElement(\"div\");\r\n\r\n\t\tif (this.rtl != null && this.rtl) {\r\n\t\t\telement.dir = \"rtl\";\r\n\t\t}\r\n\r\n\t\telement.classList.add(hostConfig.makeCssClassName(\"ac-container\"));\r\n\t\telement.style.display = \"flex\";\r\n\t\telement.style.flexDirection = \"column\";\r\n\r\n\t\tif (AdaptiveCard.useAdvancedCardBottomTruncation) {\r\n\t\t\t// Forces the container to be at least as tall as its content.\r\n\t\t\t//\r\n\t\t\t// Fixes a quirk in Chrome where, for nested flex elements, the\r\n\t\t\t// inner element's height would never exceed the outer element's\r\n\t\t\t// height. This caused overflow truncation to break -- containers\r\n\t\t\t// would always be measured as not overflowing, since their heights\r\n\t\t\t// were constrained by their parents as opposed to truly reflecting\r\n\t\t\t// the height of their content.\r\n\t\t\t//\r\n\t\t\t// See the \"Browser Rendering Notes\" section of this answer:\r\n\t\t\t// https://stackoverflow.com/questions/36247140/why-doesnt-flex-item-shrink-past-content-size\r\n\t\t\telement.style.minHeight = '-webkit-min-content';\r\n\t\t}\r\n\r\n\t\tswitch (this.verticalContentAlignment) {\r\n\t\t\tcase Enums.VerticalAlignment.Center:\r\n\t\t\t\telement.style.justifyContent = \"center\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase Enums.VerticalAlignment.Bottom:\r\n\t\t\t\telement.style.justifyContent = \"flex-end\";\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\telement.style.justifyContent = \"flex-start\";\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tif (this.hasBackground) {\r\n\t\t\tif (this.backgroundImage) {\r\n\t\t\t\tthis.backgroundImage.apply(element);\r\n\t\t\t}\r\n\r\n\t\t\tlet styleDefinition = this.hostConfig.containerStyles.getStyleByName(this.style, this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));\r\n\r\n\t\t\tif (!Utils.isNullOrEmpty(styleDefinition.backgroundColor)) {\r\n\t\t\t\telement.style.backgroundColor = Utils.stringToCssColor(styleDefinition.backgroundColor);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.selectAction && hostConfig.supportsInteractivity) {\r\n\t\t\telement.classList.add(hostConfig.makeCssClassName(\"ac-selectable\"));\r\n\t\t\telement.tabIndex = 0;\r\n\t\t\telement.setAttribute(\"role\", \"button\");\r\n\t\t\telement.setAttribute(\"aria-label\", this.selectAction.title);\r\n\r\n\t\t\telement.onclick = (e) => {\r\n\t\t\t\tif (this.selectAction != null) {\r\n\t\t\t\t\tthis.selectAction.execute();\r\n\t\t\t\t\te.cancelBubble = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\telement.onkeypress = (e) => {\r\n\t\t\t\tif (this.selectAction != null) {\r\n\t\t\t\t\t// Enter or space pressed\r\n\t\t\t\t\tif (e.keyCode == 13 || e.keyCode == 32) {\r\n\t\t\t\t\t\tthis.selectAction.execute();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this._items.length > 0) {\r\n\t\t\tfor (var i = 0; i < this._items.length; i++) {\r\n\t\t\t\tvar renderedElement = this.isElementAllowed(this._items[i], this.getForbiddenElementTypes()) ? this._items[i].render() : null;\r\n\r\n\t\t\t\tif (renderedElement) {\r\n\t\t\t\t\tif (this._renderedItems.length > 0 && this._items[i].separatorElement) {\r\n\t\t\t\t\t\tthis._items[i].separatorElement.style.flex = \"0 0 auto\";\r\n\r\n\t\t\t\t\t\tUtils.appendChild(element, this._items[i].separatorElement);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tUtils.appendChild(element, renderedElement);\r\n\r\n\t\t\t\t\tthis._renderedItems.push(this._items[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (this.isDesignMode()) {\r\n\t\t\t\tvar placeholderElement = this.createPlaceholderElement();\r\n\t\t\t\tplaceholderElement.style.width = \"100%\";\r\n\t\t\t\tplaceholderElement.style.height = \"100%\";\r\n\r\n\t\t\t\telement.appendChild(placeholderElement);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn element;\r\n\t}\r\n\r\n\tprotected truncateOverflow(maxHeight: number): boolean {\r\n\t\t// Add 1 to account for rounding differences between browsers\r\n\t\tvar boundary = this.renderedElement.offsetTop + maxHeight + 1;\r\n\r\n\t\tvar handleElement = (cardElement: CardElement) => {\r\n\t\t\tlet elt = cardElement.renderedElement;\r\n\r\n\t\t\tif (elt) {\r\n\t\t\t\tswitch (Utils.getFitStatus(elt, boundary)) {\r\n\t\t\t\t\tcase Enums.ContainerFitStatus.FullyInContainer:\r\n\t\t\t\t\t\tlet sizeChanged = cardElement['resetOverflow']();\r\n\t\t\t\t\t\t// If the element's size changed after resetting content,\r\n\t\t\t\t\t\t// we have to check if it still fits fully in the card\r\n\t\t\t\t\t\tif (sizeChanged) {\r\n\t\t\t\t\t\t\thandleElement(cardElement);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase Enums.ContainerFitStatus.Overflowing:\r\n\t\t\t\t\t\tlet maxHeight = boundary - elt.offsetTop;\r\n\t\t\t\t\t\tcardElement['handleOverflow'](maxHeight);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase Enums.ContainerFitStatus.FullyOutOfContainer:\r\n\t\t\t\t\t\tcardElement['handleOverflow'](0);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tfor (let item of this._items) {\r\n\t\t\thandleElement(item);\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tprotected undoOverflowTruncation() {\r\n\t\tfor (let item of this._items) {\r\n\t\t\titem['resetOverflow']();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected get hasBackground(): boolean {\r\n\t\tvar parentContainer = this.getParentContainer();\r\n\r\n\t\treturn this.backgroundImage != undefined || (this.hasExplicitStyle && (parentContainer ? parentContainer.style != this.style : false));\r\n\t}\r\n\r\n\tprotected get defaultStyle(): string {\r\n\t\treturn Enums.ContainerStyle.Default;\r\n\t}\r\n\r\n\tprotected get allowCustomStyle(): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tbackgroundImage: BackgroundImage;\r\n\tverticalContentAlignment: Enums.VerticalAlignment = Enums.VerticalAlignment.Top;\r\n\trtl?: boolean = null;\r\n\r\n\ttoJSON() {\r\n\t\tlet result = super.toJSON();\r\n\r\n\t\tif (this._selectAction) {\r\n\t\t\tUtils.setProperty(result, \"selectAction\", this._selectAction.toJSON());\r\n\t\t}\r\n\r\n\t\tif (this.backgroundImage) {\r\n\t\t\tUtils.setProperty(result, \"backgroundImage\", this.backgroundImage.url);\r\n\t\t}\r\n\r\n\t\tUtils.setProperty(result, \"style\", this.style, \"default\");\r\n\t\tUtils.setEnumProperty(Enums.VerticalAlignment, result, \"verticalContentAlignment\", this.verticalContentAlignment, Enums.VerticalAlignment.Top);\r\n\r\n\t\tif (this._items.length > 0) {\r\n\t\t\tlet elements = [];\r\n\r\n\t\t\tfor (let element of this._items) {\r\n\t\t\t\telements.push(element.toJSON());\r\n\t\t\t}\r\n\r\n\t\t\tUtils.setProperty(result, this.getItemsCollectionPropertyName(), elements);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tgetItemCount(): number {\r\n\t\treturn this._items.length;\r\n\t}\r\n\r\n\tgetItemAt(index: number): CardElement {\r\n\t\treturn this._items[index];\r\n\t}\r\n\r\n\tgetJsonTypeName(): string {\r\n\t\treturn \"Container\";\r\n\t}\r\n\r\n\tisBleeding(): boolean {\r\n\t\treturn this.isLastElementBleeding();\r\n\t}\r\n\r\n\tisFirstElement(element: CardElement): boolean {\r\n\t\tfor (var i = 0; i < this._items.length; i++) {\r\n\t\t\tif (this._items[i].isVisible) {\r\n\t\t\t\treturn this._items[i] == element;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tisLastElement(element: CardElement): boolean {\r\n\t\tfor (var i = this._items.length - 1; i >= 0; i--) {\r\n\t\t\tif (this._items[i].isVisible) {\r\n\t\t\t\treturn this._items[i] == element;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tisRtl(): boolean {\r\n\t\tif (this.rtl != null) {\r\n\t\t\treturn this.rtl;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet parentContainer = this.getParentContainer();\r\n\r\n\t\t\treturn parentContainer ? parentContainer.isRtl() : false;\r\n\t\t}\r\n\t}\r\n\r\n\tvalidate(): Array<HostConfig.IValidationError> {\r\n\t\tvar result: Array<HostConfig.IValidationError> = [];\r\n\r\n\t\tif (this._style) {\r\n\t\t\tvar styleDefinition = this.hostConfig.containerStyles.getStyleByName(this._style);\r\n\r\n\t\t\tif (!styleDefinition) {\r\n\t\t\t\tresult.push(\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\terror: Enums.ValidationError.InvalidPropertyValue,\r\n\t\t\t\t\t\tmessage: \"Unknown container style: \" + this._style\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < this._items.length; i++) {\r\n\t\t\tif (!this.hostConfig.supportsInteractivity && this._items[i].isInteractive) {\r\n\t\t\t\tresult.push(\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\terror: Enums.ValidationError.InteractivityNotAllowed,\r\n\t\t\t\t\t\tmessage: \"Interactivity is not allowed.\"\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif (!this.isElementAllowed(this._items[i], this.getForbiddenElementTypes())) {\r\n\t\t\t\tresult.push(\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\terror: Enums.ValidationError.InteractivityNotAllowed,\r\n\t\t\t\t\t\tmessage: \"Elements of type \" + this._items[i].getJsonTypeName() + \" are not allowed in this container.\"\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tresult = result.concat(this._items[i].validate());\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tsuper.parse(json, errors);\r\n\r\n\t\tthis.setShouldFallback(false);\r\n\r\n\t\tthis._items = [];\r\n\t\tthis._renderedItems = [];\r\n\r\n\t\tlet jsonBackgroundImage = json[\"backgroundImage\"];\r\n\r\n\t\tif (jsonBackgroundImage) {\r\n\t\t\tthis.backgroundImage = new BackgroundImage();\r\n\r\n\t\t\tif (typeof jsonBackgroundImage === \"string\") {\r\n\t\t\t\tthis.backgroundImage.url = jsonBackgroundImage;\r\n\t\t\t\tthis.backgroundImage.mode = Enums.BackgroundImageMode.Stretch;\r\n\t\t\t}\r\n\t\t\telse if (typeof jsonBackgroundImage === \"object\") {\r\n\t\t\t\tthis.backgroundImage = new BackgroundImage();\r\n\t\t\t\tthis.backgroundImage.parse(json[\"backgroundImage\"], errors);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.verticalContentAlignment = Utils.getEnumValueOrDefault(Enums.VerticalAlignment, json[\"verticalContentAlignment\"], this.verticalContentAlignment);\r\n\r\n\t\tthis._style = json[\"style\"];\r\n\r\n\t\tthis.selectAction = createActionInstance(\r\n\t\t\tthis,\r\n\t\t\tjson[\"selectAction\"],\r\n\t\t\terrors);\r\n\r\n\t\tif (json[this.getItemsCollectionPropertyName()] != null) {\r\n\t\t\tlet items = json[this.getItemsCollectionPropertyName()] as Array<any>;\r\n\r\n\t\t\tthis.clear();\r\n\r\n\t\t\tfor (let i = 0; i < items.length; i++) {\r\n\t\t\t\tlet element = createElementInstance(this, items[i], errors);\r\n\r\n\t\t\t\tif (element) {\r\n\t\t\t\t\tthis.insertItemAt(element, -1, true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tindexOf(cardElement: CardElement): number {\r\n\t\treturn this._items.indexOf(cardElement);\r\n\t}\r\n\r\n\taddItem(item: CardElement) {\r\n\t\tthis.insertItemAt(item, -1, false);\r\n\t}\r\n\r\n\tinsertItemBefore(item: CardElement, insertBefore: CardElement) {\r\n\t\tthis.insertItemAt(item, this._items.indexOf(insertBefore), false);\r\n\t}\r\n\r\n\tinsertItemAfter(item: CardElement, insertAfter: CardElement) {\r\n\t\tthis.insertItemAt(item, this._items.indexOf(insertAfter) + 1, false);\r\n\t}\r\n\r\n\tremoveItem(item: CardElement): boolean {\r\n\t\tvar itemIndex = this._items.indexOf(item);\r\n\r\n\t\tif (itemIndex >= 0) {\r\n\t\t\tthis._items.splice(itemIndex, 1);\r\n\r\n\t\t\titem.setParent(null);\r\n\r\n\t\t\tthis.updateLayout();\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis._items = [];\r\n\t}\r\n\r\n\tcanContentBleed(): boolean {\r\n\t\treturn this.hasBackground ? false : super.canContentBleed();\r\n\t}\r\n\r\n\tgetAllInputs(): Array<Input> {\r\n\t\tvar result: Array<Input> = [];\r\n\r\n\t\tfor (var i = 0; i < this._items.length; i++) {\r\n\t\t\tvar item: CardElement = this._items[i];\r\n\r\n\t\t\tresult = result.concat(item.getAllInputs());\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tgetResourceInformation(): Array<IResourceInformation> {\r\n\t\tlet result: Array<IResourceInformation> = [];\r\n\r\n\t\tif (this.backgroundImage && !Utils.isNullOrEmpty(this.backgroundImage.url)) {\r\n\t\t\tresult.push({ url: this.backgroundImage.url, mimeType: \"image\" });\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < this.getItemCount(); i++) {\r\n\t\t\tresult = result.concat(this.getItemAt(i).getResourceInformation());\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tgetElementById(id: string): CardElement {\r\n\t\tvar result: CardElement = super.getElementById(id);\r\n\r\n\t\tif (!result) {\r\n\t\t\tfor (var i = 0; i < this._items.length; i++) {\r\n\t\t\t\tresult = this._items[i].getElementById(id);\r\n\r\n\t\t\t\tif (result) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tgetActionById(id: string): Action {\r\n\t\tvar result: Action = super.getActionById(id);\r\n\r\n\t\tif (!result) {\r\n\t\t\tif (this.selectAction) {\r\n\t\t\t\tresult = this.selectAction.getActionById(id);\r\n\t\t\t}\r\n\r\n\t\t\tif (!result) {\r\n\t\t\t\tfor (var i = 0; i < this._items.length; i++) {\r\n\t\t\t\t\tresult = this._items[i].getActionById(id);\r\n\r\n\t\t\t\t\tif (result) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\trenderSpeech(): string {\r\n\t\tif (this.speak != null) {\r\n\t\t\treturn this.speak;\r\n\t\t}\r\n\r\n\t\t// render each item\r\n\t\tlet speak = null;\r\n\r\n\t\tif (this._items.length > 0) {\r\n\t\t\tspeak = '';\r\n\r\n\t\t\tfor (var i = 0; i < this._items.length; i++) {\r\n\t\t\t\tvar result = this._items[i].renderSpeech();\r\n\r\n\t\t\t\tif (result) {\r\n\t\t\t\t\tspeak += result;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn speak;\r\n\t}\r\n\r\n\tupdateLayout(processChildren: boolean = true) {\r\n\t\tsuper.updateLayout(processChildren);\r\n\r\n\t\tthis.applyPadding();\r\n\r\n\t\tif (processChildren) {\r\n\t\t\tfor (var i = 0; i < this._items.length; i++) {\r\n\t\t\t\tthis._items[i].updateLayout();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tget style(): string {\r\n\t\tif (this.allowCustomStyle) {\r\n\t\t\tif (this._style && this.hostConfig.containerStyles.getStyleByName(this._style)) {\r\n\t\t\t\treturn this._style;\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn this.defaultStyle;\r\n\t\t}\r\n\t}\r\n\r\n\tset style(value: string) {\r\n\t\tthis._style = value;\r\n\t}\r\n\r\n\tget padding(): PaddingDefinition {\r\n\t\treturn this.getPadding();\r\n\t}\r\n\r\n\tset padding(value: PaddingDefinition) {\r\n\t\tthis.setPadding(value);\r\n\t}\r\n\r\n\tget selectAction(): Action {\r\n\t\treturn this._selectAction;\r\n\t}\r\n\r\n\tset selectAction(value: Action) {\r\n\t\tthis._selectAction = value;\r\n\r\n\t\tif (this._selectAction) {\r\n\t\t\tthis._selectAction.setParent(this);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport type ColumnWidth = Utils.SizeAndUnit | \"auto\" | \"stretch\";\r\n\r\nexport class Column extends Container {\r\n\tprivate _computedWeight: number = 0;\r\n\r\n\tprotected adjustRenderedElementSize(renderedElement: HTMLElement) {\r\n\t\tif (this.isDesignMode()) {\r\n\t\t\trenderedElement.style.minWidth = \"20px\";\r\n\t\t\trenderedElement.style.minHeight = \"20px\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderedElement.style.minWidth = \"0\";\r\n\t\t}\r\n\r\n\t\tif (this.width === \"auto\") {\r\n\t\t\trenderedElement.style.flex = \"0 1 auto\";\r\n\t\t}\r\n\t\telse if (this.width === \"stretch\") {\r\n\t\t\trenderedElement.style.flex = \"1 1 50px\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet sizeAndUnit = <Utils.SizeAndUnit>this.width;\r\n\r\n\t\t\tif (sizeAndUnit.unit == Enums.SizeUnit.Pixel) {\r\n\t\t\t\trenderedElement.style.flex = \"0 0 auto\";\r\n\t\t\t\trenderedElement.style.width = sizeAndUnit.physicalSize + \"px\";\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\trenderedElement.style.flex = \"1 1 \" + (this._computedWeight > 0 ? this._computedWeight : sizeAndUnit.physicalSize) + \"%\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected get separatorOrientation(): Enums.Orientation {\r\n\t\treturn Enums.Orientation.Vertical;\r\n\t}\r\n\r\n\twidth: ColumnWidth = \"auto\";\r\n\r\n\tconstructor(width: ColumnWidth = \"auto\") {\r\n\t\tsuper();\r\n\r\n\t\tthis.width = width;\r\n\t}\r\n\r\n\tgetJsonTypeName(): string {\r\n\t\treturn \"Column\";\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\tlet result = super.toJSON();\r\n\r\n\t\tif (this.width instanceof Utils.SizeAndUnit) {\r\n\t\t\tif (this.width.unit == Enums.SizeUnit.Pixel) {\r\n\t\t\t\tUtils.setProperty(result, \"width\", this.width.physicalSize + \"px\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tUtils.setProperty(result, \"width\", this.width.physicalSize);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tUtils.setProperty(result, \"width\", this.width);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tsuper.parse(json, errors);\r\n\r\n\t\tvar jsonWidth = json[\"width\"];\r\n\r\n\t\tif (jsonWidth === undefined) {\r\n\t\t\tjsonWidth = json[\"size\"];\r\n\r\n\t\t\tif (jsonWidth !== undefined) {\r\n\t\t\t\traiseParseError(\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\terror: Enums.ValidationError.Deprecated,\r\n\t\t\t\t\t\tmessage: \"The \\\"Column.size\\\" property is deprecated and will be removed. Use the \\\"Column.width\\\" property instead.\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\terrors\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar invalidWidth = false;\r\n\r\n\t\ttry {\r\n\t\t\tthis.width = Utils.SizeAndUnit.parse(jsonWidth);\r\n\t\t}\r\n\t\tcatch (e) {\r\n\t\t\tif (typeof jsonWidth === \"string\" && (jsonWidth === \"auto\" || jsonWidth === \"stretch\")) {\r\n\t\t\t\tthis.width = jsonWidth;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tinvalidWidth = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (invalidWidth) {\r\n\t\t\traiseParseError(\r\n\t\t\t\t{\r\n\t\t\t\t\terror: Enums.ValidationError.InvalidPropertyValue,\r\n\t\t\t\t\tmessage: \"Invalid column width:\" + jsonWidth + \" - defaulting to \\\"auto\\\"\"\r\n\t\t\t\t},\r\n\t\t\t\terrors\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tget hasVisibleSeparator(): boolean {\r\n\t\tif (this.parent && this.parent instanceof ColumnSet) {\r\n\t\t\treturn this.separatorElement && !this.parent.isLeftMostElement(this);\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tget isStandalone(): boolean {\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nexport class ColumnSet extends CardElementContainer {\r\n\tprivate _columns: Array<Column> = [];\r\n\tprivate _selectAction: Action;\r\n\r\n\tprotected applyPadding() {\r\n\t\tif (this.padding) {\r\n\t\t\tif (this.renderedElement) {\r\n\t\t\t\tvar physicalPadding = this.padding.toSpacingDefinition(this.hostConfig);\r\n\r\n\t\t\t\tthis.renderedElement.style.paddingTop = physicalPadding.top + \"px\";\r\n\t\t\t\tthis.renderedElement.style.paddingRight = physicalPadding.right + \"px\";\r\n\t\t\t\tthis.renderedElement.style.paddingBottom = physicalPadding.bottom + \"px\";\r\n\t\t\t\tthis.renderedElement.style.paddingLeft = physicalPadding.left + \"px\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected internalRender(): HTMLElement {\r\n\t\tif (this._columns.length > 0) {\r\n\t\t\t// Cache hostConfig to avoid walking the parent hierarchy several times\r\n\t\t\tlet hostConfig = this.hostConfig;\r\n\r\n\t\t\tvar element = document.createElement(\"div\");\r\n\t\t\telement.className = hostConfig.makeCssClassName(\"ac-columnSet\");\r\n\t\t\telement.style.display = \"flex\";\r\n\r\n\t\t\tif (AdaptiveCard.useAdvancedCardBottomTruncation) {\r\n\t\t\t\t// See comment in Container.internalRender()\r\n\t\t\t\telement.style.minHeight = '-webkit-min-content';\r\n\t\t\t}\r\n\r\n\t\t\tif (this.selectAction && hostConfig.supportsInteractivity) {\r\n\t\t\t\telement.classList.add(hostConfig.makeCssClassName(\"ac-selectable\"));\r\n\r\n\t\t\t\telement.onclick = (e) => {\r\n\t\t\t\t\tthis.selectAction.execute();\r\n\t\t\t\t\te.cancelBubble = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tswitch (this.horizontalAlignment) {\r\n\t\t\t\tcase Enums.HorizontalAlignment.Center:\r\n\t\t\t\t\telement.style.justifyContent = \"center\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Enums.HorizontalAlignment.Right:\r\n\t\t\t\t\telement.style.justifyContent = \"flex-end\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\telement.style.justifyContent = \"flex-start\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tvar totalWeight: number = 0;\r\n\r\n\t\t\tfor (let column of this._columns) {\r\n\t\t\t\tif (column.width instanceof Utils.SizeAndUnit && (column.width.unit == Enums.SizeUnit.Weight)) {\r\n\t\t\t\t\ttotalWeight += column.width.physicalSize;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar renderedColumnCount: number = 0;\r\n\r\n\t\t\tfor (let column of this._columns) {\r\n\t\t\t\tif (column.width instanceof Utils.SizeAndUnit && column.width.unit == Enums.SizeUnit.Weight && totalWeight > 0) {\r\n\t\t\t\t\tvar computedWeight = 100 / totalWeight * column.width.physicalSize;\r\n\r\n\t\t\t\t\t// Best way to emulate \"internal\" access I know of\r\n\t\t\t\t\tcolumn[\"_computedWeight\"] = computedWeight;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar renderedColumn = column.render();\r\n\r\n\t\t\t\tif (renderedColumn) {\r\n\t\t\t\t\tif (renderedColumnCount > 0 && column.separatorElement) {\r\n\t\t\t\t\t\tcolumn.separatorElement.style.flex = \"0 0 auto\";\r\n\r\n\t\t\t\t\t\tUtils.appendChild(element, column.separatorElement);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tUtils.appendChild(element, renderedColumn);\r\n\r\n\t\t\t\t\trenderedColumnCount++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn renderedColumnCount > 0 ? element : null;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected truncateOverflow(maxHeight: number): boolean {\r\n\t\tfor (let column of this._columns) {\r\n\t\t\tcolumn['handleOverflow'](maxHeight);\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tprotected undoOverflowTruncation() {\r\n\t\tfor (let column of this._columns) {\r\n\t\t\tcolumn['resetOverflow']();\r\n\t\t}\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\tlet result = super.toJSON();\r\n\r\n\t\tif (this._selectAction) {\r\n\t\t\tUtils.setProperty(result, \"selectAction\", this.selectAction.toJSON());\r\n\t\t}\r\n\r\n\t\tif (this._columns.length > 0) {\r\n\t\t\tlet columns = [];\r\n\r\n\t\t\tfor (let column of this._columns) {\r\n\t\t\t\tcolumns.push(column.toJSON());\r\n\t\t\t}\r\n\r\n\t\t\tUtils.setProperty(result, \"columns\", columns);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tisFirstElement(element: CardElement): boolean {\r\n\t\tfor (var i = 0; i < this._columns.length; i++) {\r\n\t\t\tif (this._columns[i].isVisible) {\r\n\t\t\t\treturn this._columns[i] == element;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tgetCount(): number {\r\n\t\treturn this._columns.length;\r\n\t}\r\n\r\n\tgetItemCount(): number {\r\n\t\treturn this.getCount();\r\n\t}\r\n\r\n\tgetColumnAt(index: number): Column {\r\n\t\treturn this._columns[index];\r\n\t}\r\n\r\n\tgetItemAt(index: number): CardElement {\r\n\t\treturn this.getColumnAt(index);\r\n\t}\r\n\r\n\tgetJsonTypeName(): string {\r\n\t\treturn \"ColumnSet\";\r\n\t}\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tsuper.parse(json, errors);\r\n\r\n\t\tthis.selectAction = createActionInstance(\r\n\t\t\tthis,\r\n\t\t\tjson[\"selectAction\"],\r\n\t\t\terrors);\r\n\r\n\t\tif (json[\"columns\"] != null) {\r\n\t\t\tlet jsonColumns = json[\"columns\"] as Array<any>;\r\n\r\n\t\t\tthis._columns = [];\r\n\r\n\t\t\tfor (let i = 0; i < jsonColumns.length; i++) {\r\n\t\t\t\tlet column = new Column();\r\n\t\t\t\tcolumn.setParent(this);\r\n\t\t\t\tcolumn.parse(jsonColumns[i], errors);\r\n\r\n\t\t\t\tthis._columns.push(column);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tvalidate(): Array<HostConfig.IValidationError> {\r\n\t\tvar result: Array<HostConfig.IValidationError> = [];\r\n\t\tvar weightedColumns: number = 0;\r\n\t\tvar stretchedColumns: number = 0;\r\n\r\n\t\tfor (var i = 0; i < this._columns.length; i++) {\r\n\t\t\tif (typeof this._columns[i].width === \"number\") {\r\n\t\t\t\tweightedColumns++;\r\n\t\t\t}\r\n\t\t\telse if (this._columns[i].width === \"stretch\") {\r\n\t\t\t\tstretchedColumns++;\r\n\t\t\t}\r\n\r\n\t\t\tresult = result.concat(this._columns[i].validate());\r\n\t\t}\r\n\r\n\t\tif (weightedColumns > 0 && stretchedColumns > 0) {\r\n\t\t\tresult.push(\r\n\t\t\t\t{\r\n\t\t\t\t\terror: Enums.ValidationError.Hint,\r\n\t\t\t\t\tmessage: \"It is not recommended to use weighted and stretched columns in the same ColumnSet, because in such a situation stretched columns will always get the minimum amount of space.\"\r\n\t\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tupdateLayout(processChildren: boolean = true) {\r\n\t\tsuper.updateLayout(processChildren);\r\n\r\n\t\tthis.applyPadding();\r\n\r\n\t\tif (processChildren) {\r\n\t\t\tfor (var i = 0; i < this._columns.length; i++) {\r\n\t\t\t\tthis._columns[i].updateLayout();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\taddColumn(column: Column) {\r\n\t\tif (!column.parent) {\r\n\t\t\tthis._columns.push(column);\r\n\r\n\t\t\tcolumn.setParent(this);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthrow new Error(\"This column already belongs to another ColumnSet.\");\r\n\t\t}\r\n\t}\r\n\r\n\tremoveItem(item: CardElement): boolean {\r\n\t\tif (item instanceof Column) {\r\n\t\t\tvar itemIndex = this._columns.indexOf(item);\r\n\r\n\t\t\tif (itemIndex >= 0) {\r\n\t\t\t\tthis._columns.splice(itemIndex, 1);\r\n\r\n\t\t\t\titem.setParent(null);\r\n\r\n\t\t\t\tthis.updateLayout();\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tindexOf(cardElement: CardElement): number {\r\n\t\treturn cardElement instanceof Column ? this._columns.indexOf(cardElement) : -1;\r\n\t}\r\n\r\n\tisLeftMostElement(element: CardElement): boolean {\r\n\t\treturn this._columns.indexOf(<Column>element) == 0;\r\n\t}\r\n\r\n\tisRightMostElement(element: CardElement): boolean {\r\n\t\treturn this._columns.indexOf(<Column>element) == this._columns.length - 1;\r\n\t}\r\n\r\n\tgetAllInputs(): Array<Input> {\r\n\t\tvar result: Array<Input> = [];\r\n\r\n\t\tfor (var i = 0; i < this._columns.length; i++) {\r\n\t\t\tresult = result.concat(this._columns[i].getAllInputs());\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tgetResourceInformation(): Array<IResourceInformation> {\r\n\t\tlet result: Array<IResourceInformation> = [];\r\n\r\n\t\tfor (var i = 0; i < this._columns.length; i++) {\r\n\t\t\tresult = result.concat(this._columns[i].getResourceInformation());\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tgetElementById(id: string): CardElement {\r\n\t\tvar result: CardElement = super.getElementById(id);\r\n\r\n\t\tif (!result) {\r\n\t\t\tfor (var i = 0; i < this._columns.length; i++) {\r\n\t\t\t\tresult = this._columns[i].getElementById(id);\r\n\r\n\t\t\t\tif (result) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tgetActionById(id: string): Action {\r\n\t\tvar result: Action = null;\r\n\r\n\t\tfor (var i = 0; i < this._columns.length; i++) {\r\n\t\t\tresult = this._columns[i].getActionById(id);\r\n\r\n\t\t\tif (result) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\trenderSpeech(): string {\r\n\t\tif (this.speak != null) {\r\n\t\t\treturn this.speak;\r\n\t\t}\r\n\r\n\t\t// render each item\r\n\t\tlet speak = '';\r\n\r\n\t\tif (this._columns.length > 0) {\r\n\t\t\tfor (var i = 0; i < this._columns.length; i++) {\r\n\t\t\t\tspeak += this._columns[i].renderSpeech();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn speak;\r\n\t}\r\n\r\n\tget padding(): PaddingDefinition {\r\n\t\treturn this.getPadding();\r\n\t}\r\n\r\n\tset padding(value: PaddingDefinition) {\r\n\t\tthis.setPadding(value);\r\n\t}\r\n\r\n\tget selectAction(): Action {\r\n\t\treturn this._selectAction;\r\n\t}\r\n\r\n\tset selectAction(value: Action) {\r\n\t\tthis._selectAction = value;\r\n\r\n\t\tif (this._selectAction) {\r\n\t\t\tthis._selectAction.setParent(this);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction raiseImageLoadedEvent(image: Image) {\r\n\tlet card = image.getRootElement() as AdaptiveCard;\r\n\tlet onImageLoadedHandler = (card && card.onImageLoaded) ? card.onImageLoaded : AdaptiveCard.onImageLoaded;\r\n\r\n\tif (onImageLoadedHandler) {\r\n\t\tonImageLoadedHandler(image);\r\n\t}\r\n}\r\n\r\nfunction raiseAnchorClickedEvent(element: CardElement, anchor: HTMLAnchorElement): boolean {\r\n\tlet card = element.getRootElement() as AdaptiveCard;\r\n\tlet onAnchorClickedHandler = (card && card.onAnchorClicked) ? card.onAnchorClicked : AdaptiveCard.onAnchorClicked;\r\n\r\n\treturn onAnchorClickedHandler != null ? onAnchorClickedHandler(element, anchor) : false;\r\n}\r\n\r\nfunction raiseExecuteActionEvent(action: Action) {\r\n\tlet card = action.parent.getRootElement() as AdaptiveCard;\r\n\tlet onExecuteActionHandler = (card && card.onExecuteAction) ? card.onExecuteAction : AdaptiveCard.onExecuteAction;\r\n\r\n\tif (onExecuteActionHandler) {\r\n\t\taction.prepare(action.parent.getRootElement().getAllInputs());\r\n\r\n\t\tonExecuteActionHandler(action);\r\n\t}\r\n}\r\n\r\nfunction raiseInlineCardExpandedEvent(action: ShowCardAction, isExpanded: boolean) {\r\n\tlet card = action.parent.getRootElement() as AdaptiveCard;\r\n\tlet onInlineCardExpandedHandler = (card && card.onInlineCardExpanded) ? card.onInlineCardExpanded : AdaptiveCard.onInlineCardExpanded;\r\n\r\n\tif (onInlineCardExpandedHandler) {\r\n\t\tonInlineCardExpandedHandler(action, isExpanded);\r\n\t}\r\n}\r\n\r\nfunction raiseElementVisibilityChangedEvent(element: CardElement, shouldUpdateLayout: boolean = true) {\r\n\tlet rootElement = element.getRootElement();\r\n\r\n\tif (shouldUpdateLayout) {\r\n\t\trootElement.updateLayout();\r\n\t}\r\n\r\n\tlet card = rootElement as AdaptiveCard;\r\n\tlet onElementVisibilityChangedHandler = (card && card.onElementVisibilityChanged) ? card.onElementVisibilityChanged : AdaptiveCard.onElementVisibilityChanged;\r\n\r\n\tif (onElementVisibilityChangedHandler != null) {\r\n\t\tonElementVisibilityChangedHandler(element);\r\n\t}\r\n}\r\n\r\nfunction raiseParseElementEvent(element: CardElement, json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\tlet card = element.getRootElement() as AdaptiveCard;\r\n\tlet onParseElementHandler = (card && card.onParseElement) ? card.onParseElement : AdaptiveCard.onParseElement;\r\n\r\n\tif (onParseElementHandler != null) {\r\n\t\tonParseElementHandler(element, json, errors);\r\n\t}\r\n}\r\n\r\nfunction raiseParseActionEvent(action: Action, json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\tlet card = action.parent ? action.parent.getRootElement() as AdaptiveCard : null;\r\n\tlet onParseActionHandler = (card && card.onParseAction) ? card.onParseAction : AdaptiveCard.onParseAction;\r\n\r\n\tif (onParseActionHandler != null) {\r\n\t\tonParseActionHandler(action, json, errors);\r\n\t}\r\n}\r\n\r\nfunction raiseParseError(error: HostConfig.IValidationError, errors: Array<HostConfig.IValidationError>) {\r\n\tif (errors) {\r\n\t\terrors.push(error);\r\n\t}\r\n\r\n\tif (AdaptiveCard.onParseError != null) {\r\n\t\tAdaptiveCard.onParseError(error);\r\n\t}\r\n}\r\n\r\nexport interface ITypeRegistration<T> {\r\n\ttypeName: string,\r\n\tcreateInstance: () => T;\r\n}\r\n\r\nexport abstract class ContainerWithActions extends Container {\r\n\tprivate _actionCollection: ActionCollection;\r\n\r\n\tprotected get renderIfEmpty(): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprotected internalRender(): HTMLElement {\r\n\t\tvar element = super.internalRender();\r\n\r\n\t\tvar renderedActions = this._actionCollection.render(this.hostConfig.actions.actionsOrientation, false);\r\n\r\n\t\tif (renderedActions) {\r\n\t\t\tUtils.appendChild(\r\n\t\t\t\telement,\r\n\t\t\t\tUtils.renderSeparation(\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tspacing: this.hostConfig.getEffectiveSpacing(this.hostConfig.actions.spacing),\r\n\t\t\t\t\t\tlineThickness: null,\r\n\t\t\t\t\t\tlineColor: null\r\n\t\t\t\t\t},\r\n\t\t\t\t\tEnums.Orientation.Horizontal));\r\n\t\t\tUtils.appendChild(element, renderedActions);\r\n\t\t}\r\n\r\n\t\tif (this.renderIfEmpty) {\r\n\t\t\treturn element;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn element.children.length > 0 ? element : null;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected isLastElementBleeding(): boolean {\r\n\t\tif (this._actionCollection.renderedActionCount == 0) {\r\n\t\t\treturn super.isLastElementBleeding() ? !this.isDesignMode() : false;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (this._actionCollection.items.length == 1) {\r\n\t\t\t\treturn this._actionCollection.expandedAction != null && !this.hostConfig.actions.preExpandSingleShowCardAction;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn this._actionCollection.expandedAction != null;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis._actionCollection = new ActionCollection(this);\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\tlet result = super.toJSON();\r\n\r\n\t\tUtils.setProperty(result, \"actions\", this._actionCollection.toJSON());\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tgetActionCount(): number {\r\n\t\treturn this._actionCollection.items.length;\r\n\t}\r\n\r\n\tgetActionAt(index: number): Action {\r\n\t\tif (index >= 0 && index < this.getActionCount()) {\r\n\t\t\treturn this._actionCollection.items[index];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tsuper.getActionAt(index);\r\n\t\t}\r\n\t}\r\n\r\n\tgetActionById(id: string): Action {\r\n\t\tvar result: Action = this._actionCollection.getActionById(id);\r\n\r\n\t\treturn result ? result : super.getActionById(id);\r\n\t}\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tsuper.parse(json, errors);\r\n\r\n\t\tthis._actionCollection.parse(json[\"actions\"]);\r\n\t}\r\n\r\n\tvalidate(): Array<HostConfig.IValidationError> {\r\n\t\tvar result = super.validate();\r\n\r\n\t\tif (this._actionCollection) {\r\n\t\t\tresult = result.concat(this._actionCollection.validate());\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tisLastElement(element: CardElement): boolean {\r\n\t\treturn super.isLastElement(element) && this._actionCollection.items.length == 0;\r\n\t}\r\n\r\n\taddAction(action: Action) {\r\n\t\tthis._actionCollection.addAction(action);\r\n\t}\r\n\r\n\tclear() {\r\n\t\tsuper.clear();\r\n\r\n\t\tthis._actionCollection.clear();\r\n\t}\r\n\r\n\tgetAllInputs(): Array<Input> {\r\n\t\treturn super.getAllInputs().concat(this._actionCollection.getAllInputs());\r\n\t}\r\n\r\n\tgetResourceInformation(): Array<IResourceInformation> {\r\n\t\treturn super.getResourceInformation().concat(this._actionCollection.getResourceInformation());\r\n\t}\r\n\r\n\tget isStandalone(): boolean {\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nexport abstract class TypeRegistry<T> {\r\n\tprivate _items: Array<ITypeRegistration<T>> = [];\r\n\r\n\tprivate findTypeRegistration(typeName: string): ITypeRegistration<T> {\r\n\t\tfor (var i = 0; i < this._items.length; i++) {\r\n\t\t\tif (this._items[i].typeName === typeName) {\r\n\t\t\t\treturn this._items[i];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconstructor() {\r\n\t\tthis.reset();\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis._items = [];\r\n\t}\r\n\r\n\tabstract reset();\r\n\r\n\tregisterType(typeName: string, createInstance: () => T) {\r\n\t\tvar registrationInfo = this.findTypeRegistration(typeName);\r\n\r\n\t\tif (registrationInfo != null) {\r\n\t\t\tregistrationInfo.createInstance = createInstance;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tregistrationInfo = {\r\n\t\t\t\ttypeName: typeName,\r\n\t\t\t\tcreateInstance: createInstance\r\n\t\t\t}\r\n\r\n\t\t\tthis._items.push(registrationInfo);\r\n\t\t}\r\n\t}\r\n\r\n\tunregisterType(typeName: string) {\r\n\t\tfor (var i = 0; i < this._items.length; i++) {\r\n\t\t\tif (this._items[i].typeName === typeName) {\r\n\t\t\t\tthis._items.splice(i, 1);\r\n\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tcreateInstance(typeName: string): T {\r\n\t\tvar registrationInfo = this.findTypeRegistration(typeName);\r\n\r\n\t\treturn registrationInfo ? registrationInfo.createInstance() : null;\r\n\t}\r\n\r\n\tgetItemCount(): number {\r\n\t\treturn this._items.length;\r\n\t}\r\n\r\n\tgetItemAt(index: number): ITypeRegistration<T> {\r\n\t\treturn this._items[index];\r\n\t}\r\n}\r\n\r\nexport class ElementTypeRegistry extends TypeRegistry<CardElement> {\r\n\treset() {\r\n\t\tthis.clear();\r\n\r\n\t\tthis.registerType(\"Container\", () => { return new Container(); });\r\n\t\tthis.registerType(\"TextBlock\", () => { return new TextBlock(); });\r\n\t\tthis.registerType(\"Image\", () => { return new Image(); });\r\n\t\tthis.registerType(\"ImageSet\", () => { return new ImageSet(); });\r\n\t\tthis.registerType(\"Media\", () => { return new Media(); });\r\n\t\tthis.registerType(\"FactSet\", () => { return new FactSet(); });\r\n\t\tthis.registerType(\"ColumnSet\", () => { return new ColumnSet(); });\r\n\t\tthis.registerType(\"Input.Text\", () => { return new TextInput(); });\r\n\t\tthis.registerType(\"Input.Date\", () => { return new DateInput(); });\r\n\t\tthis.registerType(\"Input.Time\", () => { return new TimeInput(); });\r\n\t\tthis.registerType(\"Input.Number\", () => { return new NumberInput(); });\r\n\t\tthis.registerType(\"Input.ChoiceSet\", () => { return new ChoiceSetInput(); });\r\n\t\tthis.registerType(\"Input.Toggle\", () => { return new ToggleInput(); });\r\n\t}\r\n}\r\n\r\nexport class ActionTypeRegistry extends TypeRegistry<Action> {\r\n\treset() {\r\n\t\tthis.clear();\r\n\r\n\t\tthis.registerType(\"Action.OpenUrl\", () => { return new OpenUrlAction(); });\r\n\t\tthis.registerType(\"Action.Submit\", () => { return new SubmitAction(); });\r\n\t\tthis.registerType(\"Action.ShowCard\", () => { return new ShowCardAction(); });\r\n\t}\r\n}\r\n\r\nexport interface IMarkdownProcessingResult {\r\n\tdidProcess: boolean;\r\n\toutputHtml?: any;\r\n}\r\n\r\nexport class AdaptiveCard extends ContainerWithActions {\r\n\tprivate static currentVersion: HostConfig.Version = new HostConfig.Version(1, 1);\r\n\r\n\tstatic useAutomaticContainerBleeding: boolean = false;\r\n\tstatic useAdvancedTextBlockTruncation: boolean = true;\r\n\tstatic useAdvancedCardBottomTruncation: boolean = false;\r\n\tstatic useMarkdownInRadioButtonAndCheckbox: boolean = true;\r\n\tstatic allowMarkForTextHighlighting: boolean = false;\r\n\r\n\tstatic readonly elementTypeRegistry = new ElementTypeRegistry();\r\n\tstatic readonly actionTypeRegistry = new ActionTypeRegistry();\r\n\r\n\tstatic onAnchorClicked: (element: CardElement, anchor: HTMLAnchorElement) => boolean = null;\r\n\tstatic onExecuteAction: (action: Action) => void = null;\r\n\tstatic onElementVisibilityChanged: (element: CardElement) => void = null;\r\n\tstatic onImageLoaded: (image: Image) => void = null;\r\n\tstatic onInlineCardExpanded: (action: ShowCardAction, isExpanded: boolean) => void = null;\r\n\tstatic onParseElement: (element: CardElement, json: any, errors?: Array<HostConfig.IValidationError>) => void = null;\r\n\tstatic onParseAction: (element: Action, json: any, errors?: Array<HostConfig.IValidationError>) => void = null;\r\n\tstatic onParseError: (error: HostConfig.IValidationError) => void = null;\r\n\tstatic onProcessMarkdown: (text: string, result: IMarkdownProcessingResult) => void = null;\r\n\r\n\tstatic get processMarkdown(): (text: string) => string {\r\n\t\tthrow new Error(\"The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead.\")\r\n\t}\r\n\r\n\tstatic set processMarkdown(value: (text: string) => string) {\r\n\t\tthrow new Error(\"The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead.\")\r\n\t}\r\n\r\n\tstatic applyMarkdown(text: string): IMarkdownProcessingResult {\r\n\t\tlet result: IMarkdownProcessingResult = {\r\n\t\t\tdidProcess: false\r\n\t\t};\r\n\r\n\t\tif (AdaptiveCard.onProcessMarkdown) {\r\n\t\t\tAdaptiveCard.onProcessMarkdown(text, result);\r\n\t\t}\r\n\t\telse if (window[\"markdownit\"]) {\r\n\t\t\t// Check for markdownit\r\n\t\t\tresult.outputHtml = window[\"markdownit\"]().render(text);\r\n\t\t\tresult.didProcess = true;\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"Markdown processing isn't enabled. Please see https://www.npmjs.com/package/adaptivecards#supporting-markdown\")\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprivate _cardTypeName?: string = \"AdaptiveCard\";\r\n\tprivate _fallbackCard: AdaptiveCard = null;\r\n\r\n\tprivate isVersionSupported(): boolean {\r\n\t\tif (this.bypassVersionCheck) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet unsupportedVersion: boolean =\r\n\t\t\t\t!this.version ||\r\n\t\t\t\t!this.version.isValid ||\r\n\t\t\t\t(AdaptiveCard.currentVersion.major < this.version.major) ||\r\n\t\t\t\t(AdaptiveCard.currentVersion.major == this.version.major && AdaptiveCard.currentVersion.minor < this.version.minor);\r\n\r\n\t\t\treturn !unsupportedVersion;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected get renderIfEmpty(): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tprotected getItemsCollectionPropertyName(): string {\r\n\t\treturn \"body\";\r\n\t}\r\n\r\n\tprotected applyPadding() {\r\n\t\tif (!this.renderedElement) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar effectivePadding = this.padding ? this.padding.toSpacingDefinition(this.hostConfig) : this.internalPadding.toSpacingDefinition(this.hostConfig);\r\n\r\n\t\tthis.renderedElement.style.paddingTop = effectivePadding.top + \"px\";\r\n\t\tthis.renderedElement.style.paddingRight = effectivePadding.right + \"px\";\r\n\t\tthis.renderedElement.style.paddingBottom = effectivePadding.bottom + \"px\";\r\n\t\tthis.renderedElement.style.paddingLeft = effectivePadding.left + \"px\";\r\n\r\n\t\tif (this.isLastElementBleeding()) {\r\n\t\t\tthis.renderedElement.style.paddingBottom = \"0px\";\r\n\t\t}\r\n\t}\r\n\r\n\tprotected internalRender(): HTMLElement {\r\n\t\tvar renderedElement = super.internalRender();\r\n\r\n\t\tif (AdaptiveCard.useAdvancedCardBottomTruncation) {\r\n\t\t\t// Unlike containers, the root card element should be allowed to\r\n\t\t\t// be shorter than its content (otherwise the overflow truncation\r\n\t\t\t// logic would never get triggered)\r\n\t\t\trenderedElement.style.minHeight = null;\r\n\t\t}\r\n\r\n\t\treturn renderedElement;\r\n\t}\r\n\r\n\tprotected get bypassVersionCheck(): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprotected get defaultPadding(): PaddingDefinition {\r\n\t\treturn new PaddingDefinition(\r\n\t\t\tEnums.Spacing.Padding,\r\n\t\t\tEnums.Spacing.Padding,\r\n\t\t\tEnums.Spacing.Padding,\r\n\t\t\tEnums.Spacing.Padding);\r\n\t}\r\n\r\n\tprotected get allowCustomPadding(): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprotected get allowCustomStyle() {\r\n\t\treturn this.hostConfig.adaptiveCard && this.hostConfig.adaptiveCard.allowCustomStyle;\r\n\t}\r\n\r\n\tprotected get hasBackground(): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tonAnchorClicked: (element: CardElement, anchor: HTMLAnchorElement) => boolean = null;\r\n\tonExecuteAction: (action: Action) => void = null;\r\n\tonElementVisibilityChanged: (element: CardElement) => void = null;\r\n\tonImageLoaded: (image: Image) => void = null;\r\n\tonInlineCardExpanded: (action: ShowCardAction, isExpanded: boolean) => void = null;\r\n\tonParseElement: (element: CardElement, json: any, errors?: Array<HostConfig.IValidationError>) => void = null;\r\n\tonParseAction: (element: Action, json: any, errors?: Array<HostConfig.IValidationError>) => void = null;\r\n\r\n\tversion?: HostConfig.Version = new HostConfig.Version(1, 0);\r\n\tfallbackText: string;\r\n\tdesignMode: boolean = false;\r\n\r\n\tgetJsonTypeName(): string {\r\n\t\treturn \"AdaptiveCard\";\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\tlet result = super.toJSON();\r\n\r\n\t\tUtils.setProperty(result, \"$schema\", \"http://adaptivecards.io/schemas/adaptive-card.json\");\r\n\r\n\t\tif (!this.bypassVersionCheck && this.version) {\r\n\t\t\tUtils.setProperty(result, \"version\", this.version.toString());\r\n\t\t}\r\n\r\n\t\tUtils.setProperty(result, \"fallbackText\", this.fallbackText);\r\n\t\tUtils.setProperty(result, \"lang\", this.lang);\r\n\t\tUtils.setProperty(result, \"speak\", this.speak);\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tvalidate(): Array<HostConfig.IValidationError> {\r\n\t\tvar result: Array<HostConfig.IValidationError> = [];\r\n\r\n\t\tif (this._cardTypeName != \"AdaptiveCard\") {\r\n\t\t\tresult.push(\r\n\t\t\t\t{\r\n\t\t\t\t\terror: Enums.ValidationError.MissingCardType,\r\n\t\t\t\t\tmessage: \"Invalid or missing card type. Make sure the card's type property is set to \\\"AdaptiveCard\\\".\"\r\n\t\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (!this.bypassVersionCheck && !this.version) {\r\n\t\t\tresult.push(\r\n\t\t\t\t{\r\n\t\t\t\t\terror: Enums.ValidationError.PropertyCantBeNull,\r\n\t\t\t\t\tmessage: \"The version property must be specified.\"\r\n\t\t\t\t});\r\n\t\t}\r\n\t\telse if (!this.isVersionSupported()) {\r\n\t\t\tresult.push(\r\n\t\t\t\t{\r\n\t\t\t\t\terror: Enums.ValidationError.UnsupportedCardVersion,\r\n\t\t\t\t\tmessage: \"The specified card version (\" + this.version + \") is not supported. The maximum supported card version is \" + AdaptiveCard.currentVersion\r\n\t\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn result.concat(super.validate());\r\n\t}\r\n\r\n\tparse(json: any, errors?: Array<HostConfig.IValidationError>) {\r\n\t\tthis._fallbackCard = null;\r\n\r\n\t\tthis._cardTypeName = json[\"type\"];\r\n\r\n\t\tvar langId = json[\"lang\"];\r\n\r\n\t\tif (langId && typeof langId === \"string\") {\r\n\t\t\ttry {\r\n\t\t\t\tthis.lang = langId;\r\n\t\t\t}\r\n\t\t\tcatch (e) {\r\n\t\t\t\traiseParseError(\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\terror: Enums.ValidationError.InvalidPropertyValue,\r\n\t\t\t\t\t\tmessage: e.message\r\n\t\t\t\t\t},\r\n\t\t\t\t\terrors\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.version = HostConfig.Version.parse(json[\"version\"], errors);\r\n\r\n\t\tthis.fallbackText = json[\"fallbackText\"];\r\n\r\n\t\tlet fallbackElement = createElementInstance(null, json[\"fallback\"], errors);\r\n\r\n\t\tif (fallbackElement) {\r\n\t\t\tthis._fallbackCard = new AdaptiveCard();\r\n\t\t\tthis._fallbackCard.addItem(fallbackElement);\r\n\t\t}\r\n\r\n\t\tsuper.parse(json, errors);\r\n\t}\r\n\r\n\trender(target?: HTMLElement): HTMLElement {\r\n\t\tlet fallback = false;\r\n\t\tlet renderedCard: HTMLElement;\r\n\r\n\t\tif (this.shouldFallback()) {\r\n\t\t\tif (this._fallbackCard) {\r\n\t\t\t\tthis._fallbackCard.hostConfig = this.hostConfig;\r\n\r\n\t\t\t\trenderedCard = this._fallbackCard.render();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlet errorText = !Utils.isNullOrEmpty(this.fallbackText) ? this.fallbackText : \"The card could not be rendered. It is either malformed or uses features not supported by this host.\";\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tlet fallbackCard = new AdaptiveCard();\r\n\t\t\t\t\tfallbackCard.hostConfig = this.hostConfig;\r\n\t\t\t\t\tfallbackCard.parse(\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttype: \"AdaptiveCard\",\r\n\t\t\t\t\t\t\tversion: \"1.0\",\r\n\t\t\t\t\t\t\tbody: [\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttype: \"TextBlock\",\r\n\t\t\t\t\t\t\t\t\ttext: errorText,\r\n\t\t\t\t\t\t\t\t\twrap: true\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\trenderedCard = fallbackCard.render();\r\n\t\t\t\t}\r\n\t\t\t\tcatch (e) {\r\n\t\t\t\t\trenderedCard = document.createElement(\"div\");\r\n\t\t\t\t\trenderedCard.innerHTML = errorText;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderedCard = super.render();\r\n\r\n\t\t\tif (renderedCard) {\r\n\t\t\t\trenderedCard.tabIndex = 0;\r\n\r\n\t\t\t\tif (!Utils.isNullOrEmpty(this.speak)) {\r\n\t\t\t\t\trenderedCard.setAttribute(\"aria-label\", this.speak);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (target) {\r\n\t\t\ttarget.appendChild(renderedCard);\r\n\r\n\t\t\tthis.updateLayout();\r\n\t\t}\r\n\r\n\t\treturn renderedCard;\r\n\t}\r\n\r\n\tupdateLayout(processChildren: boolean = true) {\r\n\t\tsuper.updateLayout(processChildren);\r\n\r\n\t\tif (AdaptiveCard.useAdvancedCardBottomTruncation && this.isRendered()) {\r\n\t\t\tvar card = this.renderedElement;\r\n\t\t\tvar padding = this.hostConfig.getEffectiveSpacing(Enums.Spacing.Default);\r\n\r\n\t\t\tthis['handleOverflow'](card.offsetHeight - padding);\r\n\t\t}\r\n\t}\r\n\r\n\tcanContentBleed(): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tshouldFallback(): boolean {\r\n\t\treturn super.shouldFallback() || !this.isVersionSupported();\r\n\t}\r\n\r\n\tget hasVisibleSeparator(): boolean {\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nclass InlineAdaptiveCard extends AdaptiveCard {\r\n\tprotected get bypassVersionCheck(): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tprotected get defaultPadding(): PaddingDefinition {\r\n\t\treturn new PaddingDefinition(\r\n\t\t\tthis.suppressStyle ? Enums.Spacing.None : Enums.Spacing.Padding,\r\n\t\t\tEnums.Spacing.Padding,\r\n\t\t\tthis.suppressStyle ? Enums.Spacing.None : Enums.Spacing.Padding,\r\n\t\t\tEnums.Spacing.Padding);\r\n\t}\r\n\r\n\tprotected get defaultStyle(): string {\r\n\t\tif (this.suppressStyle) {\r\n\t\t\treturn Enums.ContainerStyle.Default;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn this.hostConfig.actions.showCard.style ? this.hostConfig.actions.showCard.style : Enums.ContainerStyle.Emphasis;\r\n\t\t}\r\n\t}\r\n\r\n\tsuppressStyle: boolean = false;\r\n\r\n\trender(target?: HTMLElement) {\r\n\t\tvar renderedCard = super.render(target);\r\n\t\trenderedCard.setAttribute(\"aria-live\", \"polite\");\r\n\t\trenderedCard.removeAttribute(\"tabindex\");\r\n\r\n\t\treturn renderedCard;\r\n\t}\r\n\r\n\tgetForbiddenActionTypes(): Array<any> {\r\n\t\treturn [ShowCardAction];\r\n\t}\r\n}\r\n\r\nconst defaultHostConfig: HostConfig.HostConfig = new HostConfig.HostConfig(\r\n\t{\r\n\t\tsupportsInteractivity: true,\r\n\t\tfontFamily: \"Segoe UI\",\r\n\t\tspacing: {\r\n\t\t\tsmall: 10,\r\n\t\t\tdefault: 20,\r\n\t\t\tmedium: 30,\r\n\t\t\tlarge: 40,\r\n\t\t\textraLarge: 50,\r\n\t\t\tpadding: 20\r\n\t\t},\r\n\t\tseparator: {\r\n\t\t\tlineThickness: 1,\r\n\t\t\tlineColor: \"#EEEEEE\"\r\n\t\t},\r\n\t\tfontSizes: {\r\n\t\t\tsmall: 12,\r\n\t\t\tdefault: 14,\r\n\t\t\tmedium: 17,\r\n\t\t\tlarge: 21,\r\n\t\t\textraLarge: 26\r\n\t\t},\r\n\t\tfontWeights: {\r\n\t\t\tlighter: 200,\r\n\t\t\tdefault: 400,\r\n\t\t\tbolder: 600\r\n\t\t},\r\n\t\timageSizes: {\r\n\t\t\tsmall: 40,\r\n\t\t\tmedium: 80,\r\n\t\t\tlarge: 160\r\n\t\t},\r\n\t\tcontainerStyles: {\r\n\t\t\tdefault: {\r\n\t\t\t\tbackgroundColor: \"#FFFFFF\",\r\n\t\t\t\tforegroundColors: {\r\n\t\t\t\t\tdefault: {\r\n\t\t\t\t\t\tdefault: \"#333333\",\r\n\t\t\t\t\t\tsubtle: \"#EE333333\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdark: {\r\n\t\t\t\t\t\tdefault: \"#000000\",\r\n\t\t\t\t\t\tsubtle: \"#66000000\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\tlight: {\r\n\t\t\t\t\t\tdefault: \"#FFFFFF\",\r\n\t\t\t\t\t\tsubtle: \"#33000000\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\taccent: {\r\n\t\t\t\t\t\tdefault: \"#2E89FC\",\r\n\t\t\t\t\t\tsubtle: \"#882E89FC\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\tattention: {\r\n\t\t\t\t\t\tdefault: \"#cc3300\",\r\n\t\t\t\t\t\tsubtle: \"#DDcc3300\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\tgood: {\r\n\t\t\t\t\t\tdefault: \"#54a254\",\r\n\t\t\t\t\t\tsubtle: \"#DD54a254\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\twarning: {\r\n\t\t\t\t\t\tdefault: \"#e69500\",\r\n\t\t\t\t\t\tsubtle: \"#DDe69500\"\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\temphasis: {\r\n\t\t\t\tbackgroundColor: \"#08000000\",\r\n\t\t\t\tforegroundColors: {\r\n\t\t\t\t\tdefault: {\r\n\t\t\t\t\t\tdefault: \"#333333\",\r\n\t\t\t\t\t\tsubtle: \"#EE333333\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdark: {\r\n\t\t\t\t\t\tdefault: \"#000000\",\r\n\t\t\t\t\t\tsubtle: \"#66000000\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\tlight: {\r\n\t\t\t\t\t\tdefault: \"#FFFFFF\",\r\n\t\t\t\t\t\tsubtle: \"#33000000\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\taccent: {\r\n\t\t\t\t\t\tdefault: \"#2E89FC\",\r\n\t\t\t\t\t\tsubtle: \"#882E89FC\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\tattention: {\r\n\t\t\t\t\t\tdefault: \"#cc3300\",\r\n\t\t\t\t\t\tsubtle: \"#DDcc3300\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\tgood: {\r\n\t\t\t\t\t\tdefault: \"#54a254\",\r\n\t\t\t\t\t\tsubtle: \"#DD54a254\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\twarning: {\r\n\t\t\t\t\t\tdefault: \"#e69500\",\r\n\t\t\t\t\t\tsubtle: \"#DDe69500\"\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tactions: {\r\n\t\t\tmaxActions: 5,\r\n\t\t\tspacing: Enums.Spacing.Default,\r\n\t\t\tbuttonSpacing: 10,\r\n\t\t\tshowCard: {\r\n\t\t\t\tactionMode: Enums.ShowCardActionMode.Inline,\r\n\t\t\t\tinlineTopMargin: 16\r\n\t\t\t},\r\n\t\t\tactionsOrientation: Enums.Orientation.Horizontal,\r\n\t\t\tactionAlignment: Enums.ActionAlignment.Left\r\n\t\t},\r\n\t\tadaptiveCard: {\r\n\t\t\tallowCustomStyle: false\r\n\t\t},\r\n\t\timageSet: {\r\n\t\t\timageSize: Enums.Size.Medium,\r\n\t\t\tmaxImageHeight: 100\r\n\t\t},\r\n\t\tfactSet: {\r\n\t\t\ttitle: {\r\n\t\t\t\tcolor: Enums.TextColor.Default,\r\n\t\t\t\tsize: Enums.TextSize.Default,\r\n\t\t\t\tisSubtle: false,\r\n\t\t\t\tweight: Enums.TextWeight.Bolder,\r\n\t\t\t\twrap: true,\r\n\t\t\t\tmaxWidth: 150,\r\n\t\t\t},\r\n\t\t\tvalue: {\r\n\t\t\t\tcolor: Enums.TextColor.Default,\r\n\t\t\t\tsize: Enums.TextSize.Default,\r\n\t\t\t\tisSubtle: false,\r\n\t\t\t\tweight: Enums.TextWeight.Default,\r\n\t\t\t\twrap: true,\r\n\t\t\t},\r\n\t\t\tspacing: 10\r\n\t\t}\r\n\t});\r\n","abstract class AbstractTextFormatter {\r\n    private _regularExpression: RegExp;\r\n\r\n    protected abstract internalFormat(lang: string, matches: RegExpExecArray): string;\r\n\r\n    constructor(regularExpression: RegExp) {\r\n        this._regularExpression = regularExpression;\r\n    }\r\n\r\n    format(lang: string, input: string): string {\r\n        var matches;\r\n        var result = input;\r\n\r\n        while ((matches = this._regularExpression.exec(input)) != null) {\r\n            result = result.replace(matches[0], this.internalFormat(lang, matches));\r\n        };\r\n\r\n        return result;\r\n    }\r\n}\r\n\r\nclass DateFormatter extends AbstractTextFormatter {\r\n    protected internalFormat(lang: string, matches: RegExpExecArray): string {\r\n        var date = new Date(Date.parse(matches[1]));\r\n        var format = matches[2] != undefined ? matches[2].toLowerCase() : \"compact\";\r\n\r\n        if (format != \"compact\") {\r\n            return date.toLocaleDateString(lang, { day: \"numeric\", weekday: format, month: format, year: \"numeric\" });\r\n        }\r\n        else {\r\n            return date.toLocaleDateString();\r\n        }\r\n    }\r\n}\r\n\r\nclass TimeFormatter extends AbstractTextFormatter {\r\n    protected internalFormat(lang: string, matches: RegExpExecArray): string {\r\n        var date = new Date(Date.parse(matches[1]));\r\n\r\n        return date.toLocaleTimeString(lang, { hour: 'numeric', minute: '2-digit' });\r\n    }\r\n}\r\n\r\nexport function formatText(lang: string, text: string): string {\r\n    const formatters: Array<AbstractTextFormatter> = [\r\n        new DateFormatter(/\\{{2}DATE\\((\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(?:Z|(?:(?:-|\\+)\\d{2}:\\d{2})))(?:, ?(COMPACT|LONG|SHORT))?\\)\\}{2}/g),\r\n        new TimeFormatter(/\\{{2}TIME\\((\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(?:Z|(?:(?:-|\\+)\\d{2}:\\d{2})))\\)\\}{2}/g)\r\n    ];\r\n\r\n    var result = text;\r\n\r\n    for (var i = 0; i < formatters.length; i++) {\r\n        result = formatters[i].format(lang, result);\r\n    }\r\n\r\n    return result;\r\n}\r\n"],"sourceRoot":""}